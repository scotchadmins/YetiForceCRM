{"version":3,"file":"BriaSoftphone.min.js","sources":["BriaSoftphone.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\nIntegrations_Pbx_Base.driver = 'BriaSoftphone';\n/**\n * @classdesc Bria Softphone Pbx integrations class.\n * @class\n */\nwindow.Integrations_Pbx_BriaSoftphone = class Integrations_Pbx_BriaSoftphone extends Integrations_Pbx_Base {\n\t/** @inheritdoc */\n\tconstructor(container) {\n\t\tsuper(container);\n\t\tthis.btnText = this.accountName = this.lastEvent = this.status = this.connected = false;\n\t\ttry {\n\t\t\tthis.initWebsocket();\n\t\t} catch (e) {\n\t\t\tconsole.warn('WebSocket exception: ' + e);\n\t\t\tthis.connected = false;\n\t\t}\n\t\tthis.container.find('.js-phone-status-btn').on('click', (e) => {\n\t\t\tif (this.connected) {\n\t\t\t\tthis.bringToFront();\n\t\t\t}\n\t\t});\n\t}\n\t/** @inheritdoc */\n\tperformCall(data) {\n\t\tif (this.connected) {\n\t\t\tthis.apiCall(\n\t\t\t\t'call',\n\t\t\t\t`<dial type=\"audio\"><number>${data.phone}</number><displayName></displayName><suppressMainWindow>false</suppressMainWindow></dial>`\n\t\t\t);\n\t\t} else {\n\t\t\tapp.showError({\n\t\t\t\ttitle: app.vtranslate('JS_UNEXPECTED_ERROR')\n\t\t\t});\n\t\t}\n\t}\n\t/**\n\t * Connection initialization via websocket\n\t */\n\tinitWebsocket() {\n\t\tthis.connected = false;\n\t\tthis.websocket = new WebSocket('wss://cpclientapi.softphone.com:9002/counterpath/socketapi/v1/');\n\t\tthis.websocket.onopen = (e) => {\n\t\t\tthis.connected = true;\n\t\t\tthis.setStatus('Connected', e);\n\t\t\tthis.getStatus('account', '<accountType>sip</accountType>');\n\t\t};\n\t\tthis.websocket.onclose = (e) => {\n\t\t\tif (this.connected) {\n\t\t\t\tthis.setStatus('Disconnected', e);\n\t\t\t} else {\n\t\t\t\tthis.setStatus('Close', e);\n\t\t\t}\n\t\t\tthis.connected = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.initWebsocket();\n\t\t\t}, 5000);\n\t\t};\n\t\tthis.websocket.onerror = (e) => {\n\t\t\tthis.connected = false;\n\t\t\tthis.setStatus('Error', e);\n\t\t\tthis.websocket.close();\n\t\t};\n\t\tthis.websocket.onmessage = (e) => {\n\t\t\tthis.received(e.data);\n\t\t};\n\t}\n\t/**\n\t * Update button\n\t */\n\tupdateBtn() {\n\t\tconst btn = this.container.find('.js-phone-status-btn'),\n\t\t\tbtnIcon = btn.find('.js-icon'),\n\t\t\tbtnText = btn.find('.js-text');\n\t\tbtn.removeClass('d-none');\n\t\tbtn.attr('class', function (i, c) {\n\t\t\treturn c.replace(/(^|\\s)btn-\\S+/g, '');\n\t\t});\n\t\tlet title = this.status;\n\t\tswitch (this.status) {\n\t\t\tcase 'Ringing':\n\t\t\t\tbtn.addClass('btn-primary');\n\t\t\t\tbtnIcon.removeClass().addClass('fa-solid fa-phone-volume js-icon');\n\t\t\t\tbreak;\n\t\t\tcase 'Service Unavailable':\n\t\t\t\tbtn.addClass('btn-warning');\n\t\t\t\tbtnIcon.removeClass().addClass('fa-solid fa-phone-slash js-icon');\n\t\t\t\tbreak;\n\t\t\tcase 'Disconnected':\n\t\t\tcase 'Close':\n\t\t\t\tbtn.addClass('btn-danger');\n\t\t\t\tbtnIcon.removeClass().addClass('fa-solid fa-phone-slash js-icon');\n\t\t\t\tbreak;\n\t\t\tcase 'Connected':\n\t\t\tdefault:\n\t\t\t\tbtn.addClass('btn-success');\n\t\t\t\tbtnIcon.removeClass().addClass('fa-solid fa-phone-flip js-icon');\n\t\t\t\tbreak;\n\t\t}\n\t\tif (this.lastEvent && (this.lastEvent.code || this.lastEvent.name)) {\n\t\t\ttitle += ' (' + (this.lastEvent.code || this.lastEvent.name) + ')';\n\t\t}\n\t\tbtn.attr('title', title);\n\t\tif (this.btnText) {\n\t\t\tbtnText.text(this.btnText).addClass('ml-2');\n\t\t} else {\n\t\t\tbtnText.removeClass('ml-2');\n\t\t}\n\t}\n\t/**\n\t * Message event\n\t * @param {object} data\n\t */\n\treceived(data) {\n\t\tconst message = this.parseMessage(data);\n\t\tif (message['errorCode']) {\n\t\t\tthis.setStatus(message['errorText']);\n\t\t} else {\n\t\t\tswitch (message['messageType']) {\n\t\t\t\tcase 'RESPONSE':\n\t\t\t\t\tthis.response(message['xml']);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'EVENT':\n\t\t\t\t\tthis.event(message['xml']);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.updateBtn();\n\t}\n\t/**\n\t * Response message type\n\t * @param {jQuery} xml\n\t */\n\tresponse(xml) {\n\t\tif (xml) {\n\t\t\tconst type = xml.children(':first').attr('type'),\n\t\t\t\tfn = 'request' + type.charAt(0).toUpperCase() + type.slice(1);\n\t\t\tthis.log('|◄| ' + fn + ' [' + (fn in this) + ']', xml.get(0));\n\t\t\tif (fn in this) {\n\t\t\t\tthis[fn](xml.find(type));\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * Event message type\n\t * @param {jQuery} xml\n\t */\n\tevent(xml) {\n\t\tif (xml) {\n\t\t\tconst type = xml.children(':first').attr('type'),\n\t\t\t\tfn = 'event' + type.charAt(0).toUpperCase() + type.slice(1);\n\t\t\tthis.log('|◄| ' + fn + ' [' + (fn in this) + ']', xml.get(0));\n\t\t\tif (fn in this) {\n\t\t\t\tthis[fn]();\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * Account details request\n\t * @param {jQuery} xml\n\t * @description `|◄| requestAccount [true]`\n\t */\n\trequestAccount(xml) {\n\t\tthis.btnText = this.accountName = xml.find('accountName').text();\n\t\tconst value = app.cacheGet('PBX|lastCallHistoryUpdate|' + this.accountName, null);\n\t\tif (value == null || Math.floor((Date.now() - value) / 1000) > 300) {\n\t\t\tapp.cacheClear('PBX|lastCallHistoryUpdate|' + this.accountName);\n\t\t\tthis.getStatus('callHistory', '<count>20</count><entryType>all</entryType>');\n\t\t}\n\t}\n\t/**\n\t * Call history details request\n\t * @param {jQuery} xml\n\t * @description `|◄| requestCallHistory [true]`\n\t */\n\trequestCallHistory(xml) {\n\t\tlet calls = [];\n\t\txml.each((_, callsXml) => {\n\t\t\tlet call = {};\n\t\t\t$(callsXml)\n\t\t\t\t.children()\n\t\t\t\t.each((_, callXml) => {\n\t\t\t\t\tcall[callXml.tagName] = callXml.textContent;\n\t\t\t\t});\n\t\t\tcalls.push(call);\n\t\t});\n\t\tAppConnector.request({\n\t\t\tmodule: 'AppComponents',\n\t\t\taction: 'Pbx',\n\t\t\tmode: 'saveCalls',\n\t\t\taccountName: this.accountName,\n\t\t\tcalls: calls\n\t\t}).done((response) => {\n\t\t\tif (response.result.loadMore === true) {\n\t\t\t\tthis.getStatus('callHistory', '<count>100</count><entryType>all</entryType>');\n\t\t\t}\n\t\t});\n\t\tapp.cacheSet('PBX|lastCallHistoryUpdate|' + this.accountName, Date.now());\n\t}\n\t/**\n\t * Call request\n\t * @param {jQuery} xml\n\t * @description `|◄| requestCall [true]`\n\t */\n\trequestCall(xml) {\n\t\tif (xml.length) {\n\t\t\tthis.setStatus('Ringing');\n\t\t\tthis.btnText = xml.find('displayName').text();\n\t\t} else {\n\t\t\tthis.setStatus('Connected');\n\t\t\tthis.btnText = this.accountName;\n\t\t}\n\t}\n\t/**\n\t * Call history event\n\t * @description `|◄| eventCallHistory [true]`\n\t */\n\teventCallHistory() {\n\t\tthis.getStatus('callHistory', '<count>5</count><entryType>all</entryType>');\n\t}\n\t/**\n\t * Call event\n\t * @description `|◄| eventCall [true]`\n\t */\n\teventCall() {\n\t\tthis.setStatus('Ringing');\n\t\tthis.getStatus('call');\n\t}\n\t/**\n\t * Get status from phone application\n\t * @param {string} type\n\t * @param {string} custom\n\t * @description `|►| status`\n\t */\n\tgetStatus(type, custom) {\n\t\tif (!custom) {\n\t\t\tcustom = '';\n\t\t}\n\t\tthis.apiCall('status', `<status><type>${type}</type>${custom}</status>`);\n\t}\n\t/**\n\t * Show phone app\n\t * @description `|►| bringToFront`\n\t */\n\tbringToFront() {\n\t\tthis.apiCall('bringToFront', `<bringToFront><window>main</window></bringToFront>`);\n\t}\n\t/**\n\t * Set status event\n\t * @param {string} status\n\t * @param {Event} e\n\t */\n\tsetStatus(status, e) {\n\t\tthis.status = status;\n\t\tthis.lastEvent = e;\n\t\tthis.updateBtn();\n\t\tthis.log('☎ %c' + status);\n\t}\n\t/**\n\t * Send a request to the phone application\n\t * @param {string} method\n\t * @param {string} body\n\t */\n\tapiCall(method, body) {\n\t\tthis.log('|►| ' + method, body);\n\t\tbody = '<?xml version=\"1.0\" encoding=\"utf-8\" ?>\\r\\n' + body;\n\t\tlet msg = 'GET /' + method + '\\r\\nUser-Agent: YetiForce CRM';\n\t\tmsg += '\\r\\nContent-Type: application/xml\\r\\nContent-Length: ';\n\t\tmsg += body.length + '\\r\\n\\r\\n' + body;\n\t\tthis.websocket.send(msg);\n\t}\n\t/**\n\t * Parse response from websocket\n\t * @param {string} msg\n\t * @returns {object}\n\t */\n\tparseMessage(msg) {\n\t\tlet response = {},\n\t\t\tcontent = '';\n\t\tconst lines = msg.replace(/\\r\\n/g, '\\n').split('\\n');\n\t\tlet line = lines[0];\n\t\tif (line.substr(0, 4) == 'POST') {\n\t\t\tresponse['messageType'] = 'EVENT';\n\t\t\tline = line.substr(5).trim();\n\t\t\tresponse['eventType'] = line.substr(0, 13);\n\t\t} else if (line.substr(0, 8) == 'HTTP/1.1') {\n\t\t\tline = line.substr(8).trim();\n\t\t\tif (line.substr(0, 6) == '200 OK') {\n\t\t\t\tresponse['messageType'] = 'RESPONSE';\n\t\t\t} else if (line[0] == '4' || line[0] == '5') {\n\t\t\t\tresponse['messageType'] = 'ERROR';\n\t\t\t\tresponse['errorCode'] = line.substr(0, 3);\n\t\t\t\tresponse['errorText'] = line.substr(4);\n\t\t\t}\n\t\t}\n\t\tlet i = 1;\n\t\tfor (; i < lines.length; i++) {\n\t\t\tif (lines[i][0] == '<') {\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tfor (; i < lines.length; i++) {\n\t\t\tcontent += lines[i];\n\t\t\tif (i < lines.length - 1) {\n\t\t\t\tcontent += '\\n';\n\t\t\t}\n\t\t}\n\t\tif (content.length > 0) {\n\t\t\tconst parser = new DOMParser();\n\t\t\tresponse['xml'] = $(parser.parseFromString(content, 'text/xml'));\n\t\t}\n\t\treturn response;\n\t}\n};\n"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","descriptor","i","length","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","key","_createClass","protoProps","staticProps","arg","_toPrimitive","String","input","hint","prim","toPrimitive","res","call","Number","_inherits","subClass","superClass","create","value","_setPrototypeOf","o","p","setPrototypeOf","bind","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","result","Super","_getPrototypeOf","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","Integrations_Pbx_Base","driver","window","Integrations_Pbx_BriaSoftphone","_Integrations_Pbx_Bas","container","_this","_super","btnText","accountName","lastEvent","status","connected","initWebsocket","console","warn","find","on","bringToFront","performCall","data","apiCall","concat","phone","app","showError","title","vtranslate","_this2","websocket","WebSocket","onopen","setStatus","getStatus","onclose","setTimeout","onerror","close","onmessage","received","updateBtn","btn","btnIcon","removeClass","attr","c","replace","addClass","code","name","text","message","parseMessage","errorCode","errorText","messageType","response","xml","event","type","children","fn","charAt","toUpperCase","slice","log","get","requestAccount","cacheGet","Math","floor","Date","now","cacheClear","requestCallHistory","_this3","calls","each","_","callsXml","$","callXml","tagName","textContent","push","AppConnector","request","module","action","mode","done","loadMore","cacheSet","requestCall","eventCallHistory","eventCall","custom","method","body","msg","send","content","lines","split","line","substr","trim","eventType","parser","DOMParser","parseFromString"],"mappings":";;AAAA,kKACA,YAAY,CAAC,SAAAA,OAAAA,CAAAC,GAAA,CAAAD,CAAAA,yBAAAA,CAAAA,OAAAA,OAAA,CAAAE,UAAAA,EAAAA,OAAAA,MAAA,EAAAA,QAAAA,EAAAA,OAAAA,MAAA,CAAAC,QAAA,CAAA,SAAAF,GAAA,CAAA,CAAA,OAAA,OAAAA,GAAA,CAAA,CAAA,SAAAA,GAAA,CAAAA,CAAAA,OAAAA,GAAA,EAAAC,UAAAA,EAAAA,OAAAA,MAAA,EAAAD,GAAA,CAAAG,WAAA,GAAAF,MAAA,EAAAD,GAAA,GAAAC,MAAA,CAAAG,SAAA,CAAAJ,QAAAA,CAAAA,OAAAA,GAAA,CAAAD,CAAAA,OAAA,CAAAC,GAAA,CAAA,CAAA,SAAAK,eAAAC,CAAAA,QAAA,CAAAC,WAAA,OAAAD,QAAA,YAAAC,WAAA,CAAA,CAAA,MAAA,IAAAC,SAAA,CAAA,mCAAA,CAAA,CAAA,SAAAC,kBAAAC,MAAA,CAAAC,KAAA,CAAAC,CAAAA,IAAAA,IAAAA,UAAA,CAAAC,CAAA,CAAA,CAAA,CAAAA,CAAA,CAAAF,KAAA,CAAAG,MAAA,CAAAD,CAAA,EAAAD,CAAAA,UAAA,CAAAD,KAAA,CAAAE,CAAA,CAAA,CAAAD,UAAA,CAAAG,UAAA,CAAAH,UAAA,CAAAG,UAAA,EAAAH,CAAAA,CAAAA,CAAAA,UAAA,CAAAI,YAAA,cAAAJ,UAAA,GAAAA,UAAA,CAAAK,QAAA,CAAA,CAAA,CAAA,CAAA,CAAAC,MAAA,CAAAC,cAAA,CAAAT,MAAA,CAAAU,cAAA,CAAAR,UAAA,CAAAS,GAAA,CAAA,CAAAT,UAAA,EAAA,CAAA,SAAAU,aAAAf,WAAA,CAAAgB,UAAA,CAAAC,WAAA,SAAAD,UAAA,EAAAd,iBAAA,CAAAF,WAAA,CAAAH,SAAA,CAAAmB,UAAA,CAAAC,CAAAA,WAAA,EAAAf,iBAAA,CAAAF,WAAA,CAAAiB,WAAA,CAAA,CAAAN,MAAA,CAAAC,cAAA,CAAAZ,WAAA,CAAAU,WAAAA,CAAAA,CAAAA,QAAA,CAAAV,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,WAAA,UAAAa,cAAAK,CAAAA,GAAA,CAAAJ,CAAAA,IAAAA,GAAA,CAAAK,YAAA,CAAAD,GAAA,CAAA,QAAA,CAAA,CAAA,OAAA,QAAA,GAAA1B,OAAA,CAAAsB,GAAA,CAAA,CAAAA,GAAA,CAAAM,MAAA,CAAAN,GAAA,CAAAK,CAAAA,SAAAA,YAAAA,CAAAE,KAAA,CAAAC,IAAA,CAAA9B,CAAAA,GAAAA,QAAAA,GAAAA,OAAA,CAAA6B,KAAA,UAAAA,KAAA,CAAA,OAAAA,KAAA,CAAA,IAAAE,IAAA,CAAAF,KAAA,CAAA3B,MAAA,CAAA8B,WAAA,CAAAD,CAAAA,GAAAA,IAAA,eAAAE,GAAA,CAAAF,IAAA,CAAAG,IAAA,CAAAL,KAAA,CAAAC,IAAA,EAAA9B,SAAAA,CAAAA,CAAAA,GAAAA,QAAAA,GAAAA,OAAA,CAAAiC,GAAA,SAAAA,GAAA,CAAA,MAAA,IAAAxB,SAAA,CAAA,8CAAA,CAAA,CAAA,OAAA,CAAA,QAAA,GAAAqB,IAAA,CAAAF,MAAA,CAAAO,MAAA,EAAAN,KAAA,CAAAO,CAAAA,SAAAA,SAAAA,CAAAC,QAAA,CAAAC,UAAA,CAAAA,CAAAA,GAAAA,UAAAA,EAAAA,OAAAA,UAAA,EAAAA,IAAAA,GAAAA,UAAA,WAAA7B,SAAA,CAAA,oDAAA,CAAA,CAAA4B,QAAA,CAAAhC,SAAA,CAAAc,MAAA,CAAAoB,MAAA,CAAAD,UAAA,EAAAA,UAAA,CAAAjC,SAAA,CAAAD,CAAAA,WAAA,CAAAoC,CAAAA,KAAA,CAAAH,QAAA,CAAAnB,QAAA,CAAA,CAAA,CAAA,CAAAD,YAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAAE,MAAA,CAAAC,cAAA,CAAAiB,QAAA,CAAAnB,WAAAA,CAAAA,CAAAA,QAAA,MAAAoB,UAAA,EAAAG,eAAA,CAAAJ,QAAA,CAAAC,UAAA,EAAAG,CAAAA,SAAAA,eAAAA,CAAAC,CAAA,CAAAC,CAAA,CAAA,CAAA,OAAAF,eAAA,CAAAtB,MAAA,CAAAyB,cAAA,CAAAzB,MAAA,CAAAyB,cAAA,CAAAC,IAAA,EAAAH,CAAAA,SAAAA,CAAA,CAAAC,CAAA,CAAA,CAAA,OAAAD,CAAA,CAAAI,SAAA,CAAAH,CAAA,CAAAD,CAAA,CAAAD,CAAAA,eAAA,CAAAC,CAAA,CAAAC,CAAA,CAAA,CAAA,SAAAI,YAAAC,CAAAA,OAAA,CAAAC,CAAAA,IAAAA,yBAAA,CAAAC,yBAAA,EAAA,CAAA,OAAA,UAAA,CAAA,IAAAC,MAAA,CAAAC,KAAA,CAAAC,eAAA,CAAAL,OAAA,CAAAC,CAAAA,GAAAA,yBAAA,CAAAK,CAAAA,IAAAA,SAAA,CAAAD,eAAA,CAAA,IAAA,CAAA,CAAAjD,WAAA,CAAA+C,MAAA,CAAAI,OAAA,CAAAC,SAAA,CAAAJ,KAAA,CAAAK,SAAA,CAAAH,SAAA,EAAA,CAAA,KAAAH,MAAA,CAAAC,KAAA,CAAAM,KAAA,CAAA,IAAA,CAAAD,SAAA,CAAA,CAAA,OAAAE,0BAAA,CAAA,IAAA,CAAAR,MAAA,CAAAQ,CAAAA,CAAAA,SAAAA,0BAAAA,CAAAC,IAAA,CAAA1B,IAAA,CAAA,CAAA,GAAAA,IAAA,GAAAlC,QAAAA,GAAAA,OAAA,CAAAkC,IAAA,CAAAA,EAAAA,UAAAA,EAAAA,OAAAA,IAAA,SAAAA,IAAA,CAAA,GAAA,KAAA,CAAA,GAAAA,IAAA,CAAA,MAAA,IAAAzB,SAAA,CAAA,0DAAA,CAAA,CAAA,OAAAoD,sBAAA,CAAAD,IAAA,CAAAC,CAAAA,SAAAA,sBAAAA,CAAAD,IAAA,CAAA,CAAA,GAAA,KAAA,CAAA,GAAAA,IAAA,CAAAE,MAAAA,IAAAA,cAAA,CAAAF,2DAAAA,CAAAA,CAAAA,OAAAA,IAAA,CAAAV,SAAAA,yBAAAA,0BAAAK,OAAA,EAAA,CAAAA,OAAA,CAAAC,SAAA,CAAA,OAAA,CAAA,CAAA,CAAA,GAAAD,OAAA,CAAAC,SAAA,CAAAO,IAAA,CAAAC,OAAAA,CAAAA,CAAAA,CAAAA,GAAAA,UAAAA,EAAAA,OAAAA,KAAA,sBAAAC,OAAA,CAAA5D,SAAA,CAAA6D,OAAA,CAAAhC,IAAA,CAAAqB,OAAA,CAAAC,SAAA,CAAAS,OAAA,4BAAAE,CAAA,CAAA,CAAA,OAAA,CAAA,CAAA,CAAA,CAAA,SAAAd,eAAAX,CAAAA,CAAA,CAAAW,CAAAA,OAAAA,eAAA,CAAAlC,MAAA,CAAAyB,cAAA,CAAAzB,MAAA,CAAAiD,cAAA,CAAAvB,IAAA,EAAAH,CAAAA,SAAAA,CAAA,CAAAA,CAAAA,OAAAA,CAAA,CAAAI,SAAA,EAAA3B,MAAA,CAAAiD,cAAA,CAAA1B,CAAA,CAAAW,CAAAA,CAAAA,eAAA,CAAAX,CAAA,CAEb,CAAA;AACA;AACA;AACA,GAJA2B,qBAAqB,CAACC,MAAM,CAAG,eAAe,CAK9CC,MAAM,CAACC,8BAA8B,cAAA,SAAAC,qBAAA,CACpC,mBACA,SAAAD,8BAAYE,CAAAA,SAAS,CAAE,CAAAC,IAAAA,KAAA,CAAArE,eAAA,MAAAkE,8BAAA,CAAA,CAAAG,KAAA,CAAAC,MAAA,CAAA1C,IAAA,CAAA,IAAA,CAChBwC,SAAS,CAAA,CACfC,KAAA,CAAKE,OAAO,CAAGF,KAAA,CAAKG,WAAW,CAAGH,KAAA,CAAKI,SAAS,CAAGJ,KAAA,CAAKK,MAAM,CAAGL,KAAA,CAAKM,SAAS,CAAQ,CAAA,CAAA,CACvF,GAAI,CACHN,KAAA,CAAKO,aAAa,GACnB,CAAE,MAAOf,CAAC,CAAE,CACXgB,OAAO,CAACC,IAAI,CAAC,uBAAuB,CAAGjB,CAAC,CAAC,CACzCQ,KAAA,CAAKM,SAAS,CAAA,CAAA,EACf,CAAC,OACDN,KAAA,CAAKD,SAAS,CAACW,IAAI,CAAC,sBAAsB,CAAC,CAACC,EAAE,CAAC,OAAO,CAAE,UAAO,CAC1DX,KAAA,CAAKM,SAAS,EACjBN,KAAA,CAAKY,YAAY,GAEnB,CAAC,CAAC,CAAAZ,KACH,CACA,kBAAAvC,SAAA,CAAAoC,8BAAA,CAAAC,qBAAA,CAAAG,CAAAA,IAAAA,MAAA,CAAA7B,YAAA,CAAAyB,8BAAA,CAAAjD,CAAAA,OAAAA,YAAA,CAAAiD,8BAAA,CAAA,CAAA,CAAAlD,GAAA,CAAA,aAAA,CAAAkB,KAAA,CACA,SAAAgD,YAAYC,IAAI,CAAE,CACb,IAAI,CAACR,SAAS,CACjB,IAAI,CAACS,OAAO,CACX,MAAM,CAAA,+BAAA,CAAAC,MAAA,CACwBF,IAAI,CAACG,KAAK,6FACzC,CAAC,CAEDC,GAAG,CAACC,SAAS,CAAC,CACbC,KAAK,CAAEF,GAAG,CAACG,UAAU,CAAC,qBAAqB,CAC5C,CAAC,EAEH,CACA;AACD;AACA,OAFC1E,GAAA,CAAA,eAAA,CAAAkB,KAAA,CAGA,SAAA0C,aAAA,EAAgB,CAAAe,IAAAA,MAAA,MACf,IAAI,CAAChB,SAAS,CAAQ,CAAA,CAAA,CACtB,IAAI,CAACiB,SAAS,CAAG,IAAIC,SAAS,CAAC,gEAAgE,CAAC,CAChG,IAAI,CAACD,SAAS,CAACE,MAAM,CAAG,SAACjC,CAAC,CAAK,CAC9B8B,MAAI,CAAChB,SAAS,CAAO,CAAA,CAAA,CACrBgB,MAAI,CAACI,SAAS,CAAC,WAAW,CAAElC,CAAC,CAAC,CAC9B8B,MAAI,CAACK,SAAS,CAAC,SAAS,CAAE,gCAAgC,EAC3D,CAAC,CACD,IAAI,CAACJ,SAAS,CAACK,OAAO,CAAG,SAACpC,CAAC,CAAK,CAC3B8B,MAAI,CAAChB,SAAS,CACjBgB,MAAI,CAACI,SAAS,CAAC,cAAc,CAAElC,CAAC,CAAC,CAEjC8B,MAAI,CAACI,SAAS,CAAC,OAAO,CAAElC,CAAC,CAAC,CAE3B8B,MAAI,CAAChB,SAAS,CAAA,CAAA,CAAQ,CACtBuB,UAAU,CAAC,UAAM,CAChBP,MAAI,CAACf,aAAa,GACnB,CAAC,CAAE,GAAI,EACR,CAAC,CACD,IAAI,CAACgB,SAAS,CAACO,OAAO,CAAG,SAACtC,CAAC,CAAK,CAC/B8B,MAAI,CAAChB,SAAS,GAAQ,CACtBgB,MAAI,CAACI,SAAS,CAAC,OAAO,CAAElC,CAAC,CAAC,CAC1B8B,MAAI,CAACC,SAAS,CAACQ,KAAK,GACrB,CAAC,CACD,IAAI,CAACR,SAAS,CAACS,SAAS,CAAG,SAACxC,CAAC,CAAK,CACjC8B,MAAI,CAACW,QAAQ,CAACzC,CAAC,CAACsB,IAAI,EACrB,EACD,CACA;AACD;AACA,KAFC,CAAA,CAAAnE,GAAA,CAAA,WAAA,CAAAkB,KAAA,CAGA,SAAAqE,SAAAA,EAAY,CACX,IAAMC,GAAG,CAAG,IAAI,CAACpC,SAAS,CAACW,IAAI,CAAC,sBAAsB,CAAC,CACtD0B,OAAO,CAAGD,GAAG,CAACzB,IAAI,CAAC,UAAU,CAAC,CAC9BR,OAAO,CAAGiC,GAAG,CAACzB,IAAI,CAAC,UAAU,CAAC,CAC/ByB,GAAG,CAACE,WAAW,CAAC,QAAQ,CAAC,CACzBF,GAAG,CAACG,IAAI,CAAC,OAAO,CAAE,SAAUnG,CAAC,CAAEoG,CAAC,CAAE,CACjC,OAAOA,CAAC,CAACC,OAAO,CAAC,gBAAgB,CAAE,EAAE,CACtC,CAAC,CAAC,CACF,IAAIpB,KAAK,CAAG,IAAI,CAACf,MAAM,CACvB,OAAQ,IAAI,CAACA,MAAM,EAClB,IAAK,SAAS,CACb8B,GAAG,CAACM,QAAQ,CAAC,aAAa,CAAC,CAC3BL,OAAO,CAACC,WAAW,EAAE,CAACI,QAAQ,CAAC,kCAAkC,CAAC,CAClE,MACD,IAAK,qBAAqB,CACzBN,GAAG,CAACM,QAAQ,CAAC,aAAa,CAAC,CAC3BL,OAAO,CAACC,WAAW,EAAE,CAACI,QAAQ,CAAC,iCAAiC,CAAC,CACjE,MACD,IAAK,cAAc,CACnB,IAAK,OAAO,CACXN,GAAG,CAACM,QAAQ,CAAC,YAAY,CAAC,CAC1BL,OAAO,CAACC,WAAW,EAAE,CAACI,QAAQ,CAAC,iCAAiC,CAAC,CACjE,MACD,IAAK,WAAW,CAChB,QACCN,GAAG,CAACM,QAAQ,CAAC,aAAa,CAAC,CAC3BL,OAAO,CAACC,WAAW,EAAE,CAACI,QAAQ,CAAC,gCAAgC,EAEjE,CACI,IAAI,CAACrC,SAAS,GAAK,IAAI,CAACA,SAAS,CAACsC,IAAI,EAAI,IAAI,CAACtC,SAAS,CAACuC,IAAI,CAAC,GACjEvB,KAAK,EAAI,IAAI,EAAI,IAAI,CAAChB,SAAS,CAACsC,IAAI,EAAI,IAAI,CAACtC,SAAS,CAACuC,IAAI,CAAC,CAAG,GAAG,CAEnER,CAAAA,GAAG,CAACG,IAAI,CAAC,OAAO,CAAElB,KAAK,CAAC,CACpB,IAAI,CAAClB,OAAO,CACfA,OAAO,CAAC0C,IAAI,CAAC,IAAI,CAAC1C,OAAO,CAAC,CAACuC,QAAQ,CAAC,MAAM,CAAC,CAE3CvC,OAAO,CAACmC,WAAW,CAAC,MAAM,EAE5B,CACA;AACD;AACA;AACA,KAHC1F,CAAAA,CAAAA,GAAA,CAAAkB,UAAAA,CAAAA,KAAA,CAIA,SAAAoE,QAAAA,CAASnB,IAAI,CAAE,CACd,IAAM+B,OAAO,CAAG,IAAI,CAACC,YAAY,CAAChC,IAAI,CAAC,CACvC,GAAI+B,OAAO,CAAAE,SAAa,CACvB,IAAI,CAACrB,SAAS,CAACmB,OAAO,CAAAG,SAAa,CAAC,CAAA,KAE5BH,OAAAA,OAAO,CAAAI,WAAe,EAC7B,IAAK,UAAU,CACd,IAAI,CAACC,QAAQ,CAACL,OAAO,CAAAM,GAAO,CAAC,CAC7B,MACD,IAAK,OAAO,CACX,IAAI,CAACC,KAAK,CAACP,OAAO,CAAAM,GAAO,EAE3B,CAED,IAAI,CAACjB,SAAS,GACf,CACA;AACD;AACA;AACA,KAHC,CAAA,CAAAvF,GAAA,CAAAkB,UAAAA,CAAAA,KAAA,CAIA,SAAAqF,QAAAA,CAASC,GAAG,CAAE,CACb,GAAIA,GAAG,CAAE,CACR,IAAME,IAAI,CAAGF,GAAG,CAACG,QAAQ,CAAC,QAAQ,CAAC,CAAChB,IAAI,CAAC,MAAM,CAAC,CAC/CiB,EAAE,CAAG,SAAS,CAAGF,IAAI,CAACG,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,EAAE,CAAGJ,IAAI,CAACK,KAAK,CAAC,CAAC,CAAC,CAC9D,IAAI,CAACC,GAAG,CAAC,WAAM,CAAGJ,EAAE,CAAG,IAAI,EAAIA,EAAE,IAAI,IAAI,CAAC,CAAG,GAAG,CAAEJ,GAAG,CAACS,GAAG,CAAC,CAAC,CAAC,CAAC,CACzDL,EAAE,IAAI,IAAI,EACb,IAAI,CAACA,EAAE,CAAC,CAACJ,GAAG,CAACzC,IAAI,CAAC2C,IAAI,CAAC,EAEzB,CACD,CACA;AACD;AACA;AACA,OAHC1G,GAAA,CAAA,OAAA,CAAAkB,KAAA,CAIA,SAAAuF,MAAMD,GAAG,CAAE,CACV,GAAIA,GAAG,CAAE,CACR,IAAME,IAAI,CAAGF,GAAG,CAACG,QAAQ,CAAC,QAAQ,CAAC,CAAChB,IAAI,CAAC,MAAM,CAAC,CAC/CiB,EAAE,CAAG,OAAO,CAAGF,IAAI,CAACG,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,EAAE,CAAGJ,IAAI,CAACK,KAAK,CAAC,CAAC,CAAC,CAC5D,IAAI,CAACC,GAAG,CAAC,WAAM,CAAGJ,EAAE,CAAG,IAAI,EAAIA,EAAE,QAAQ,CAAC,CAAG,GAAG,CAAEJ,GAAG,CAACS,GAAG,CAAC,CAAC,CAAC,CAAC,CACzDL,EAAE,IAAQ,IAAA,EACb,IAAI,CAACA,EAAE,CAAC,GAEV,CACD,CACA;AACD;AACA;AACA;AACA,OAJC5G,GAAA,CAAA,gBAAA,CAAAkB,KAAA,CAKA,SAAAgG,eAAeV,GAAG,CAAE,CACnB,IAAI,CAACjD,OAAO,CAAG,IAAI,CAACC,WAAW,CAAGgD,GAAG,CAACzC,IAAI,CAAC,aAAa,CAAC,CAACkC,IAAI,EAAE,CAChE,IAAM/E,KAAK,CAAGqD,GAAG,CAAC4C,QAAQ,CAAC,4BAA4B,CAAG,IAAI,CAAC3D,WAAW,CAAE,IAAI,CAAC,CAAC,CACrE,IAAI,EAAbtC,KAAa,EAA8C,GAAG,CAA7CkG,IAAI,CAACC,KAAK,CAAC,CAACC,IAAI,CAACC,GAAG,EAAE,CAAGrG,KAAK,EAAI,GAAI,CAAO,IACjEqD,GAAG,CAACiD,UAAU,CAAC,4BAA4B,CAAG,IAAI,CAAChE,WAAW,CAAC,CAC/D,IAAI,CAACwB,SAAS,CAAC,aAAa,CAAE,6CAA6C,CAAC,EAE9E,CACA;AACD;AACA;AACA;AACA,KAJChF,CAAAA,CAAAA,GAAA,CAAAkB,oBAAAA,CAAAA,KAAA,CAKA,SAAAuG,kBAAAA,CAAmBjB,GAAG,CAAE,CAAAkB,IAAAA,MAAA,CACnBC,IAAAA,CAAAA,KAAK,CAAG,EAAE,CACdnB,GAAG,CAACoB,IAAI,CAAC,SAACC,CAAC,CAAEC,QAAQ,CAAK,CACzB,IAAIlH,IAAI,CAAG,EAAE,CACbmH,CAAC,CAACD,QAAQ,CAAC,CACTnB,QAAQ,EAAE,CACViB,IAAI,CAAC,SAACC,CAAC,CAAEG,OAAO,CAAK,CACrBpH,IAAI,CAACoH,OAAO,CAACC,OAAO,CAAC,CAAGD,OAAO,CAACE,YACjC,CAAC,CAAC,CACHP,KAAK,CAACQ,IAAI,CAACvH,IAAI,EAChB,CAAC,CAAC,CACFwH,YAAY,CAACC,OAAO,CAAC,CACpBC,MAAM,CAAE,eAAe,CACvBC,MAAM,CAAE,KAAK,CACbC,IAAI,CAAE,WAAW,CACjBhF,WAAW,CAAE,IAAI,CAACA,WAAW,CAC7BmE,KAAK,CAAEA,KACR,CAAC,CAAC,CAACc,IAAI,CAAC,SAAClC,QAAQ,CAAK,CACjB,CAAA,CAAA,GAAAA,QAAQ,CAAC1E,MAAM,CAAC6G,QAAiB,EACpChB,MAAI,CAAC1C,SAAS,CAAC,aAAa,CAAE,8CAA8C,EAE9E,CAAC,CAAC,CACFT,GAAG,CAACoE,QAAQ,CAAC,4BAA4B,CAAG,IAAI,CAACnF,WAAW,CAAE8D,IAAI,CAACC,GAAG,EAAE,EACzE,CACA;AACD;AACA;AACA;AACA,KAJC,CAAA,CAAAvH,GAAA,CAAAkB,aAAAA,CAAAA,KAAA,CAKA,SAAA0H,WAAAA,CAAYpC,GAAG,CAAE,CACZA,GAAG,CAAC/G,MAAM,EACb,IAAI,CAACsF,SAAS,CAAC,SAAS,CAAC,CACzB,IAAI,CAACxB,OAAO,CAAGiD,GAAG,CAACzC,IAAI,CAAC,aAAa,CAAC,CAACkC,IAAI,EAAE,GAE7C,IAAI,CAAClB,SAAS,CAAC,WAAW,CAAC,CAC3B,IAAI,CAACxB,OAAO,CAAG,IAAI,CAACC,WAAW,EAEjC,CACA;AACD;AACA;AACA,OAHCxD,GAAA,CAAA,kBAAA,CAAAkB,KAAA,CAIA,SAAA2H,gBAAA,EAAmB,CAClB,IAAI,CAAC7D,SAAS,CAAC,aAAa,CAAE,4CAA4C,EAC3E,CACA;AACD;AACA;AACA,KAHC,CAAA,CAAAhF,GAAA,CAAAkB,WAAAA,CAAAA,KAAA,CAIA,SAAA4H,SAAAA,EAAY,CACX,IAAI,CAAC/D,SAAS,CAAC,SAAS,CAAC,CACzB,IAAI,CAACC,SAAS,CAAC,MAAM,EACtB,CACA;AACD;AACA;AACA;AACA;AACA,KALChF,CAAAA,CAAAA,GAAA,CAAAkB,WAAAA,CAAAA,KAAA,CAMA,SAAA8D,SAAAA,CAAU0B,IAAI,CAAEqC,MAAM,CAAE,CAClBA,MAAM,GACVA,MAAM,CAAG,EAAE,CAAA,CAEZ,IAAI,CAAC3E,OAAO,CAAC,QAAQ,CAAAC,gBAAAA,CAAAA,MAAA,CAAmBqC,IAAI,YAAArC,MAAA,CAAU0E,MAAM,CAAA,WAAA,CAAW,EACxE,CACA;AACD;AACA;AACA,OAHC/I,GAAA,CAAA,cAAA,CAAAkB,KAAA,CAIA,SAAA+C,YAAA,EAAe,CACd,IAAI,CAACG,OAAO,CAAC,cAAc,CAAA,oDAAsD,EAClF,CACA;AACD;AACA;AACA;AACA,OAJCpE,GAAA,CAAA,WAAA,CAAAkB,KAAA,CAKA,SAAA6D,SAAUrB,CAAAA,MAAM,CAAEb,CAAC,CAAE,CACpB,IAAI,CAACa,MAAM,CAAGA,MAAM,CACpB,IAAI,CAACD,SAAS,CAAGZ,CAAC,CAClB,IAAI,CAAC0C,SAAS,EAAE,CAChB,IAAI,CAACyB,GAAG,CAAC,WAAM,CAAGtD,MAAM,EACzB,CACA;AACD;AACA;AACA;AACA,KAJC1D,CAAAA,CAAAA,GAAA,CAAAkB,SAAAA,CAAAA,KAAA,CAKA,SAAAkD,OAAQ4E,CAAAA,MAAM,CAAEC,IAAI,CAAE,CACrB,IAAI,CAACjC,GAAG,CAAC,WAAM,CAAGgC,MAAM,CAAEC,IAAI,CAAC,CAC/BA,IAAI,CAAG,iDAA6C,CAAGA,IAAI,CAC3D,IAAIC,GAAG,CAAG,OAAO,CAAGF,MAAM,CAAG,+BAA+B,CAC5DE,GAAG,EAAI,uDAAuD,CAC9DA,GAAG,EAAID,IAAI,CAACxJ,MAAM,CAAG,UAAU,CAAGwJ,IAAI,CACtC,IAAI,CAACrE,SAAS,CAACuE,IAAI,CAACD,GAAG,EACxB,CACA;AACD;AACA;AACA;AACA,KAJClJ,CAAAA,CAAAA,GAAA,CAAAkB,cAAAA,CAAAA,KAAA,CAKA,SAAAiF,YAAa+C,CAAAA,GAAG,CAAE,CAAA,IACb3C,QAAQ,CAAG,EAAE,CAChB6C,OAAO,CAAG,EAAE,CACPC,KAAK,CAAGH,GAAG,CAACrD,OAAO,CAAC,OAAO,CAAE,IAAI,CAAC,CAACyD,KAAK,CAAC,IAAI,CAAC,CAChDC,IAAI,CAAGF,KAAK,CAAC,CAAC,CAAC,CACM,MAAM,EAA3BE,IAAI,CAACC,MAAM,CAAC,CAAC,CAAE,CAAC,CAAW,EAC9BjD,QAAQ,CAAAD,WAAe,CAAG,OAAO,CACjCiD,IAAI,CAAGA,IAAI,CAACC,MAAM,CAAC,CAAC,CAAC,CAACC,IAAI,EAAE,CAC5BlD,QAAQ,CAAAmD,SAAa,CAAGH,IAAI,CAACC,MAAM,CAAC,CAAC,CAAE,EAAE,CAAC,EACX,UAAU,EAA/BD,IAAI,CAACC,MAAM,CAAC,CAAC,CAAE,CAAC,CAAe,GACzCD,IAAI,CAAGA,IAAI,CAACC,MAAM,CAAC,CAAC,CAAC,CAACC,IAAI,EAAE,CACH,QAAQ,EAA7BF,IAAI,CAACC,MAAM,CAAC,CAAC,CAAE,CAAC,CAAa,CAChCjD,QAAQ,CAAAD,WAAe,CAAG,UAAU,CACf,CAAA,GAAG,EAAdiD,IAAI,CAAC,CAAC,CAAQ,EAAe,GAAG,EAAdA,IAAI,CAAC,CAAC,CAAQ,IAC1ChD,QAAQ,CAAAD,WAAe,CAAG,OAAO,CACjCC,QAAQ,CAAAH,SAAa,CAAGmD,IAAI,CAACC,MAAM,CAAC,CAAC,CAAE,CAAC,CAAC,CACzCjD,QAAQ,CAAAF,SAAa,CAAGkD,IAAI,CAACC,MAAM,CAAC,CAAC,CAAC,CAAA,CAAA,CAIxC,IADA,IAAIhK,CAAC,CAAG,CAAE,CACHA,CAAC,CAAG6J,KAAK,CAAC5J,MAAM,EACH,GAAG,EAAlB4J,KAAK,CAAC7J,CAAC,CAAC,CAAC,CAAC,CAAQ,CADEA,CAAC,EAAE,CAI1B,SAGF,KAAOA,CAAC,CAAG6J,KAAK,CAAC5J,MAAM,CAAED,CAAC,EAAE,CAC3B4J,OAAO,EAAIC,KAAK,CAAC7J,CAAC,CAAC,CACfA,CAAC,CAAG6J,KAAK,CAAC5J,MAAM,CAAG,CAAC,GACvB2J,OAAO,EAAI,IAAI,CAGjB,CAAA,GAAqB,CAAC,CAAlBA,OAAO,CAAC3J,MAAU,CAAE,CACvB,IAAMkK,MAAM,CAAG,IAAIC,SAAW,CAC9BrD,QAAQ,CAAAC,GAAO,CAAGuB,CAAC,CAAC4B,MAAM,CAACE,eAAe,CAACT,OAAO,CAAE,UAAU,CAAC,EAChE,CACA,OAAO7C,QACR,CAAC,CAAA,CAAA,CAAA,CAAArD,8BAAA,CAAA,CApTmFH,qBAAqB,CAqTzG;;"}