{"version":3,"file":"Inventory.min.js","sources":["Inventory.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Vtiger_Inventory_Js',\n\t{\n\t\tinventoryInstance: false,\n\n\t\t/**\n\t\t * Get inventory instance\n\t\t * @param {jQuery} container\n\t\t * @returns {Vtiger_Inventory_Js}\n\t\t */\n\t\tgetInventoryInstance: function (container) {\n\t\t\tif (this.inventoryInstance === false) {\n\t\t\t\tlet moduleClassName = container.find('[name=\"module\"]').val() + '_Inventory_Js';\n\t\t\t\tif (typeof window[moduleClassName] === 'undefined') {\n\t\t\t\t\tmoduleClassName = 'Vtiger_Inventory_Js';\n\t\t\t\t}\n\t\t\t\tif (typeof window[moduleClassName] !== 'undefined') {\n\t\t\t\t\tthis.inventoryInstance = new window[moduleClassName]();\n\t\t\t\t\tthis.inventoryInstance.registerEvents(container);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.inventoryInstance;\n\t\t}\n\t},\n\t{\n\t\tform: false,\n\t\tdiscount: false,\n\t\ttax: false,\n\t\tcontainer: false,\n\t\tinventoryContainer: false,\n\t\tinventoryHeadContainer: false,\n\t\tsummaryTaxesContainer: false,\n\t\tsummaryDiscountContainer: false,\n\t\tsummaryCurrenciesContainer: false,\n\t\trowClass: 'tr.inventoryRow',\n\t\tdiscountModalFields: [\n\t\t\t'aggregationType',\n\t\t\t'globalDiscount',\n\t\t\t'groupCheckbox',\n\t\t\t'groupDiscount',\n\t\t\t'individualDiscount',\n\t\t\t'individualDiscountType',\n\t\t\t'additionalDiscount'\n\t\t],\n\t\ttaxModalFields: ['aggregationType', 'globalTax', 'groupCheckbox', 'groupTax', 'individualTax', 'regionalTax'],\n\t\t/**\n\t\t * Get current form element\n\t\t * @returns {jQuery}\n\t\t */\n\t\tgetForm() {\n\t\t\treturn this.form;\n\t\t},\n\t\t/**\n\t\t * Get current form element\n\t\t * @returns {jQuery}\n\t\t */\n\t\tloadConfig() {\n\t\t\tlet discontConfig = this.form.find('.js-discount-config');\n\t\t\tlet taxConfig = this.form.find('.js-tax-config');\n\n\t\t\tthis.discount = discontConfig.length ? JSON.parse(discontConfig.val()) : {};\n\t\t\tthis.tax = taxConfig.length ? JSON.parse(taxConfig.val()) : {};\n\t\t},\n\t\t/**\n\t\t * Function that is used to get the line item container\n\t\t * @return : jQuery object\n\t\t */\n\t\tgetContainer: function () {\n\t\t\tif (this.container === false) {\n\t\t\t\tthis.container = $('.js-inv-container');\n\t\t\t}\n\t\t\treturn this.container;\n\t\t},\n\t\tgetInventoryItemsContainer: function () {\n\t\t\treturn this.getContainer().find('.inventoryItems');\n\t\t},\n\t\tgetInventoryHeadContainer: function () {\n\t\t\tif (this.inventoryHeadContainer === false) {\n\t\t\t\tthis.inventoryHeadContainer = $('.inventoryHeader');\n\t\t\t}\n\t\t\treturn this.inventoryHeadContainer;\n\t\t},\n\t\tgetInventorySummaryDiscountContainer: function () {\n\t\t\tif (this.summaryDiscountContainer === false) {\n\t\t\t\tthis.summaryDiscountContainer = $('.inventorySummaryDiscounts');\n\t\t\t}\n\t\t\treturn this.summaryDiscountContainer;\n\t\t},\n\t\tgetInventorySummaryTaxesContainer: function () {\n\t\t\tif (this.summaryTaxesContainer === false) {\n\t\t\t\tthis.summaryTaxesContainer = $('.inventorySummaryTaxes');\n\t\t\t}\n\t\t\treturn this.summaryTaxesContainer;\n\t\t},\n\t\tgetInventorySummaryCurrenciesContainer: function () {\n\t\t\tif (this.summaryCurrenciesContainer === false) {\n\t\t\t\tthis.summaryCurrenciesContainer = $('.inventorySummaryCurrencies');\n\t\t\t}\n\t\t\treturn this.summaryCurrenciesContainer;\n\t\t},\n\t\tgetNextLineItemRowNumber: function () {\n\t\t\tlet $inventoryItemsNo = $('#inventoryItemsNo');\n\t\t\tlet rowNumber = parseInt($inventoryItemsNo.val()) + 1;\n\t\t\t$inventoryItemsNo.val(rowNumber);\n\t\t\treturn rowNumber;\n\t\t},\n\t\tgetAccountId: function () {\n\t\t\tlet accountReferenceField = $('#accountReferenceField').val();\n\t\t\tif (accountReferenceField != '') {\n\t\t\t\treturn $('[name=\"' + accountReferenceField + '\"]').val();\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\tcheckDeleteIcon: function () {\n\t\t\tif (this.getInventoryItemsContainer().find(this.rowClass).length > 1) {\n\t\t\t\tthis.showLineItemsDeleteIcon();\n\t\t\t} else if (app.getMainParams('isRequiredInventory')) {\n\t\t\t\tthis.hideLineItemsDeleteIcon();\n\t\t\t}\n\t\t},\n\t\tshowLineItemsDeleteIcon: function () {\n\t\t\tthis.getInventoryItemsContainer().find('.deleteRow').removeClass('d-none');\n\t\t},\n\t\thideLineItemsDeleteIcon: function () {\n\t\t\tthis.getInventoryItemsContainer().find('.deleteRow').addClass('d-none');\n\t\t},\n\t\tgetClosestRow: function (element) {\n\t\t\treturn element.closest(this.rowClass);\n\t\t},\n\t\t/**\n\t\t * Function which will return the basic row which can be used to add new rows\n\t\t * @return jQuery object which you can use to\n\t\t */\n\t\tgetBasicRow: function () {\n\t\t\treturn this.getForm().find('.js-inventory-base-item').eq(0).clone(true, true);\n\t\t},\n\t\tisRecordSelected: function (element) {\n\t\t\tlet parentRow = element.closest('tr');\n\t\t\tlet productField = parentRow.find('.recordLabel');\n\t\t\treturn productField.validationEngine('validate');\n\t\t},\n\t\tgetTaxModeSelectElement: function (row) {\n\t\t\tlet items = this.getInventoryHeadContainer();\n\t\t\tif (items.find('thead .js-taxmode').length > 0) {\n\t\t\t\treturn $('.js-taxmode');\n\t\t\t}\n\t\t\tif (row) {\n\t\t\t\treturn row.find('.js-taxmode');\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tisIndividualTaxMode: function (row) {\n\t\t\tlet selectedOption = this.getTaxModeSelectElement(row).find('option:selected');\n\t\t\tif (selectedOption.length !== 0) {\n\t\t\t\treturn selectedOption.val() == 1;\n\t\t\t}\n\t\t\treturn this.tax.default_mode == 1;\n\t\t},\n\t\tisGroupTaxMode: function () {\n\t\t\tlet selectedOption = this.getTaxModeSelectElement();\n\t\t\tif (selectedOption && (selectedOption = selectedOption.find('option:selected')) && selectedOption.length !== 0) {\n\t\t\t\treturn selectedOption.val() == 0;\n\t\t\t}\n\t\t\treturn this.tax.default_mode == 0;\n\t\t},\n\t\tshowIndividualTax: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet groupTax = thisInstance.getInventoryItemsContainer().find('.js-inv-tax_global');\n\t\t\tlet items = thisInstance.getInventoryItemsContainer().find('.js-inventory-items-body');\n\t\t\tlet newRow = $('#blackIthemTable').find('tbody');\n\t\t\tif (thisInstance.isIndividualTaxMode()) {\n\t\t\t\tgroupTax.addClass('d-none');\n\t\t\t\titems.find('.changeTax').removeClass('d-none');\n\t\t\t\tnewRow.find('.changeTax').removeClass('d-none');\n\t\t\t\tlet parentRow = thisInstance.getInventoryItemsContainer();\n\t\t\t\tlet taxParam = { aggregationType: 'global' };\n\n\t\t\t\tparentRow.find(thisInstance.rowClass).each(function () {\n\t\t\t\t\tlet thisItem = $(this);\n\t\t\t\t\ttaxParam['globalTax'] = parseFloat(thisItem.find('.js-tax').attr('data-default-tax'));\n\t\t\t\t\tthisInstance.setTaxParam(thisItem, taxParam);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthisInstance.setTax(items, 0);\n\t\t\t\tthisInstance.setTaxPercent(items, 0);\n\t\t\t\tthisInstance.setTaxParam(items, []);\n\t\t\t\tthisInstance.setDefaultGlobalTax();\n\t\t\t\tgroupTax.removeClass('d-none');\n\t\t\t\titems.find('.changeTax').addClass('d-none');\n\t\t\t\tnewRow.find('.changeTax').addClass('d-none');\n\t\t\t}\n\t\t\tthisInstance.rowsCalculations();\n\t\t},\n\t\tsetDefaultGlobalTax: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet parentRow = thisInstance.getInventoryItemsContainer();\n\t\t\tlet taxDefaultValue = thisInstance\n\t\t\t\t.getInventorySummaryTaxesContainer()\n\t\t\t\t.find('.js-default-tax')\n\t\t\t\t.data('tax-default-value');\n\t\t\tlet isGroupTax = thisInstance.isGroupTaxMode();\n\t\t\tlet summaryContainer = $('#blackIthemTable');\n\t\t\tif (isGroupTax) {\n\t\t\t\tlet taxParam = thisInstance.getTaxParams(summaryContainer);\n\t\t\t\tif (taxParam === false && taxDefaultValue) {\n\t\t\t\t\ttaxParam = { aggregationType: 'global' };\n\t\t\t\t\ttaxParam['globalTax'] = taxDefaultValue;\n\t\t\t\t\ttaxParam['individualTax'] = '';\n\t\t\t\t}\n\t\t\t\tif (taxParam) {\n\t\t\t\t\tthisInstance.setTaxParam(summaryContainer, taxParam);\n\t\t\t\t\tthisInstance.setTaxParam(parentRow, taxParam);\n\t\t\t\t\tparentRow.closest('.inventoryItems').data('taxParam', JSON.stringify(taxParam));\n\t\t\t\t\tparentRow.find(thisInstance.rowClass).each(function () {\n\t\t\t\t\t\tthisInstance.quantityChangeActions($(this));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthisInstance.setTaxParam(summaryContainer, []);\n\t\t\t\tparentRow.closest('.inventoryItems').data('taxParam', '[]');\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Get discount mode\n\t\t * @returns {int}\n\t\t */\n\t\tgetDiscountMode: function () {\n\t\t\tlet selectedOption = this.getContainer().find('.js-discountmode option:selected');\n\t\t\treturn selectedOption.length ? selectedOption.val() : this.discount.default_mode;\n\t\t},\n\t\tgetCurrency: function () {\n\t\t\treturn $('.js-currency', this.getInventoryHeadContainer()).find('option:selected').val();\n\t\t},\n\t\t/**\n\t\t * Get discount aggregation\n\t\t * @returns {int}\n\t\t */\n\t\tgetDiscountAggregation: function () {\n\t\t\tconst element = $('.js-discount_aggreg', this.getInventoryHeadContainer()).find('option:selected');\n\t\t\tif (element.length) {\n\t\t\t\treturn parseInt(element.val());\n\t\t\t}\n\t\t\treturn parseInt(this.discount.aggregation);\n\t\t},\n\t\tgetTax: function (row) {\n\t\t\tconst self = this;\n\t\t\tlet taxParams = row.find('.taxParam').val();\n\t\t\tif (taxParams == '' || taxParams == '[]' || taxParams == undefined) return 0;\n\t\t\ttaxParams = JSON.parse(taxParams);\n\t\t\tlet valuePrices = this.getNetPrice(row);\n\t\t\tlet taxRate = 0;\n\t\t\tlet types = taxParams.aggregationType;\n\t\t\tif (typeof types == 'string') {\n\t\t\t\ttypes = [types];\n\t\t\t}\n\t\t\tif (types) {\n\t\t\t\ttypes.forEach(function (entry) {\n\t\t\t\t\tlet taxValue = 0;\n\t\t\t\t\tswitch (entry) {\n\t\t\t\t\t\tcase 'individual':\n\t\t\t\t\t\t\ttaxValue = taxParams.individualTax;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'global':\n\t\t\t\t\t\t\ttaxValue = taxParams.globalTax;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'group':\n\t\t\t\t\t\t\ttaxValue = taxParams.groupTax;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'regional':\n\t\t\t\t\t\t\ttaxValue = taxParams.regionalTax;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ttaxRate += valuePrices * (taxValue / 100);\n\t\t\t\t\tif (self.tax.aggregation == 2) {\n\t\t\t\t\t\tvaluePrices = valuePrices + taxRate;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn taxRate;\n\t\t},\n\t\tgetTaxPercent: function (row) {\n\t\t\tlet taxParams = row.find('.taxParam').val();\n\t\t\tif (taxParams == '' || taxParams == '[]' || taxParams == undefined) return 0;\n\t\t\ttaxParams = JSON.parse(taxParams);\n\t\t\tlet taxPercent = 0;\n\t\t\tlet types =\n\t\t\t\ttypeof taxParams.aggregationType === 'string' ? [taxParams.aggregationType] : taxParams.aggregationType;\n\t\t\ttypes.forEach(function (aggregationType) {\n\t\t\t\ttaxPercent += taxParams[aggregationType + 'Tax'] || 0;\n\t\t\t});\n\t\t\treturn taxPercent;\n\t\t},\n\t\tgetTaxParams: function (row) {\n\t\t\tlet taxParams = row.find('.taxParam').val();\n\t\t\tif (taxParams == '' || taxParams == '[]' || taxParams == undefined) return false;\n\t\t\treturn JSON.parse(taxParams);\n\t\t},\n\t\tgetQuantityValue: function (row) {\n\t\t\treturn $('.qty', row).getNumberFromValue();\n\t\t},\n\t\tgetUnitPriceValue: function (row) {\n\t\t\treturn $('.unitPrice', row).getNumberFromValue();\n\t\t},\n\t\tgetDiscount: function (row) {\n\t\t\tlet discountParams = row.find('.discountParam').val();\n\t\t\tif (discountParams == '' || discountParams == 'null' || discountParams == '[]' || discountParams == undefined) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tconst aggregation = this.getDiscountAggregation();\n\t\t\tdiscountParams = JSON.parse(discountParams);\n\t\t\tlet valuePrices = this.getTotalPrice(row),\n\t\t\t\tdiscountRate = 0,\n\t\t\t\ttypes = discountParams.aggregationType;\n\t\t\tif (typeof types == 'string') {\n\t\t\t\ttypes = [types];\n\t\t\t}\n\t\t\tif (types) {\n\t\t\t\ttypes.forEach((entry) => {\n\t\t\t\t\tswitch (entry) {\n\t\t\t\t\t\tcase 'global':\n\t\t\t\t\t\t\tdiscountRate += valuePrices * (discountParams.globalDiscount / 100);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'group':\n\t\t\t\t\t\t\tdiscountRate += valuePrices * ((discountParams.groupDiscount ? discountParams.groupDiscount : 0) / 100);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'individual':\n\t\t\t\t\t\t\tif (discountParams.individualDiscountType === 'percentage') {\n\t\t\t\t\t\t\t\tdiscountRate += valuePrices * (discountParams.individualDiscount / 100);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdiscountRate += discountParams.individualDiscount;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'additional':\n\t\t\t\t\t\t\tdiscountRate += valuePrices * (discountParams.additionalDiscount / 100);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif (aggregation == this.AGGREGATION_CASCADE) {\n\t\t\t\t\t\tvaluePrices = valuePrices - (discountParams.type === 'markup' ? -discountRate : discountRate);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn discountRate;\n\t\t},\n\t\tgetNetPrice: function (row) {\n\t\t\tlet discount = this.getDiscount(row);\n\t\t\tlet discountParams = row.find('.discountParam').val();\n\t\t\tif (discount && discountParams && JSON.parse(discountParams).type === 'markup') {\n\t\t\t\tdiscount = -discount;\n\t\t\t}\n\n\t\t\treturn this.getTotalPrice(row) - discount;\n\t\t},\n\t\tgetTotalPrice: function (row) {\n\t\t\treturn this.getQuantityValue(row) * this.getUnitPriceValue(row);\n\t\t},\n\t\tgetGrossPrice: function (row) {\n\t\t\treturn $('.grossPrice', row).getNumberFromValue();\n\t\t},\n\t\tgetPurchase: function (row) {\n\t\t\tlet qty = this.getQuantityValue(row);\n\t\t\tlet element = $('.purchase', row);\n\t\t\tlet purchase = 0;\n\t\t\tif (element.length > 0) {\n\t\t\t\tpurchase = App.Fields.Double.formatToDb(element.val());\n\t\t\t}\n\t\t\treturn purchase * qty;\n\t\t},\n\t\tgetSummaryGrossPrice: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet price = 0;\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find(thisInstance.rowClass)\n\t\t\t\t.each(function () {\n\t\t\t\t\tprice += thisInstance.getGrossPrice($(this));\n\t\t\t\t});\n\t\t\treturn App.Fields.Double.formatToDb(price);\n\t\t},\n\t\t/**\n\t\t * Set currency\n\t\t * @param {int} val\n\t\t */\n\t\tsetCurrency(val) {\n\t\t\tthis.getInventoryHeadContainer().find('.js-currency').val(val).trigger('change');\n\t\t},\n\t\t/**\n\t\t * Set currency param\n\t\t * @param {string} val json string\n\t\t */\n\t\tsetCurrencyParam(val) {\n\t\t\tthis.getInventoryHeadContainer().find('.js-currencyparam').val(val);\n\t\t},\n\t\t/**\n\t\t * Set discount mode\n\t\t * @param {int} val\n\t\t */\n\t\tsetDiscountMode(val) {\n\t\t\tthis.getInventoryHeadContainer().find('.js-discountmode').val(val).trigger('change');\n\t\t},\n\t\t/**\n\t\t * Set tax mode\n\t\t * @param {int} val\n\t\t */\n\t\tsetTaxMode(val) {\n\t\t\tthis.getInventoryHeadContainer().find('.js-taxmode').val(val).trigger('change');\n\t\t},\n\t\t/**\n\t\t * Set inventory id\n\t\t * @param {jQuery} row\n\t\t * @param {int} val\n\t\t * @param {string} display\n\t\t */\n\t\tsetName(row, val, display) {\n\t\t\trow.find('.js-name').val(val).trigger('change');\n\t\t\trow.find('.js-name_display').val(display).attr('readonly', 'true').trigger('change');\n\t\t},\n\t\t/**\n\t\t * Set inventory row quantity\n\t\t * @param {jQuery} row\n\t\t * @param {int} val\n\t\t */\n\t\tsetQuantity(row, val) {\n\t\t\trow.find('.qty').val(val).trigger('change');\n\t\t},\n\t\t/**\n\t\t * Set unit original (db) value\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t * @param {string} display\n\t\t */\n\t\tsetUnit(row, val, display) {\n\t\t\trow.find('.unit').val(val).trigger('change');\n\t\t\trow.find('.unitText').text(display).trigger('change');\n\t\t},\n\t\t/**\n\t\t * Set subUnit original (db) value\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t * @param {string} display\n\t\t */\n\t\tsetSubUnit(row, val, display) {\n\t\t\trow.find('.subunit').val(val);\n\t\t\trow.find('.subunitText').val(display);\n\t\t},\n\t\t/**\n\t\t * Set inventory row comment\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetComment(row, val) {\n\t\t\trow\n\t\t\t\t.parent()\n\t\t\t\t.find('[numrowex=' + row.attr('numrow') + '] .comment')\n\t\t\t\t.val(val);\n\t\t},\n\t\t/**\n\t\t * Set inventory row unit price\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetUnitPrice: function (row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\trow.find('.unitPrice').val(val).attr('title', val);\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Set inventory row purchase\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetPurchase: function (row, val) {\n\t\t\trow.find('.purchase').val(App.Fields.Double.formatToDisplay(val));\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Set inventory row net price\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetNetPrice: function (row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\t$('.netPriceText', row).text(val);\n\t\t\t$('.netPrice', row).val(val);\n\t\t},\n\t\t/**\n\t\t * Set inventory row gross price\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetGrossPrice: function (row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\t$('.grossPriceText', row).text(val);\n\t\t\t$('.grossPrice', row).val(val);\n\t\t},\n\t\t/**\n\t\t * Set inventory row total price\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetTotalPrice: function (row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\t$('.totalPriceText', row).text(val);\n\t\t\t$('.totalPrice', row).val(val);\n\t\t},\n\t\t/**\n\t\t * Set inventory row margin\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetMargin: function (row, val) {\n\t\t\t$('.margin', row).val(App.Fields.Double.formatToDisplay(val));\n\t\t},\n\t\t/**\n\t\t * Set inventory row margin percent\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetMarginP: function (row, val) {\n\t\t\t$('.marginp', row).val(App.Fields.Double.formatToDisplay(val));\n\t\t},\n\t\t/**\n\t\t * Set inventory row discount\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetDiscount: function (row, val) {\n\t\t\t$('.discount', row).val(App.Fields.Double.formatToDisplay(val));\n\t\t},\n\t\t/**\n\t\t * Set inventory row discount param\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetDiscountParam: function (row, val) {\n\t\t\t$('.discountParam', row).val(JSON.stringify(val));\n\t\t},\n\t\t/**\n\t\t * Set inventory row tax\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetTax: function (row, val) {\n\t\t\t$('.tax', row).val(App.Fields.Double.formatToDisplay(val));\n\t\t},\n\t\t/**\n\t\t * Set inventory row tax percent\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetTaxPercent: function (row, val) {\n\t\t\t$('.js-tax-percent', row).val(App.Fields.Double.formatToDisplay(val));\n\t\t},\n\t\t/**\n\t\t * Set inventory row tax param\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetTaxParam: function (row, val) {\n\t\t\t$('.taxParam', row).val(JSON.stringify(val));\n\t\t},\n\t\tquantityChangeActions: function (row) {\n\t\t\tthis.rowCalculations(row);\n\t\t\tthis.summaryCalculations();\n\t\t},\n\t\trowCalculations: function (row) {\n\t\t\tthis.calculateTotalPrice(row);\n\t\t\tthis.calculateDiscounts(row);\n\t\t\tthis.calculateNetPrice(row);\n\t\t\tthis.calculateTaxes(row);\n\t\t\tthis.calculateGrossPrice(row);\n\t\t\tthis.calculateMargin(row);\n\t\t\tapp.event.trigger('Inventory.RowCalculations', this, row);\n\t\t},\n\t\trowsCalculations: function () {\n\t\t\tconst self = this;\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find(self.rowClass)\n\t\t\t\t.each(function () {\n\t\t\t\t\tlet row = $(this);\n\t\t\t\t\tself.syncHeaderData(row);\n\t\t\t\t\tself.quantityChangeActions(row);\n\t\t\t\t});\n\t\t\tself.calculateItemNumbers();\n\t\t},\n\t\tcalculateDiscounts: function (row) {\n\t\t\tthis.setDiscount(row, this.getDiscount(row));\n\t\t},\n\t\tcalculateTaxes: function (row) {\n\t\t\tthis.setTax(row, this.getTax(row));\n\t\t\tthis.setTaxPercent(row, this.getTaxPercent(row));\n\t\t},\n\t\tsummaryCalculations: function () {\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find('tfoot .wisableTd')\n\t\t\t\t.each((_n, e) => {\n\t\t\t\t\tthis.calculateSummary($(e));\n\t\t\t\t});\n\t\t\tthis.calculateDiscountSummary();\n\t\t\tthis.calculateTaxSummary();\n\t\t\tthis.calculateCurrenciesSummary();\n\t\t\tthis.calculateMarginPSummary();\n\t\t\tthis.summaryGroupCalculations();\n\t\t},\n\t\t/**\n\t\t * Get Items\n\t\t * @returns {jQuery} Items\n\t\t */\n\t\tgetItems: function () {\n\t\t\treturn this.getInventoryItemsContainer().find('.inventoryRow');\n\t\t},\n\t\t/**\n\t\t * Get groups\n\t\t * @returns {jQuery} Group rows\n\t\t */\n\t\tgetGroups: function () {\n\t\t\treturn this.getInventoryItemsContainer().find('.inventoryRowGroup');\n\t\t},\n\t\t/**\n\t\t * Get group items\n\t\t * @param {jQuery} groupRow\n\t\t * @returns {jQuery} Items\n\t\t */\n\t\tgetGroupItems: function (groupRow) {\n\t\t\treturn groupRow.nextUntil('tr.inventoryRowGroup').filter('tr.inventoryRow');\n\t\t},\n\t\t/**\n\t\t * Get item group\n\t\t * @param {jQuery} row\n\t\t * @returns {jQuery} group row\n\t\t */\n\t\tgetGroupFromItem: function (row) {\n\t\t\tlet classElement = 'inventoryRowGroup';\n\t\t\twhile (row.is('tr') && !row.hasClass(classElement)) {\n\t\t\t\trow = row.prev();\n\t\t\t}\n\n\t\t\treturn row.hasClass(classElement) ? row : null;\n\t\t},\n\t\tsummaryGroupCalculations: function () {\n\t\t\tthis.getGroups().each((_n, e) => {\n\t\t\t\tlet groupRow = $(e);\n\t\t\t\tlet items = this.getGroupItems(groupRow);\n\t\t\t\tgroupRow.find('.js-inv-container-group-summary').each((_n, e) => {\n\t\t\t\t\tthis.calculateSummary($(e), items);\n\t\t\t\t});\n\t\t\t\tthis.calculateMarginPSummary(groupRow);\n\t\t\t});\n\t\t},\n\t\tcalculateSummary: function (element, rows) {\n\t\t\tlet thisInstance = this;\n\t\t\tlet sum = 0;\n\t\t\tlet fieldName = typeof element === 'string' ? element : element.data('sumfield');\n\t\t\tif (!rows) {\n\t\t\t\trows = this.getInventoryItemsContainer().find(thisInstance.rowClass);\n\t\t\t}\n\t\t\trows.each(function () {\n\t\t\t\tlet e = $(this).find('.' + fieldName);\n\t\t\t\tif (e.length > 0) {\n\t\t\t\t\tsum += App.Fields.Double.formatToDb(e.val());\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (typeof element === 'object') {\n\t\t\t\telement.get(0).innerText = App.Fields.Double.formatToDisplay(sum);\n\t\t\t}\n\n\t\t\treturn sum;\n\t\t},\n\t\tcalculateMarginPSummary: function (sumRow) {\n\t\t\tif (!sumRow) {\n\t\t\t\tsumRow = this.getInventoryItemsContainer().find('tfoot');\n\t\t\t}\n\t\t\tlet totalPriceField =\n\t\t\t\t\tsumRow.find('[data-sumfield=\"netPrice\"]').length > 0\n\t\t\t\t\t\t? sumRow.find('[data-sumfield=\"netPrice\"]')\n\t\t\t\t\t\t: sumRow.find('[data-sumfield=\"totalPrice\"]'),\n\t\t\t\tsumPrice = totalPriceField.getNumberFromText(),\n\t\t\t\tpurchase = 0,\n\t\t\t\tmarginp = 0;\n\n\t\t\tlet rows = sumRow.hasClass('inventoryRowGroup')\n\t\t\t\t? this.getGroupItems(sumRow)\n\t\t\t\t: this.getInventoryItemsContainer().find(this.rowClass);\n\n\t\t\trows.each(function () {\n\t\t\t\tlet qty = $(this).find('.qty').getNumberFromValue(),\n\t\t\t\t\tpurchasePrice = $(this).find('.purchase').getNumberFromValue();\n\t\t\t\tif (qty > 0 && purchasePrice > 0) {\n\t\t\t\t\tpurchase += qty * purchasePrice;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet subtraction = sumPrice - purchase;\n\t\t\tif (purchase !== 0 && sumPrice !== 0) {\n\t\t\t\tmarginp = (subtraction * 100) / purchase;\n\t\t\t}\n\t\t\tsumRow.find('[data-sumfield=\"marginP\"]').text(App.Fields.Double.formatToDisplay(marginp) + '%');\n\t\t},\n\t\tcalculateDiscountSummary: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet discount = thisInstance.getAllDiscount();\n\t\t\tlet container = thisInstance.getInventorySummaryDiscountContainer();\n\t\t\tcontainer.find('input').val(App.Fields.Double.formatToDisplay(discount));\n\t\t},\n\t\tgetAllDiscount: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet discount = 0;\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find(thisInstance.rowClass)\n\t\t\t\t.each(function (index) {\n\t\t\t\t\tlet row = $(this);\n\t\t\t\t\tdiscount += thisInstance.getDiscount(row);\n\t\t\t\t});\n\t\t\treturn discount;\n\t\t},\n\t\tcalculateCurrenciesSummary: function () {\n\t\t\tlet container = this.getInventorySummaryCurrenciesContainer(),\n\t\t\t\tselected = $('.js-currency option:selected', this.getInventoryHeadContainer()),\n\t\t\t\tbase = $('.js-currency option[data-base-currency=\"1\"]', this.getInventoryHeadContainer()),\n\t\t\t\tconversionRate = selected.data('conversionRate'),\n\t\t\t\tbaseConversionRate = base.data('conversionRate');\n\t\t\tif (conversionRate == baseConversionRate) {\n\t\t\t\tcontainer.addClass('d-none');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconversionRate = parseFloat(baseConversionRate) / parseFloat(conversionRate);\n\t\t\tcontainer.removeClass('d-none');\n\t\t\tlet taxes = this.getAllTaxes();\n\t\t\tlet sum = 0;\n\t\t\tcontainer.find('.js-panel__body').html('');\n\t\t\t$.each(taxes, function (index, value) {\n\t\t\t\tif (value != undefined) {\n\t\t\t\t\tvalue = value * conversionRate;\n\t\t\t\t\tlet row = container.find('.d-none .form-group').clone();\n\t\t\t\t\trow.find('.percent').text(index + '%');\n\t\t\t\t\trow.find('input').val(App.Fields.Double.formatToDisplay(value));\n\t\t\t\t\trow.appendTo(container.find('.js-panel__body'));\n\t\t\t\t\tsum += value;\n\t\t\t\t}\n\t\t\t});\n\t\t\tcontainer.find('.js-panel__footer input').val(App.Fields.Double.formatToDisplay(sum));\n\t\t},\n\t\tcalculateTaxSummary: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet taxes = thisInstance.getAllTaxes();\n\t\t\tlet container = thisInstance.getInventorySummaryTaxesContainer();\n\t\t\tcontainer.find('.js-panel__body').html('');\n\t\t\tlet sum = 0;\n\t\t\tfor (let index in taxes) {\n\t\t\t\tlet row = container.find('.d-none .form-group').clone();\n\t\t\t\trow.find('.percent').text(App.Fields.Double.formatToDisplay(index) + '%');\n\t\t\t\trow.find('input').val(App.Fields.Double.formatToDisplay(taxes[index]));\n\t\t\t\trow.appendTo(container.find('.js-panel__body'));\n\t\t\t\tsum += taxes[index];\n\t\t\t}\n\t\t\tcontainer.find('.js-panel__footer input').val(App.Fields.Double.formatToDisplay(sum));\n\t\t},\n\t\tgetAllTaxes: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet tax = [];\n\t\t\tlet typeSummary = $('.aggregationTypeTax').val();\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find(thisInstance.rowClass)\n\t\t\t\t.each(function () {\n\t\t\t\t\tlet row = $(this);\n\t\t\t\t\tlet netPrice = thisInstance.getNetPrice(row);\n\t\t\t\t\tlet params = row.find('.taxParam').val();\n\t\t\t\t\tif (params != '' && params != '[]' && params != undefined) {\n\t\t\t\t\t\tlet param = JSON.parse(params);\n\t\t\t\t\t\tif (typeof param.aggregationType == 'string') {\n\t\t\t\t\t\t\tparam.aggregationType = [param.aggregationType];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (param.aggregationType)\n\t\t\t\t\t\t\t$.each(param.aggregationType, function (_, name) {\n\t\t\t\t\t\t\t\tname = name + 'Tax';\n\t\t\t\t\t\t\t\tif (param[name] == undefined) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlet percent = parseFloat(param[name]);\n\t\t\t\t\t\t\t\tlet old = 0;\n\t\t\t\t\t\t\t\tif (tax[percent] != undefined) {\n\t\t\t\t\t\t\t\t\told = parseFloat(tax[percent]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlet taxRate = netPrice * (percent / 100);\n\t\t\t\t\t\t\t\ttax[percent] = old + taxRate;\n\t\t\t\t\t\t\t\tif (typeSummary == '2') {\n\t\t\t\t\t\t\t\t\tnetPrice += taxRate;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\treturn tax;\n\t\t},\n\t\tcalculateNetPrice: function (row) {\n\t\t\tthis.setNetPrice(row, this.getNetPrice(row));\n\t\t},\n\t\tcalculateGrossPrice: function (row) {\n\t\t\tlet netPrice = this.getNetPrice(row);\n\t\t\tif (this.isIndividualTaxMode(row) || this.isGroupTaxMode(row)) {\n\t\t\t\tnetPrice += this.getTax(row);\n\t\t\t}\n\t\t\tthis.setGrossPrice(row, netPrice);\n\t\t},\n\t\tcalculateTotalPrice: function (row) {\n\t\t\tthis.setTotalPrice(row, this.getTotalPrice(row));\n\t\t},\n\t\tcalculateMargin: function (row) {\n\t\t\tlet netPrice;\n\t\t\tif ($('.netPrice', row).length) {\n\t\t\t\tnetPrice = this.getNetPrice(row);\n\t\t\t} else {\n\t\t\t\tnetPrice = this.getTotalPrice(row) - this.getDiscount(row);\n\t\t\t}\n\t\t\tlet purchase = this.getPurchase(row);\n\t\t\tlet margin = netPrice - purchase;\n\t\t\tthis.setMargin(row, margin);\n\t\t\tlet marginp = '0';\n\t\t\tif (purchase !== 0) {\n\t\t\t\tmarginp = (margin / purchase) * 100;\n\t\t\t}\n\t\t\tthis.setMarginP(row, marginp);\n\t\t},\n\t\tAGGREGATION_CANNOT_BE_COMBINED: 0,\n\t\tAGGREGATION_IN_TOTAL: 1,\n\t\tAGGREGATION_CASCADE: 2,\n\t\tcalculateDiscount: function (_row, modal) {\n\t\t\tconst netPriceBeforeDiscount = App.Fields.Double.formatToDb(modal.find('.valueTotalPrice').text()),\n\t\t\t\taggregationType = modal.find('.aggregationType').val(),\n\t\t\t\tisMarkup = modal.find('.js-inv--discount-type.markup:checked').length === 1;\n\t\t\tlet valuePrices = netPriceBeforeDiscount;\n\n\t\t\tlet getValue = function (type, netPrice, isMarkup) {\n\t\t\t\tlet value = 0;\n\t\t\t\tlet element = modal.find(`.js-active .${type}`);\n\t\t\t\tlet customCheckTrue = true;\n\t\t\t\tif (type === 'groupValue' && modal.find('.js-active .groupCheckbox').prop('checked') !== true) {\n\t\t\t\t\tcustomCheckTrue = false;\n\t\t\t\t}\n\t\t\t\tif (element.length > 0 && customCheckTrue) {\n\t\t\t\t\tvalue = App.Fields.Double.formatToDb(element.val());\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\ttype === 'individualDiscountValue' &&\n\t\t\t\t\tmodal.find('.js-active .individualDiscountType:checked').val() == 'percentage'\n\t\t\t\t) {\n\t\t\t\t\tvalue = netPrice * (value / 100);\n\t\t\t\t}\n\n\t\t\t\treturn value && isMarkup ? -value : value;\n\t\t\t};\n\n\t\t\tlet globalDiscount, accountDiscount, individualDiscount, additionalDiscount;\n\t\t\tif (aggregationType == this.AGGREGATION_CANNOT_BE_COMBINED || aggregationType == this.AGGREGATION_IN_TOTAL) {\n\t\t\t\tglobalDiscount = getValue('globalDiscount', netPriceBeforeDiscount, isMarkup); // percentage\n\t\t\t\taccountDiscount = getValue('groupValue', netPriceBeforeDiscount, isMarkup); // percentage\n\t\t\t\tindividualDiscount = getValue('individualDiscountValue', netPriceBeforeDiscount, isMarkup); // amount\n\t\t\t\tadditionalDiscount = getValue('additionalDiscountValue', netPriceBeforeDiscount, isMarkup); // percentage\n\n\t\t\t\tvaluePrices -= netPriceBeforeDiscount * (globalDiscount / 100);\n\t\t\t\tvaluePrices -= netPriceBeforeDiscount * (additionalDiscount / 100);\n\t\t\t\tvaluePrices -= individualDiscount;\n\t\t\t\tvaluePrices -= netPriceBeforeDiscount * (accountDiscount / 100);\n\t\t\t} else if (aggregationType == this.AGGREGATION_CASCADE) {\n\t\t\t\tglobalDiscount = getValue('globalDiscount', valuePrices, isMarkup); // percentage\n\t\t\t\tvaluePrices = valuePrices * ((100 - globalDiscount) / 100);\n\t\t\t\taccountDiscount = getValue('groupValue', valuePrices, isMarkup); // percentage\n\t\t\t\tvaluePrices = valuePrices * ((100 - accountDiscount) / 100);\n\t\t\t\tindividualDiscount = getValue('individualDiscountValue', valuePrices, isMarkup); // amount\n\t\t\t\tvaluePrices = valuePrices - individualDiscount;\n\t\t\t\tadditionalDiscount = getValue('additionalDiscountValue', valuePrices, isMarkup); // percentage\n\t\t\t\tvaluePrices = valuePrices * ((100 - additionalDiscount) / 100);\n\t\t\t}\n\n\t\t\tlet discountValue = netPriceBeforeDiscount - valuePrices;\n\t\t\tmodal.find('.valuePrices').text(App.Fields.Double.formatToDisplay(valuePrices));\n\t\t\tmodal.find('.valueDiscount').text(App.Fields.Double.formatToDisplay(isMarkup ? -discountValue : discountValue));\n\t\t},\n\t\tcalculateTax: function (_row, modal) {\n\t\t\tlet netPriceWithoutTax = App.Fields.Double.formatToDb(modal.find('.valueNetPrice').text()),\n\t\t\t\tvaluePrices = netPriceWithoutTax,\n\t\t\t\tglobalTax = 0,\n\t\t\t\tgroupTax = 0,\n\t\t\t\tregionalTax = 0,\n\t\t\t\tindividualTax = 0;\n\n\t\t\tlet taxType = modal.find('.taxsType').val();\n\t\t\tif (taxType == '0' || taxType == '1') {\n\t\t\t\tif (modal.find('.js-active .globalTax').length > 0) {\n\t\t\t\t\tglobalTax = App.Fields.Double.formatToDb(modal.find('.js-active .globalTax').val());\n\t\t\t\t}\n\t\t\t\tif (modal.find('.js-active .individualTaxValue').length > 0) {\n\t\t\t\t\tlet value = App.Fields.Double.formatToDb(modal.find('.js-active .individualTaxValue').val());\n\t\t\t\t\tindividualTax = (value / 100) * valuePrices;\n\t\t\t\t}\n\t\t\t\tif (modal.find('.js-active .groupTax').length > 0) {\n\t\t\t\t\tgroupTax = App.Fields.Double.formatToDb(modal.find('.groupTax').val());\n\t\t\t\t\tgroupTax = netPriceWithoutTax * (groupTax / 100);\n\t\t\t\t}\n\t\t\t\tif (modal.find('.js-active .regionalTax').length > 0) {\n\t\t\t\t\tregionalTax = App.Fields.Double.formatToDb(modal.find('.regionalTax').val());\n\t\t\t\t\tregionalTax = netPriceWithoutTax * (regionalTax / 100);\n\t\t\t\t}\n\n\t\t\t\tvaluePrices = valuePrices * ((100 + globalTax) / 100);\n\t\t\t\tvaluePrices = valuePrices + individualTax;\n\t\t\t\tvaluePrices = valuePrices + groupTax;\n\t\t\t\tvaluePrices = valuePrices + regionalTax;\n\t\t\t} else if (taxType == '2') {\n\t\t\t\tmodal.find('.js-active').each(function () {\n\t\t\t\t\tlet panel = $(this);\n\t\t\t\t\tif (panel.find('.globalTax').length > 0) {\n\t\t\t\t\t\tvaluePrices = valuePrices * ((100 + App.Fields.Double.formatToDb(panel.find('.globalTax').val())) / 100);\n\t\t\t\t\t} else if (panel.find('.groupTax').length > 0) {\n\t\t\t\t\t\tvaluePrices = valuePrices * ((100 + App.Fields.Double.formatToDb(panel.find('.groupTax').val())) / 100);\n\t\t\t\t\t} else if (panel.find('.regionalTax').length > 0) {\n\t\t\t\t\t\tvaluePrices = valuePrices * ((100 + App.Fields.Double.formatToDb(panel.find('.regionalTax').val())) / 100);\n\t\t\t\t\t} else if (panel.find('.individualTaxValue').length > 0) {\n\t\t\t\t\t\tvaluePrices =\n\t\t\t\t\t\t\t((App.Fields.Double.formatToDb(panel.find('.individualTaxValue').val()) + 100) / 100) * valuePrices;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (netPriceWithoutTax) {\n\t\t\t\tlet taxValue = ((valuePrices - netPriceWithoutTax) / netPriceWithoutTax) * 100;\n\t\t\t\tmodal.find('.js-tax-value').text(App.Fields.Double.formatToDisplay(taxValue));\n\t\t\t}\n\t\t\tmodal.find('.valuePrices').text(App.Fields.Double.formatToDisplay(valuePrices));\n\t\t\tmodal.find('.valueTax').text(App.Fields.Double.formatToDisplay(valuePrices - netPriceWithoutTax));\n\t\t},\n\t\tupdateRowSequence: function () {\n\t\t\tlet items = this.getInventoryItemsContainer();\n\t\t\titems.find(this.rowClass).each(function (index) {\n\t\t\t\t$(this)\n\t\t\t\t\t.find('.sequence')\n\t\t\t\t\t.val(index + 1);\n\t\t\t});\n\t\t},\n\t\tregisterInventorySaveData: function () {\n\t\t\tapp.event.on('EditView.preValidation', (_e, _view) => {\n\t\t\t\tthis.showAllItems();\n\t\t\t});\n\t\t\tthis.form.on(Vtiger_Edit_Js.recordPreSave, () => {\n\t\t\t\tthis.syncHeaderData();\n\t\t\t\tif (!this.checkLimits(this.form)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tsyncHeaderData(container) {\n\t\t\tthis.renumberHeaderItems();\n\t\t\tlet header = this.getInventoryHeadContainer();\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = this.getContainer();\n\t\t\t}\n\t\t\tcontainer.find('.js-sync').each((_, e) => {\n\t\t\t\tlet element = $(e);\n\t\t\t\tlet value;\n\t\t\t\tlet name = element.data('syncId');\n\t\t\t\tlet classElement = '.js-' + element.data('syncId');\n\t\t\t\tif (name === 'grouplabel' || name === 'groupid') {\n\t\t\t\t\tlet row = element.closest(this.rowClass);\n\t\t\t\t\twhile (row.is('tr') && row.prev().find(classElement).length < 1) {\n\t\t\t\t\t\trow = row.prev();\n\t\t\t\t\t}\n\t\t\t\t\tvalue = row.prev().find(classElement);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = header.find(classElement);\n\t\t\t\t}\n\t\t\t\telement.val(value.length ? value.val() : element.data('default'));\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Renumber header items\n\t\t */\n\t\trenumberHeaderItems() {\n\t\t\tthis.getContainer()\n\t\t\t\t.find('.js-inv-container-content .js-groupid')\n\t\t\t\t.each((n, e) => {\n\t\t\t\t\te.value = n + 1;\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will be used to handle price book popup\n\t\t * @params :  element - popup image element\n\t\t */\n\t\tpricebooksModalHandler: function (element) {\n\t\t\tlet lineItemRow = element.closest(this.rowClass);\n\t\t\tlet rowName = lineItemRow.find('.rowName');\n\t\t\tlet currencyId = this.getCurrency() || CONFIG.defaultCurrencyId;\n\t\t\tapp.showRecordsList(\n\t\t\t\t{\n\t\t\t\t\tmodule: 'PriceBooks',\n\t\t\t\t\tsrc_module: $('[name=\"popupReferenceModule\"]', rowName).val(),\n\t\t\t\t\tsrc_record: $('.sourceField', rowName).val(),\n\t\t\t\t\tsrc_field: $('[name=\"popupReferenceModule\"]', rowName).data('field'),\n\t\t\t\t\tsearch_params: JSON.stringify([\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t['currency_id', 'e', currencyId],\n\t\t\t\t\t\t\t['active', 'e', 1]\n\t\t\t\t\t\t]\n\t\t\t\t\t]),\n\t\t\t\t\tlockedFields: ['currency_id', 'active'],\n\t\t\t\t\tcvEnabled: false,\n\t\t\t\t\tcurrency_id: currencyId,\n\t\t\t\t\tadditionalData: { currency_id: currencyId }\n\t\t\t\t},\n\t\t\t\t(_modal, instance) => {\n\t\t\t\t\tinstance.setSelectEvent((responseData) => {\n\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\tmodule: 'PriceBooks',\n\t\t\t\t\t\t\taction: 'ProductListPrice',\n\t\t\t\t\t\t\trecord: responseData.id,\n\t\t\t\t\t\t\tsrc_record: $('.sourceField', rowName).val()\n\t\t\t\t\t\t}).done((data) => {\n\t\t\t\t\t\t\tif (data.result) {\n\t\t\t\t\t\t\t\tthis.setUnitPrice(lineItemRow, data.result);\n\t\t\t\t\t\t\t\tthis.quantityChangeActions(lineItemRow);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tapp.errorLog('Incorrect data', responseData);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\tsubProductsCashe: [],\n\t\tloadSubProducts: function (parentRow, indicator) {\n\t\t\tlet thisInstance = this;\n\t\t\tlet progressInstace;\n\t\t\tlet recordId = $('input.sourceField.js-name', parentRow).val();\n\t\t\tlet recordModule = parentRow.find('.rowName input[name=\"popupReferenceModule\"]').val();\n\t\t\tthisInstance.removeSubProducts(parentRow);\n\t\t\tif (recordId == '0' || recordId == '' || $.inArray(recordModule, ['Products', 'Services']) < 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (thisInstance.subProductsCashe[recordId]) {\n\t\t\t\tthisInstance.addSubProducts(parentRow, thisInstance.subProductsCashe[recordId]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tlet subProrductParams = {\n\t\t\t\tmodule: 'Products',\n\t\t\t\taction: 'SubProducts',\n\t\t\t\trecord: recordId\n\t\t\t};\n\t\t\tif (indicator) {\n\t\t\t\tprogressInstace = $.progressIndicator();\n\t\t\t}\n\t\t\tAppConnector.request(subProrductParams)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tlet responseData = data.result;\n\t\t\t\t\tthisInstance.subProductsCashe[recordId] = responseData;\n\t\t\t\t\tthisInstance.addSubProducts(parentRow, responseData);\n\t\t\t\t\tif (progressInstace) {\n\t\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function () {\n\t\t\t\t\tif (progressInstace) {\n\t\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\tremoveSubProducts: function (parentRow) {\n\t\t\tlet subProductsContainer = $('.subProductsContainer ul', parentRow);\n\t\t\tsubProductsContainer.find('li').remove();\n\t\t},\n\t\taddSubProducts: function (parentRow, responseData) {\n\t\t\tlet subProductsContainer = $('.subProductsContainer ul', parentRow);\n\t\t\tfor (let id in responseData) {\n\t\t\t\tsubProductsContainer.append($('<li>').text(responseData[id]));\n\t\t\t}\n\t\t},\n\t\tmapResultsToFields: function (referenceModule, parentRow, responseData) {\n\t\t\tlet unit,\n\t\t\t\ttaxParam = [];\n\t\t\tlet thisInstance = this;\n\t\t\tlet isGroupTax = thisInstance.isGroupTaxMode();\n\t\t\tfor (let id in responseData) {\n\t\t\t\tlet recordData = responseData[id];\n\t\t\t\tlet description = recordData.description;\n\t\t\t\tlet unitPriceValues = recordData.unitPriceValues;\n\t\t\t\tlet unitPriceValuesJson = JSON.stringify(unitPriceValues);\n\t\t\t\t// Load taxes detail\n\t\t\t\tif (isGroupTax) {\n\t\t\t\t\tlet parameters = parentRow.closest('.inventoryItems').data('taxParam');\n\t\t\t\t\tif (parameters) {\n\t\t\t\t\t\ttaxParam = JSON.parse(parameters);\n\t\t\t\t\t}\n\t\t\t\t} else if (recordData['taxes']) {\n\t\t\t\t\ttaxParam = { aggregationType: recordData.taxes.type };\n\t\t\t\t\ttaxParam[recordData.taxes.type + 'Tax'] = recordData.taxes.value;\n\t\t\t\t}\n\t\t\t\tif (recordData['taxes']) {\n\t\t\t\t\tparentRow.find('.js-tax').attr('data-default-tax', recordData.taxes.value);\n\t\t\t\t}\n\t\t\t\tthisInstance.setPurchase(parentRow, recordData.purchase);\n\t\t\t\tthisInstance.setTaxParam(parentRow, taxParam);\n\t\t\t\tthisInstance.setTax(parentRow, 0);\n\t\t\t\tthisInstance.setTaxPercent(parentRow, 0);\n\n\t\t\t\tfor (let field in recordData['autoFields']) {\n\t\t\t\t\tlet inputField = parentRow.find(`input.${field},select.${field}`);\n\t\t\t\t\tif (inputField.attr('type') === 'checkbox') {\n\t\t\t\t\t\tinputField.prop('checked', recordData['autoFields'][field]);\n\t\t\t\t\t} else if (inputField.is('select')) {\n\t\t\t\t\t\tinputField.val(recordData['autoFields'][field]).trigger('change');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tinputField.val(recordData['autoFields'][field]);\n\t\t\t\t\t}\n\t\t\t\t\tif (recordData['autoFields'][field + 'Text']) {\n\t\t\t\t\t\tparentRow.find('.' + field + 'Text').text(recordData['autoFields'][field + 'Text']);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (recordData.price !== undefined) {\n\t\t\t\t\tthisInstance.setUnitPrice(parentRow, recordData.price);\n\t\t\t\t}\n\t\t\t\tif (unitPriceValuesJson !== undefined) {\n\t\t\t\t\t$('input.unitPrice', parentRow).attr('list-info', unitPriceValuesJson);\n\t\t\t\t}\n\t\t\t\tlet commentElement = $('textarea.js-inventory-item-comment', parentRow.next());\n\t\t\t\tlet editorInstance = CKEDITOR.instances[commentElement.attr('id')];\n\t\t\t\tif (editorInstance) {\n\t\t\t\t\teditorInstance.setData(description);\n\t\t\t\t} else {\n\t\t\t\t\tcommentElement.val(description);\n\t\t\t\t}\n\t\t\t\tif (typeof recordData['autoFields']['unit'] !== 'undefined') {\n\t\t\t\t\tunit = recordData['autoFields']['unit'];\n\t\t\t\t}\n\t\t\t\tapp.event.trigger('Inventory.SelectionItem', thisInstance, parentRow, recordData, referenceModule);\n\t\t\t\tthis.triggerQtyParam(unit, recordData.qtyPerUnit, parentRow);\n\t\t\t}\n\t\t\tif (referenceModule === 'Products') {\n\t\t\t\tthisInstance.loadSubProducts(parentRow, true);\n\t\t\t}\n\t\t\tthisInstance.quantityChangeActions(parentRow);\n\t\t},\n\t\t/**\n\t\t * Update qtyparam\n\t\t * @param {null|string} unit\n\t\t * @param int perUnit\n\t\t * @param {jQuery} parentRow\n\t\t */\n\t\ttriggerQtyParam(unit, perUnit, parentRow) {\n\t\t\tlet validationEngine;\n\t\t\tswitch (unit) {\n\t\t\t\tdefault:\n\t\t\t\t\t$('.qtyParamInfo', parentRow).addClass('d-none');\n\t\t\t\t\tvalidationEngine = 'validate[required,funcCall[Vtiger_NumberUserFormat_Validator_Js.invokeValidation]]';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'pack':\n\t\t\t\t\t$('.qtyParamInfo', parentRow).removeClass('d-none').removeClass('active');\n\t\t\t\t\t$('.qtyParamInfo', parentRow).attr('data-content', perUnit);\n\t\t\t\t\tvalidationEngine = 'validate[required,funcCall[Vtiger_WholeNumber_Validator_Js.invokeValidation]]';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'pcs':\n\t\t\t\t\t$('.qtyParamInfo', parentRow).addClass('d-none');\n\t\t\t\t\tvalidationEngine = 'validate[required,funcCall[Vtiger_WholeNumber_Validator_Js.invokeValidation]]';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t$('input.qty', parentRow).attr('data-validation-engine', validationEngine);\n\t\t},\n\t\tsaveDiscountsParameters: function (parentRow, modal) {\n\t\t\tconst typeName = 'aggregationType',\n\t\t\t\tpanels = modal.find('[name=\"' + typeName + '\"]:checked');\n\t\t\tlet info = {};\n\t\t\tinfo[typeName] = [];\n\t\t\tpanels.each(function () {\n\t\t\t\tlet type = $(this).val(),\n\t\t\t\t\tcontainer = $(this).closest('.js-panel');\n\t\t\t\tif (panels.length > 1) {\n\t\t\t\t\tinfo[typeName].push(type);\n\t\t\t\t} else {\n\t\t\t\t\tinfo[typeName] = type;\n\t\t\t\t}\n\t\t\t\tcontainer.find('[name=\"' + type + 'Discount\"]').each(function () {\n\t\t\t\t\tlet param = type + 'Discount';\n\t\t\t\t\tlet element = $(this);\n\t\t\t\t\tswitch (type) {\n\t\t\t\t\t\tcase 'group':\n\t\t\t\t\t\t\tif (element.closest('.input-group').find('.groupCheckbox').prop('checked')) {\n\t\t\t\t\t\t\t\tinfo[param] = App.Fields.Double.formatToDb(element.val());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'individual':\n\t\t\t\t\t\t\tlet name = 'individualDiscountType';\n\t\t\t\t\t\t\tinfo[name] = container.find('[name=\"' + name + '\"]:checked').val();\n\t\t\t\t\t\t\tinfo[param] = App.Fields.Double.formatToDb(element.val());\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'global':\n\t\t\t\t\t\tcase 'additional':\n\t\t\t\t\t\t\tinfo[param] = App.Fields.Double.formatToDb(element.val());\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tif (modal.find('.js-inv--discount-type.markup:checked').length) {\n\t\t\t\tinfo['type'] = 'markup';\n\t\t\t}\n\t\t\tlet discoutMode = modal.find('.discountMode').val();\n\t\t\tif (discoutMode == this.DISCOUNT_MODE_GROUP) {\n\t\t\t\tthis.setDiscountParam(this.getGroupItems(parentRow), info);\n\t\t\t} else if (discoutMode == this.DISCOUNT_MODE_GLOBAL) {\n\t\t\t\tthis.setDiscountParam($('#blackIthemTable'), info);\n\t\t\t}\n\t\t\tthis.setDiscountParam(parentRow, info);\n\t\t},\n\t\tsaveTaxsParameters: function (parentRow, modal) {\n\t\t\tlet info = {};\n\t\t\tconst extend = ['aggregationType', 'groupCheckbox', 'individualTaxType'];\n\t\t\t$.each(this.taxModalFields, function (_, param) {\n\t\t\t\tif ($.inArray(param, extend) >= 0) {\n\t\t\t\t\tif (modal.find('[name=\"' + param + '\"]:checked').length > 1) {\n\t\t\t\t\t\tinfo[param] = [];\n\t\t\t\t\t\tmodal.find('[name=\"' + param + '\"]:checked').each(function () {\n\t\t\t\t\t\t\tinfo[param].push($(this).val());\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tinfo[param] = modal.find('[name=\"' + param + '\"]:checked').val();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tinfo[param] = App.Fields.Double.formatToDb(modal.find('[name=\"' + param + '\"]').val());\n\t\t\t\t}\n\t\t\t});\n\t\t\tparentRow.data('taxParam', JSON.stringify(info));\n\t\t\tthis.setTaxParam(parentRow, info);\n\t\t\tthis.setTaxParam($('#blackIthemTable'), info);\n\t\t},\n\t\tshowExpandedRow: function (row) {\n\t\t\tconst inventoryRowExpanded = this.getInventoryItemsContainer().find('[numrowex=\"' + row.attr('numrow') + '\"]');\n\t\t\tconst element = row.find('.toggleVisibility');\n\t\t\telement.data('status', '1');\n\t\t\telement.removeClass(element.data('off')).addClass(element.data('on'));\n\t\t\tinventoryRowExpanded.removeClass('d-none');\n\t\t\tthis.markCommentBtn(row);\n\t\t},\n\t\thideExpandedRow: function (row) {\n\t\t\tconst inventoryRowExpanded = this.getInventoryItemsContainer().find('[numrowex=\"' + row.attr('numrow') + '\"]');\n\t\t\tconst element = row.find('.toggleVisibility');\n\t\t\telement.data('status', '0');\n\t\t\telement.removeClass(element.data('on')).addClass(element.data('off'));\n\t\t\tinventoryRowExpanded.addClass('d-none');\n\t\t\tthis.markCommentBtn(row);\n\t\t},\n\t\t/**\n\t\t * Mark button for extended fields\n\t\t * @param {jQuery} row\n\t\t */\n\t\tmarkCommentBtn: function (row) {\n\t\t\tlet rowExpanded = this.getInventoryItemsContainer().find('[numrowex=\"' + row.attr('numrow') + '\"]');\n\t\t\tlet value = rowExpanded.find('.js-inventory-item-comment').val();\n\t\t\tconst element = row.find('.js-inv-item-btn-icon');\n\t\t\tlet removeClass = element.data('active');\n\t\t\tlet addClass = element.data('inactive');\n\t\t\tif (value) {\n\t\t\t\tremoveClass = addClass;\n\t\t\t\taddClass = element.data('active');\n\t\t\t}\n\t\t\telement.removeClass(removeClass).addClass(addClass);\n\t\t},\n\t\tinitTaxParameters: function (parentRow, modal) {\n\t\t\tlet parameters;\n\t\t\tif (parentRow.data('taxParam')) {\n\t\t\t\tparameters = parentRow.data('taxParam');\n\t\t\t} else {\n\t\t\t\tparameters = parentRow.find('.taxParam').val();\n\t\t\t}\n\t\t\tif (!parameters) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tparameters = JSON.parse(parameters.toString());\n\t\t\t$.each(this.taxModalFields, function (_, param) {\n\t\t\t\tlet parameter = parameters[param],\n\t\t\t\t\tfield = modal.find('[name=\"' + param + '\"]');\n\n\t\t\t\tif (field.attr('type') === 'checkbox' || field.attr('type') === 'radio') {\n\t\t\t\t\tlet array = parameter,\n\t\t\t\t\t\tvalue;\n\t\t\t\t\tif (!$.isArray(array)) {\n\t\t\t\t\t\tarray = [array];\n\t\t\t\t\t}\n\t\t\t\t\t$.each(array, function (_, arrayValue) {\n\t\t\t\t\t\tvalue = field.filter('[value=\"' + arrayValue + '\"]').prop('checked', true);\n\t\t\t\t\t\tif (param === 'aggregationType') {\n\t\t\t\t\t\t\tvalue.closest('.js-panel').find('.js-panel__body').removeClass('d-none');\n\t\t\t\t\t\t\tvalue.closest('.js-panel').addClass('js-active');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else if (field.prop('tagName') === 'SELECT') {\n\t\t\t\t\tfield\n\t\t\t\t\t\t.find('option[value=\"' + parameter + '\"]')\n\t\t\t\t\t\t.prop('selected', 'selected')\n\t\t\t\t\t\t.change();\n\t\t\t\t} else {\n\t\t\t\t\tlet input = modal.find('[name=\"' + param + '\"]');\n\t\t\t\t\tinput.val(App.Fields.Double.formatToDisplay(parameter));\n\t\t\t\t\tif (param === 'individualTax') {\n\t\t\t\t\t\tinput.formatNumber();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.calculateTax(parentRow, modal);\n\t\t},\n\t\tlimitEnableSave: false,\n\t\tcheckLimits: function () {\n\t\t\tconst account = this.getAccountId(),\n\t\t\t\tlimit = parseInt(app.getMainParams('inventoryLimit'));\n\t\t\tlet response = true;\n\t\t\tif (account == '' || this.limitEnableSave || !limit) {\n\t\t\t\treturn response;\n\t\t\t}\n\t\t\tlet progressInstace = $.progressIndicator();\n\t\t\tAppConnector.request({\n\t\t\t\tasync: false,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\taction: 'Inventory',\n\t\t\t\t\tmode: 'checkLimits',\n\t\t\t\t\trecord: account,\n\t\t\t\t\tcurrency: this.getCurrency(),\n\t\t\t\t\tprice: thisInthisstance.getSummaryGrossPrice()\n\t\t\t\t}\n\t\t\t})\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\tif (data.result.status == false) {\n\t\t\t\t\t\tapp.showModalWindow(data.result.html, function () {});\n\t\t\t\t\t\tresponse = false;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function () {\n\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t});\n\t\t\treturn response;\n\t\t},\n\t\tcurrencyChangeActions: function (select, option) {\n\t\t\tif (option.data('baseCurrency') !== select.val()) {\n\t\t\t\tthis.showCurrencyChangeModal(select, option);\n\t\t\t} else {\n\t\t\t\tthis.currencyConvertValues(select, option);\n\t\t\t\tselect.data('oldValue', select.val());\n\t\t\t}\n\t\t},\n\t\tshowCurrencyChangeModal: function (select, option) {\n\t\t\tlet thisInstance = this;\n\t\t\tif (thisInstance.lockCurrencyChange == true) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthisInstance.lockCurrencyChange = true;\n\t\t\tlet block = select.closest('th');\n\t\t\tlet modal = block.find('.modelContainer').clone();\n\t\t\tapp.showModalWindow(modal, function (data) {\n\t\t\t\tlet modal = $(data);\n\t\t\t\tlet currencyParam = JSON.parse(block.find('.js-currencyparam').val());\n\n\t\t\t\tif (currencyParam != false) {\n\t\t\t\t\tif (typeof currencyParam[option.val()] === 'undefined') {\n\t\t\t\t\t\tlet defaultCurrencyParams = {\n\t\t\t\t\t\t\tvalue: 1,\n\t\t\t\t\t\t\tdate: ''\n\t\t\t\t\t\t};\n\t\t\t\t\t\tcurrencyParam[option.val()] = defaultCurrencyParams;\n\t\t\t\t\t}\n\t\t\t\t\tmodal.find('.currencyName').text(option.text());\n\t\t\t\t\tmodal.find('.currencyRate').val(currencyParam[option.val()]['value']);\n\t\t\t\t\tmodal.find('.currencyDate').text(currencyParam[option.val()]['date']);\n\t\t\t\t}\n\t\t\t\tmodal\n\t\t\t\t\t.on('click', 'button[type=\"submit\"]', function () {\n\t\t\t\t\t\tlet rate = modal.find('.currencyRate').val();\n\t\t\t\t\t\tlet value = App.Fields.Double.formatToDb(rate);\n\t\t\t\t\t\tlet conversionRate = 1 / App.Fields.Double.formatToDb(rate);\n\n\t\t\t\t\t\toption.data('conversionRate', conversionRate);\n\t\t\t\t\t\tcurrencyParam[option.val()] = {\n\t\t\t\t\t\t\tdate: option.data('conversionDate'),\n\t\t\t\t\t\t\tvalue: value.toString(),\n\t\t\t\t\t\t\tconversion: conversionRate.toString()\n\t\t\t\t\t\t};\n\t\t\t\t\t\tblock.find('.js-currencyparam').val(JSON.stringify(currencyParam));\n\n\t\t\t\t\t\tthisInstance.currencyConvertValues(select, option);\n\t\t\t\t\t\tselect.data('oldValue', select.val());\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\tthisInstance.lockCurrencyChange = false;\n\t\t\t\t\t})\n\t\t\t\t\t.one('hidden.bs.modal', function () {\n\t\t\t\t\t\tselect.val(select.data('oldValue')).change();\n\t\t\t\t\t\tthisInstance.lockCurrencyChange = false;\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tcurrencyConvertValues: function (select, selected) {\n\t\t\tconst self = this;\n\t\t\tlet previous = select.find('option[value=\"' + select.data('oldValue') + '\"]');\n\t\t\tlet conversionRate = selected.data('conversionRate');\n\t\t\tlet prevConversionRate = previous.data('conversionRate');\n\t\t\tconversionRate = parseFloat(conversionRate) / parseFloat(prevConversionRate);\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find(self.rowClass)\n\t\t\t\t.each(function (_) {\n\t\t\t\t\tlet row = $(this);\n\t\t\t\t\tself.syncHeaderData(row);\n\t\t\t\t\tself.setUnitPrice(row, self.getUnitPriceValue(row) * conversionRate);\n\t\t\t\t\tself.setDiscount(row, self.getDiscount(row) * conversionRate);\n\t\t\t\t\tself.setTax(row, self.getTax(row) * conversionRate);\n\t\t\t\t\tself.setPurchase(row, self.getPurchase(row) * conversionRate);\n\t\t\t\t\tself.quantityChangeActions(row);\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Set up all row data that comes from request\n\t\t * @param {jQuery} row\n\t\t * @param {object} rowData\n\t\t */\n\t\tsetRowData(row, rowData) {\n\t\t\tthis.setName(row, rowData.name, rowData.info.name);\n\t\t\tthis.setQuantity(\n\t\t\t\trow,\n\t\t\t\tApp.Fields.Double.formatToDisplay(rowData.qty, App.Fields.Double.FORMAT_TRUNCATE_TRAILING_ZEROS)\n\t\t\t);\n\t\t\tthis.setUnit(row, rowData.info.autoFields.unit, rowData.info.autoFields.unitText);\n\t\t\tif (typeof rowData.info.autoFields !== 'undefined' && typeof rowData.info.autoFields.subunit !== 'undefined') {\n\t\t\t\tthis.setSubUnit(row, rowData.info.autoFields.subunit, rowData.info.autoFields.subunitText);\n\t\t\t}\n\t\t\tthis.setComment(row, rowData.comment1);\n\t\t\tthis.setUnitPrice(row, rowData.price);\n\t\t\tthis.setNetPrice(row, rowData.net);\n\t\t\tthis.setGrossPrice(row, rowData.gross);\n\t\t\tthis.setTotalPrice(row, rowData.total);\n\t\t\tthis.setDiscountParam(row, rowData.discountparam ? JSON.parse(rowData.discountparam) : []);\n\t\t\tthis.setDiscount(row, rowData.discount);\n\t\t\tthis.setTaxParam(row, rowData.taxparam ? JSON.parse(rowData.taxparam) : []);\n\t\t\tthis.setTax(row, rowData.tax);\n\t\t\tthis.setTaxPercent(row, rowData.tax_percent);\n\t\t},\n\t\t/**\n\t\t * Add new row to inventory list\n\t\t * @param {string} module\n\t\t * @param {string} baseTableId\n\t\t * @param {object} rowData [optional]\n\t\t */\n\t\taddItem(module, baseTableId, rowData = false) {\n\t\t\tconst items = this.getInventoryItemsContainer();\n\t\t\tlet newRow = this.getBasicRow();\n\t\t\tconst sequenceNumber = this.getNextLineItemRowNumber();\n\t\t\tconst replaced = newRow.html().replace(/\\_NUM_/g, sequenceNumber);\n\t\t\tconst moduleLabels = newRow.data('moduleLbls');\n\t\t\tnewRow.html(replaced);\n\t\t\tnewRow = newRow.find('tr.inventoryRow, tr.inventoryRowExpanded').appendTo(items.find('.js-inventory-items-body'));\n\t\t\tnewRow.find('.rowName input[name=\"popupReferenceModule\"]').val(module).data('field', baseTableId);\n\t\t\tnewRow.find('.js-module-icon').removeClass().addClass(`yfm-${module}`);\n\t\t\tnewRow.find('.rowName span.input-group-text').attr('data-content', moduleLabels[module]);\n\t\t\tnewRow.find('.colPicklistField select').each(function (_, select) {\n\t\t\t\tselect = $(select);\n\t\t\t\tselect.find('option').each(function (_, option) {\n\t\t\t\t\toption = $(option);\n\t\t\t\t\tif (option.data('module') !== module) {\n\t\t\t\t\t\toption.remove();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.initItem(newRow);\n\t\t\tVtiger_Edit_Js.getInstance().registerAutoCompleteFields(newRow);\n\t\t\tif (rowData) {\n\t\t\t\tthis.setRowData(newRow, rowData);\n\t\t\t\tthis.quantityChangeActions(newRow);\n\t\t\t} else {\n\t\t\t\tthis.itemChangeEvent(newRow);\n\t\t\t}\n\t\t\treturn newRow;\n\t\t},\n\t\t/**\n\t\t * Item change post event\n\t\t * @param {jQuery} row\n\t\t */\n\t\titemChangeEvent: function (row) {\n\t\t\tif (row.hasClass('inventoryRowGroup')) {\n\t\t\t\tthis.getItems().each((_, e) => {\n\t\t\t\t\tthis.itemChangeEvent($(e));\n\t\t\t\t});\n\t\t\t} else if (this.getDiscountMode() == this.DISCOUNT_MODE_GROUP) {\n\t\t\t\tlet parentRow = this.getGroupFromItem(row);\n\t\t\t\tlet params = parentRow ? parentRow.find('.discountParam').val() : null;\n\t\t\t\tthis.setDiscountParam(row, params ? JSON.parse(params) : []);\n\t\t\t\tthis.rowCalculations(row);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Add header(group) item\n\t\t * @returns\n\t\t */\n\t\taddHeaderItem(data = {}) {\n\t\t\tconst items = this.getInventoryItemsContainer();\n\t\t\tlet newRow = this.getBasicRow();\n\t\t\tif (data['grouplabel']) {\n\t\t\t\tlet value = data['grouplabel'];\n\t\t\t\tlet el = newRow.find('.js-grouplabel');\n\t\t\t\tif (\n\t\t\t\t\tel.is('select') &&\n\t\t\t\t\t![...el.get(0).options]\n\t\t\t\t\t\t.map((o) => o.value)\n\t\t\t\t\t\t.filter((e) => e !== '')\n\t\t\t\t\t\t.includes(value)\n\t\t\t\t) {\n\t\t\t\t\tlet newOption = new Option(value, value, true, true);\n\t\t\t\t\tel.append(newOption);\n\t\t\t\t}\n\t\t\t\tel.val(value);\n\t\t\t}\n\t\t\tnewRow = newRow.find('tr.inventoryRowGroup').appendTo(items.find('.js-inventory-items-body'));\n\t\t\tthis.initItem(newRow);\n\n\t\t\treturn newRow;\n\t\t},\n\t\t/**\n\t\t * Get next block ID\n\t\t * @returns int\n\t\t */\n\t\tgetNextBlockId() {\n\t\t\tlet data = [...this.getContainer().find('.js-groupid')].map((o) => parseInt(o.value));\n\t\t\treturn Math.max(...data) + 1;\n\t\t},\n\n\t\t/**\n\t\t * Register add item button click\n\t\t */\n\t\tregisterAddItem() {\n\t\t\tthis.getContainer()\n\t\t\t\t.find('.js-inv-add-item')\n\t\t\t\t.on('click', (e) => {\n\t\t\t\t\tthis.addItem(e.currentTarget.dataset.module, e.currentTarget.dataset.field, false);\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register add header row\n\t\t */\n\t\tregisterAddHeaderItem() {\n\t\t\tthis.getContainer()\n\t\t\t\t.find('.js-inv-add-group')\n\t\t\t\t.on('click', () => {\n\t\t\t\t\tthis.addHeaderItem();\n\t\t\t\t});\n\t\t},\n\t\tregisterSortableItems: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet items = thisInstance.getContainer();\n\t\t\titems.sortable({\n\t\t\t\thandle: '.dragHandle',\n\t\t\t\titems: thisInstance.rowClass + ',.inventoryRowGroup',\n\t\t\t\trevert: true,\n\t\t\t\ttolerance: 'pointer',\n\t\t\t\tplaceholder: 'ui-state-highlight',\n\t\t\t\thelper: function (_e, ui) {\n\t\t\t\t\tui.children().each(function (_, element) {\n\t\t\t\t\t\telement = $(element);\n\t\t\t\t\t\telement.width(element.width());\n\t\t\t\t\t});\n\t\t\t\t\treturn ui;\n\t\t\t\t},\n\t\t\t\tstart: function (_, ui) {\n\t\t\t\t\titems.find(thisInstance.rowClass).each(function (_, element) {\n\t\t\t\t\t\tlet row = $(element);\n\t\t\t\t\t\tthisInstance.hideExpandedRow(row);\n\t\t\t\t\t});\n\t\t\t\t\tlet num = $(ui.item).attr('numrow');\n\t\t\t\t\titems.find('[numrowex=\"' + num + '\"] .js-inventory-item-comment').each(function () {\n\t\t\t\t\t\tApp.Fields.Text.destroyEditor($(this));\n\t\t\t\t\t});\n\t\t\t\t\tui.item.startPos = ui.item.index();\n\t\t\t\t},\n\t\t\t\tstop: function (_, ui) {\n\t\t\t\t\tlet numrow = $(ui.item).attr('numrow');\n\t\t\t\t\tlet child = items.find('.numRow' + numrow);\n\t\t\t\t\titems.find('[numrow=\"' + numrow + '\"]').after(child);\n\t\t\t\t\tApp.Fields.Text.Editor.register(child);\n\t\t\t\t\tthisInstance.updateRowSequence();\n\t\t\t\t\tthisInstance.itemChangeEvent(ui.item);\n\t\t\t\t\tthisInstance.summaryGroupCalculations();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterShowHideExpanded: function () {\n\t\t\tthis.getInventoryItemsContainer().on('click', '.toggleVisibility', (e) => {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tlet row = this.getClosestRow(element);\n\t\t\t\tif (element.data('status') == 0) {\n\t\t\t\t\tthis.showExpandedRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tthis.hideExpandedRow(row);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Show/Hide group items\n\t\t */\n\t\tregisterShowHideExpandedGroup: function () {\n\t\t\tthis.getInventoryItemsContainer().on('click', '.js-inv-group-collapse-btn', (e) => {\n\t\t\t\tlet btn = $(e.currentTarget);\n\t\t\t\tlet icon = btn.find('.js-toggle-icon');\n\t\t\t\tlet row = btn.closest('tr.inventoryRowGroup');\n\t\t\t\tlet items = this.getGroupItems(row);\n\t\t\t\tif (icon.hasClass(icon.data('active'))) {\n\t\t\t\t\titems.find(`.toggleVisibility.active`).closest('.toggleVisibility').trigger('click');\n\t\t\t\t\titems.addClass('d-none');\n\t\t\t\t\tbtn.removeClass('js-inv-group-collapse-btn__active');\n\t\t\t\t} else {\n\t\t\t\t\titems.removeClass('d-none');\n\t\t\t\t\tbtn.addClass('js-inv-group-collapse-btn__active');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tshowAllItems: function () {\n\t\t\tthis.getGroups().find('.js-inv-group-collapse-btn:not(.js-inv-group-collapse-btn__active)').trigger('click');\n\t\t},\n\t\tregisterPriceBookModal: function (container) {\n\t\t\tcontainer.find('.js-price-book-modal').on('click', (e) => {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tlet response = this.isRecordSelected(element);\n\t\t\t\tif (!response) {\n\t\t\t\t\tthis.pricebooksModalHandler(element);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterRowChangeEvent: function (container) {\n\t\t\tcontainer.on('focusout', '.js-inv-format_number', (e) => {\n\t\t\t\t$(e.currentTarget).formatNumber(e.currentTarget.dataset.format);\n\t\t\t});\n\t\t\tcontainer.on('focusout', '.qty', (e) => {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\telement.formatNumber(App.Fields.Double.FORMAT_TRUNCATE_TRAILING_ZEROS);\n\t\t\t\tthis.quantityChangeActions(this.getClosestRow(element));\n\t\t\t});\n\t\t\tcontainer.on('focusout', '.unitPrice', (e) => {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\telement.formatNumber();\n\t\t\t\tthis.quantityChangeActions(this.getClosestRow(element));\n\t\t\t});\n\t\t\tcontainer.on('focusout', '.purchase', (e) => {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\telement.formatNumber();\n\t\t\t\tthis.quantityChangeActions(this.getClosestRow(element));\n\t\t\t});\n\t\t\tlet headContainer = this.getInventoryHeadContainer();\n\t\t\theadContainer.on('change', '.js-taxmode', () => {\n\t\t\t\tthis.showIndividualTax();\n\t\t\t});\n\t\t\theadContainer.on('change', '.js-discountmode', (e) => {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tlet mode = parseInt(element.val());\n\t\t\t\tthis.getContainer().find(`.js-change-discount:not([data-mode=\"${mode}\"])`).addClass('d-none');\n\t\t\t\tthis.getContainer().find(`.js-change-discount[data-mode=\"${mode}\"]`).removeClass('d-none');\n\t\t\t\tlet items = this.getInventoryItemsContainer().find('.js-inventory-items-body');\n\n\t\t\t\tthis.setDiscount(items, 0);\n\t\t\t\tthis.setDiscountParam(items, []);\n\t\t\t\tthis.rowsCalculations();\n\t\t\t});\n\t\t},\n\t\tregisterSubProducts: function () {\n\t\t\tconst thisInstance = this;\n\t\t\tthisInstance.form.find('.inventoryItems ' + thisInstance.rowClass).each(function () {\n\t\t\t\tthisInstance.loadSubProducts($(this), false);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register clear reference selection\n\t\t */\n\t\tregisterClearReferenceSelection() {\n\t\t\tthis.form.on('click', '.clearReferenceSelection', (e) => {\n\t\t\t\tconst referenceGroup = $(e.currentTarget).closest('div.referenceGroup');\n\t\t\t\tif (referenceGroup.length) {\n\t\t\t\t\treferenceGroup.find('input[id$=\"_display\"]').val('').removeAttr('readonly');\n\t\t\t\t} else {\n\t\t\t\t\tconst row = this.getClosestRow($(e.currentTarget));\n\t\t\t\t\tthis.removeSubProducts(row);\n\t\t\t\t\trow\n\t\t\t\t\t\t.find('.unitPrice,.tax,.discount,.margin,.purchase,.js-tax-percent')\n\t\t\t\t\t\t.val(App.Fields.Double.formatToDisplay(0));\n\t\t\t\t\trow.find('.qty').val(1);\n\t\t\t\t\trow.find('textarea,.valueVal').val('');\n\t\t\t\t\trow.find('.valueText').text('');\n\t\t\t\t\trow.find('.qtyParamInfo').addClass('d-none');\n\t\t\t\t\trow.find('.recordLabel').val('').removeAttr('readonly');\n\t\t\t\t\tif (!this.isGroupTaxMode()) {\n\t\t\t\t\t\tthis.setTaxParam(row, []);\n\t\t\t\t\t}\n\t\t\t\t\tthis.quantityChangeActions(row);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterDeleteLineItemEvent: function (container) {\n\t\t\tcontainer.on('click', '.deleteRow', (e) => {\n\t\t\t\tlet num = this.getClosestRow($(e.currentTarget)).attr('numrow');\n\t\t\t\tthis.deleteLineItem(num);\n\t\t\t});\n\t\t\tcontainer.on('click', '.js-delete-header-item', (e) => {\n\t\t\t\t$(e.currentTarget).closest('tr').remove();\n\t\t\t\tthis.syncHeaderData();\n\t\t\t\tthis.rowsCalculations();\n\t\t\t});\n\t\t},\n\t\tdeleteLineItem: function (num) {\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find('[numrowex=\"' + num + '\"] .js-inventory-item-comment')\n\t\t\t\t.each(function () {\n\t\t\t\t\tApp.Fields.Text.destroyEditor($(this));\n\t\t\t\t});\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find('[numrow=\"' + num + '\"], [numrowex=\"' + num + '\"]')\n\t\t\t\t.remove();\n\t\t\tthis.checkDeleteIcon();\n\t\t\tthis.rowsCalculations();\n\t\t\tif (this.getInventoryItemsContainer().find('.inventoryRow').length === 0) {\n\t\t\t\t$('#inventoryItemsNo').val(0);\n\t\t\t}\n\t\t\tthis.updateRowSequence();\n\t\t},\n\t\tDISCOUNT_MODE_GLOBAL: 0,\n\t\tDISCOUNT_MODE_INDIVIDUAL: 1,\n\t\tDISCOUNT_MODE_GROUP: 2,\n\t\tregisterChangeDiscount: function () {\n\t\t\tthis.form.on('click', '.js-change-discount', (e) => {\n\t\t\t\tlet parentRow;\n\t\t\t\tconst element = $(e.currentTarget);\n\t\t\t\tlet params = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'Inventory',\n\t\t\t\t\tmode: 'showDiscounts',\n\t\t\t\t\tcurrency: this.getCurrency(),\n\t\t\t\t\tdiscountAggregation: this.getDiscountAggregation(),\n\t\t\t\t\trelatedRecord: this.getAccountId(),\n\t\t\t\t\tdiscountMode: e.currentTarget.dataset.mode\n\t\t\t\t};\n\t\t\t\tif (e.currentTarget.dataset.mode == this.DISCOUNT_MODE_GLOBAL) {\n\t\t\t\t\tparentRow = this.getInventoryItemsContainer();\n\t\t\t\t\tif (parentRow.find('tfoot .colTotalPrice:not(.hideTd)').length != 0) {\n\t\t\t\t\t\tparams.totalPrice = App.Fields.Double.formatToDb(parentRow.find('tfoot .colTotalPrice').text());\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparams.totalPrice = this.calculateSummary('totalPrice');\n\t\t\t\t\t}\n\t\t\t\t} else if (e.currentTarget.dataset.mode == this.DISCOUNT_MODE_GROUP) {\n\t\t\t\t\tparentRow = element.closest('tr.inventoryRowGroup');\n\t\t\t\t\tparams.totalPrice = this.calculateSummary('totalPrice', this.getGroupItems(parentRow));\n\t\t\t\t} else {\n\t\t\t\t\tparentRow = element.closest(this.rowClass);\n\t\t\t\t\tparams.totalPrice = this.getTotalPrice(parentRow);\n\t\t\t\t}\n\t\t\t\tparams.discountParam = parentRow.find('.discountParam').val();\n\t\t\t\tlet progressInstace = $.progressIndicator();\n\n\t\t\t\tAppConnector.request(params)\n\t\t\t\t\t.done((data) => {\n\t\t\t\t\t\tapp.showModalWindow(data, (data) => {\n\t\t\t\t\t\t\tthis.registerChangeDiscountModal(data, parentRow, params);\n\t\t\t\t\t\t\tthis.calculateDiscount(parentRow, data);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function () {\n\t\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterChangeDiscountModal: function (modal, parentRow, params) {\n\t\t\tlet thisInstance = this;\n\t\t\tlet form = modal.find('form');\n\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\tmodal.on('change', '.individualDiscountType', function (e) {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tmodal.find('.individualDiscountContainer .input-group-text').text(element.data('symbol'));\n\t\t\t});\n\t\t\tmodal.on('change', '.activeCheckbox[name=\"aggregationType\"]', function (e) {\n\t\t\t\tlet element = $(e.currentTarget);\n\n\t\t\t\tif (element.attr('type') == 'checkbox' && this.checked) {\n\t\t\t\t\telement.closest('.js-panel').find('.js-panel__body').removeClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').addClass('js-active');\n\t\t\t\t} else if (element.attr('type') == 'radio') {\n\t\t\t\t\tmodal.find('.js-panel').removeClass('js-active');\n\t\t\t\t\tmodal.find('.js-panel .js-panel__body').addClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').find('.js-panel__body').removeClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').addClass('js-active');\n\t\t\t\t} else {\n\t\t\t\t\telement.closest('.js-panel').find('.js-panel__body').addClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').removeClass('js-active');\n\t\t\t\t}\n\t\t\t});\n\t\t\tmodal.on(\n\t\t\t\t'change',\n\t\t\t\t'.activeCheckbox, .globalDiscount,.individualDiscountValue,.individualDiscountType,.groupCheckbox,.additionalDiscountValue,.js-inv--discount-type',\n\t\t\t\tfunction () {\n\t\t\t\t\tthisInstance.calculateDiscount(parentRow, modal);\n\t\t\t\t}\n\t\t\t);\n\t\t\tmodal.on('click', '.js-save-discount', function () {\n\t\t\t\tif (form.validationEngine('validate') === false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthisInstance.saveDiscountsParameters(parentRow, modal);\n\t\t\t\tif (params.discountMode == thisInstance.DISCOUNT_MODE_INDIVIDUAL) {\n\t\t\t\t\tthisInstance.setDiscount(parentRow, App.Fields.Double.formatToDb(modal.find('.valueDiscount').text()));\n\t\t\t\t\tthisInstance.quantityChangeActions(parentRow);\n\t\t\t\t} else if (params.discountMode == thisInstance.DISCOUNT_MODE_GROUP) {\n\t\t\t\t\tlet rate =\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.valueDiscount').text()) /\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.valueTotalPrice').text());\n\t\t\t\t\tthisInstance.getGroupItems(parentRow).each(function () {\n\t\t\t\t\t\tthisInstance.setDiscount($(this), thisInstance.getTotalPrice($(this)) * rate);\n\t\t\t\t\t\tthisInstance.quantityChangeActions($(this));\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tlet rate =\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.valueDiscount').text()) /\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.valueTotalPrice').text());\n\t\t\t\t\tparentRow.find(thisInstance.rowClass).each(function () {\n\t\t\t\t\t\tthisInstance.setDiscount($(this), thisInstance.getTotalPrice($(this)) * rate);\n\t\t\t\t\t\tthisInstance.quantityChangeActions($(this));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tapp.hideModalWindow();\n\t\t\t});\n\t\t},\n\t\tregisterChangeTax: function () {\n\t\t\tconst thisInstance = this;\n\t\t\tthisInstance.form.on('click', '.changeTax', function (e) {\n\t\t\t\tlet parentRow;\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tlet params = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'Inventory',\n\t\t\t\t\tmode: 'showTaxes',\n\t\t\t\t\tcurrency: thisInstance.getCurrency(),\n\t\t\t\t\trelatedRecord: thisInstance.getAccountId()\n\t\t\t\t};\n\t\t\t\tif (element.hasClass('js-inv-tax_global')) {\n\t\t\t\t\tparentRow = thisInstance.getInventoryItemsContainer();\n\t\t\t\t\tlet totalPrice = 0;\n\t\t\t\t\tif (parentRow.find('tfoot .colNetPrice').length > 0) {\n\t\t\t\t\t\ttotalPrice = parentRow.find('tfoot .colNetPrice').text();\n\t\t\t\t\t} else if (parentRow.find('tfoot .colTotalPrice ').length > 0) {\n\t\t\t\t\t\ttotalPrice = parentRow.find('tfoot .colTotalPrice ').text();\n\t\t\t\t\t}\n\t\t\t\t\tparams.totalPrice = App.Fields.Double.formatToDb(totalPrice);\n\t\t\t\t\tparams.taxType = 1;\n\t\t\t\t} else {\n\t\t\t\t\tparentRow = element.closest(thisInstance.rowClass);\n\t\t\t\t\tlet sourceRecord = parentRow.find('.rowName .sourceField').val();\n\t\t\t\t\tparams.totalPrice = thisInstance.getNetPrice(parentRow);\n\t\t\t\t\tparams.taxType = 0;\n\t\t\t\t\tif (sourceRecord) {\n\t\t\t\t\t\tparams.record = sourceRecord;\n\t\t\t\t\t}\n\t\t\t\t\tparams.recordModule = parentRow.find('.rowName [name=\"popupReferenceModule\"]').val();\n\t\t\t\t}\n\t\t\t\tlet progressInstace = $.progressIndicator();\n\t\t\t\tAppConnector.request(params)\n\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\tapp.showModalWindow(data, function (data) {\n\t\t\t\t\t\t\tthisInstance.initTaxParameters(parentRow, $(data));\n\t\t\t\t\t\t\tthisInstance.registerChangeTaxModal(data, parentRow, params);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function () {\n\t\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tlockCurrencyChange: false,\n\t\tregisterChangeCurrency() {\n\t\t\tthis.getInventoryHeadContainer().on('change', '.js-currency', (e) => {\n\t\t\t\tlet element = $(e.currentTarget),\n\t\t\t\t\tsymbol = element.find('option:selected').data('conversionSymbol');\n\t\t\t\tthis.currencyChangeActions(element, element.find('option:selected'));\n\t\t\t\tthis.form.find('.currencySymbol').text(symbol);\n\t\t\t});\n\t\t},\n\t\tregisterChangeDiscountAggregation() {\n\t\t\tthis.getInventoryHeadContainer().on('change', '.js-discount_aggreg', (e) => {\n\t\t\t\tthis.rowsCalculations();\n\t\t\t});\n\t\t},\n\t\tregisterChangeTaxModal: function (modal, parentRow, params) {\n\t\t\tlet thisInstance = this;\n\t\t\tlet form = modal.find('form');\n\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\tmodal.on('change', '.individualTaxType', function (e) {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tmodal.find('.individualTaxContainer .input-group-text').text(element.data('symbol'));\n\t\t\t});\n\t\t\tmodal.on('change', '.activeCheckbox[name=\"aggregationType\"]', function (e) {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tif (element.attr('type') == 'checkbox' && this.checked) {\n\t\t\t\t\telement.closest('.js-panel').find('.js-panel__body').removeClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').addClass('js-active');\n\t\t\t\t} else if (element.attr('type') == 'radio') {\n\t\t\t\t\tmodal.find('.js-panel').removeClass('js-active');\n\t\t\t\t\tmodal.find('.js-panel .js-panel__body').addClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').find('.js-panel__body').removeClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').addClass('js-active');\n\t\t\t\t} else {\n\t\t\t\t\telement.closest('.js-panel').find('.js-panel__body').addClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').removeClass('js-active');\n\t\t\t\t}\n\t\t\t});\n\t\t\tmodal.on('change', '.activeCheckbox, .globalTax, .individualTaxValue, .groupTax, .regionalTax', function () {\n\t\t\t\tthisInstance.calculateTax(parentRow, modal);\n\t\t\t});\n\t\t\tmodal.on('click', '.js-save-taxs', function () {\n\t\t\t\tif (form.validationEngine('validate') === false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthisInstance.saveTaxsParameters(parentRow, modal);\n\t\t\t\tif (params.taxType == '0') {\n\t\t\t\t\tthisInstance.setTax(parentRow, App.Fields.Double.formatToDb(modal.find('.valueTax').text()));\n\t\t\t\t\tthisInstance.setTaxPercent(parentRow, App.Fields.Double.formatToDb(modal.find('.js-tax-value').text()));\n\t\t\t\t\tthisInstance.quantityChangeActions(parentRow);\n\t\t\t\t} else {\n\t\t\t\t\tlet rate =\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.valueTax').text()) /\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.valueNetPrice').text());\n\t\t\t\t\tparentRow.find(thisInstance.rowClass).each(function () {\n\t\t\t\t\t\tlet totalPrice;\n\t\t\t\t\t\tif ($('.netPrice', $(this)).length > 0) {\n\t\t\t\t\t\t\ttotalPrice = thisInstance.getNetPrice($(this));\n\t\t\t\t\t\t} else if ($('.totalPrice', $(this)).length > 0) {\n\t\t\t\t\t\t\ttotalPrice = thisInstance.getTotalPrice($(this));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthisInstance.setTax($(this), totalPrice * rate);\n\t\t\t\t\t\tthisInstance.setTaxPercent($(this), App.Fields.Double.formatToDb(modal.find('.js-tax-value').text()));\n\t\t\t\t\t\tthisInstance.quantityChangeActions($(this));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tapp.hideModalWindow();\n\t\t\t});\n\t\t},\n\t\tregisterRowAutoComplete: function (container) {\n\t\t\tconst thisInstance = this;\n\t\t\tlet sourceFieldElement = container.find('.sourceField.js-name');\n\t\t\tsourceFieldElement.on(Vtiger_Edit_Js.referenceSelectionEvent, (e, params) => {\n\t\t\t\tlet record = params.record;\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tlet parentRow = element.closest(thisInstance.rowClass);\n\t\t\t\tlet selectedModule = parentRow.find('.rowName [name=\"popupReferenceModule\"]').val();\n\t\t\t\tlet formParam = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\taction: 'Inventory',\n\t\t\t\t\tmode: 'getDetails',\n\t\t\t\t\trecord: record,\n\t\t\t\t\tfieldname: element.data('columnname')\n\t\t\t\t};\n\t\t\t\tif (this.getCurrency()) {\n\t\t\t\t\tformParam.currency_id = this.getCurrency();\n\t\t\t\t\tformParam.currencyParams = this.getInventoryHeadContainer().find('.js-currencyparam').val();\n\t\t\t\t}\n\t\t\t\tAppConnector.request(formParam).done(function (data) {\n\t\t\t\t\tfor (let id in data) {\n\t\t\t\t\t\tif (typeof data[id] == 'object') {\n\t\t\t\t\t\t\tlet recordData = data[id];\n\t\t\t\t\t\t\tthisInstance.mapResultsToFields(selectedModule, parentRow, recordData);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Mass add entries.\n\t\t */\n\t\tregisterMassAddItem: function () {\n\t\t\tthis.getForm().on('click', '.js-mass-add', (e) => {\n\t\t\t\tlet currentTarget = $(e.currentTarget);\n\t\t\t\tlet moduleName = currentTarget.data('module');\n\t\t\t\tlet url = currentTarget.data('url');\n\t\t\t\tapp.showRecordsList(url, (_, instance) => {\n\t\t\t\t\tinstance.setSelectEvent((data) => {\n\t\t\t\t\t\tfor (let i in data) {\n\t\t\t\t\t\t\tlet parentElem = this.addItem(moduleName, '', false, currentTarget.closest('.js-inv-container-content'));\n\t\t\t\t\t\t\tVtiger_Edit_Js.getInstance().setReferenceFieldValue(parentElem.find('.rowName'), {\n\t\t\t\t\t\t\t\tname: data[i],\n\t\t\t\t\t\t\t\tid: i\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\tcalculateItemNumbers: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet items = this.getInventoryItemsContainer();\n\t\t\tlet i = 1;\n\t\t\titems.find(thisInstance.rowClass).each(function () {\n\t\t\t\t$(this).find('.itemNumberText').text(i);\n\t\t\t\ti++;\n\t\t\t});\n\t\t},\n\t\tinitItem: function (container) {\n\t\t\tlet thisInstance = this;\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = thisInstance.getInventoryItemsContainer();\n\t\t\t}\n\t\t\tthisInstance.registerDeleteLineItemEvent(container);\n\t\t\tthisInstance.registerPriceBookModal(container);\n\t\t\tthisInstance.registerRowChangeEvent(container);\n\t\t\tthisInstance.registerRowAutoComplete(container);\n\t\t\tthisInstance.checkDeleteIcon();\n\t\t\tthisInstance.rowsCalculations();\n\t\t\tthisInstance.updateRowSequence();\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(container.find('.selectInv'));\n\t\t\tApp.Fields.Date.register(container, true, {}, 'dateFieldInv');\n\t\t\tcontainer.validationEngine('detach');\n\t\t\tcontainer.validationEngine(app.validationEngineOptions);\n\t\t\tApp.Fields.Text.Editor.register(container);\n\t\t},\n\t\t/**\n\t\t * Load inventory data for specified record\n\t\t * @param {int} recordId\n\t\t * @param {string} sourceModule\n\t\t * @param {function|bool} success callback\n\t\t * @param {function|bool} fail callback\n\t\t * @returns Promise\n\t\t */\n\t\tloadInventoryData(recordId, sourceModule, success = false, fail = false) {\n\t\t\tconst progressLoader = $.progressIndicator({ blockInfo: { enabled: true } });\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tsrc_module: sourceModule,\n\t\t\t\t\tsrc_record: recordId,\n\t\t\t\t\taction: 'Inventory',\n\t\t\t\t\tmode: 'getTableData',\n\t\t\t\t\trecord: app.getRecordId()\n\t\t\t\t})\n\t\t\t\t\t.done((response) => {\n\t\t\t\t\t\tlet activeModules = [];\n\t\t\t\t\t\tthis.getContainer()\n\t\t\t\t\t\t\t.find('.js-inv-add-item')\n\t\t\t\t\t\t\t.each((_, addBtn) => {\n\t\t\t\t\t\t\t\tactiveModules.push($(addBtn).data('module'));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\tprogressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tconst oldCurrencyChangeAction = this.currencyChangeActions;\n\t\t\t\t\t\tthis.currencyChangeActions = function changeCurrencyActions(select, option) {\n\t\t\t\t\t\t\tthis.currencyConvertValues(select, option);\n\t\t\t\t\t\t\tselect.data('oldValue', select.val());\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst first = response.result[Object.keys(response.result)[0]];\n\t\t\t\t\t\tthis.setCurrencyParam(first.currencyparam);\n\t\t\t\t\t\tthis.setCurrency(first.currency);\n\t\t\t\t\t\tthis.setDiscountMode(first.discountmode);\n\t\t\t\t\t\tthis.setTaxMode(first.taxmode);\n\t\t\t\t\t\tthis.currencyChangeActions = oldCurrencyChangeAction;\n\t\t\t\t\t\tthis.clearInventory();\n\t\t\t\t\t\t$.each(response.result, (_, row) => {\n\t\t\t\t\t\t\tif (activeModules.indexOf(row.moduleName) !== -1) {\n\t\t\t\t\t\t\t\tif (row.groupid && row.add_header) {\n\t\t\t\t\t\t\t\t\tthis.addHeaderItem(row);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.addItem(row.moduleName, row.basetableid, row);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\ttextTrusted: false,\n\t\t\t\t\t\t\t\t\ttext: app\n\t\t\t\t\t\t\t\t\t\t.vtranslate('JS_INVENTORY_ITEM_MODULE_NOT_FOUND')\n\t\t\t\t\t\t\t\t\t\t.replace('${sourceModule}', row.moduleName)\n\t\t\t\t\t\t\t\t\t\t.replace('${position}', row.info.name)\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.summaryCalculations();\n\t\t\t\t\t\tresolve(response.result);\n\t\t\t\t\t\tif (typeof success === 'function') {\n\t\t\t\t\t\t\tsuccess(response.result);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.fail((error, err) => {\n\t\t\t\t\t\tprogressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\treject(error, err);\n\t\t\t\t\t\tif (typeof fail === 'function') {\n\t\t\t\t\t\t\tfail(error, err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Clear inventory data\n\t\t */\n\t\tclearInventory: function () {\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find('.deleteRow,.js-delete-header-item')\n\t\t\t\t.each((_, e) => {\n\t\t\t\t\t$(e).trigger('click');\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register currency converter\n\t\t */\n\t\tregisterCurrencyConverter() {\n\t\t\tthis.form.on('click', '.js-currency-converter-event', (e) => {\n\t\t\t\tlet row = $(e.currentTarget).closest(this.rowClass);\n\t\t\t\tlet unitPrice = this.getUnitPriceValue(row) || 0;\n\t\t\t\tlet currencyId = this.getCurrency();\n\t\t\t\tApp.Components.CurrencyConverter.modalView({\n\t\t\t\t\tcurrencyId: currencyId,\n\t\t\t\t\tamount: App.Fields.Double.formatToDisplay(unitPrice),\n\t\t\t\t\tcurrencyParam: this.form.find('.js-currencyparam').val()\n\t\t\t\t}).done((data) => {\n\t\t\t\t\tlet value;\n\t\t\t\t\tif (currencyId === data.currency_target_id) {\n\t\t\t\t\t\tvalue = data.currency_target_value;\n\t\t\t\t\t} else if (currencyId === data.currency_base_id) {\n\t\t\t\t\t\tvalue = data.currency_base_value;\n\t\t\t\t\t}\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tthis.setUnitPrice(row, App.Fields.Double.formatToDb(value));\n\t\t\t\t\t\tthis.quantityChangeActions(row);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register head element events\n\t\t */\n\t\tregisterHeadEvents() {\n\t\t\tthis.getInventoryHeadContainer()\n\t\t\t\t.find('.js-inv-cuurency_reset')\n\t\t\t\t.on('click', (e) => {\n\t\t\t\t\tapp.showConfirmModal({\n\t\t\t\t\t\ttextTrusted: false,\n\t\t\t\t\t\ttext: e.currentTarget.dataset.confirmation,\n\t\t\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\t\t\tAppConnector.request(e.currentTarget.dataset.url).done((response) => {\n\t\t\t\t\t\t\t\tif (response.result && Object.keys(response.result).length) {\n\t\t\t\t\t\t\t\t\tthis.setCurrencyParam(JSON.stringify(response.result));\n\t\t\t\t\t\t\t\t\tthis.syncHeaderData();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will register all the events\n\t\t */\n\t\tregisterEvents: function (container) {\n\t\t\tthis.form = container;\n\t\t\tthis.loadConfig();\n\t\t\tthis.registerInventorySaveData();\n\t\t\tthis.registerAddItem();\n\t\t\tthis.registerAddHeaderItem();\n\t\t\tthis.registerMassAddItem();\n\t\t\tthis.initItem();\n\t\t\tthis.registerSortableItems();\n\t\t\tthis.registerSubProducts();\n\t\t\tthis.registerChangeDiscount();\n\t\t\tthis.registerChangeTax();\n\t\t\tthis.registerClearReferenceSelection();\n\t\t\tthis.registerShowHideExpanded();\n\t\t\tthis.registerChangeCurrency();\n\t\t\tthis.registerChangeDiscountAggregation();\n\t\t\tthis.setDefaultGlobalTax(container);\n\t\t\tthis.registerShowHideExpandedGroup();\n\t\t\tapp.registerBlockToggleEvent(container);\n\t\t\tthis.registerCurrencyConverter();\n\t\t\tthis.registerHeadEvents();\n\t\t}\n\t}\n);\n"],"names":["_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","_typeof","obj","$","Class","inventoryInstance","getInventoryInstance","container","moduleClassName","find","val","window","registerEvents","form","discount","tax","inventoryContainer","inventoryHeadContainer","summaryTaxesContainer","summaryDiscountContainer","summaryCurrenciesContainer","rowClass","discountModalFields","taxModalFields","getForm","loadConfig","discontConfig","taxConfig","JSON","parse","getContainer","getInventoryItemsContainer","getInventoryHeadContainer","getInventorySummaryDiscountContainer","getInventorySummaryTaxesContainer","getInventorySummaryCurrenciesContainer","getNextLineItemRowNumber","$inventoryItemsNo","rowNumber","parseInt","getAccountId","accountReferenceField","checkDeleteIcon","showLineItemsDeleteIcon","app","getMainParams","hideLineItemsDeleteIcon","removeClass","addClass","getClosestRow","element","closest","getBasicRow","eq","clone","isRecordSelected","parentRow","productField","validationEngine","getTaxModeSelectElement","row","items","isIndividualTaxMode","selectedOption","default_mode","isGroupTaxMode","showIndividualTax","thisInstance","groupTax","newRow","taxParam","aggregationType","each","thisItem","globalTax","parseFloat","attr","setTaxParam","setTax","setTaxPercent","setDefaultGlobalTax","rowsCalculations","taxDefaultValue","data","isGroupTax","summaryContainer","getTaxParams","individualTax","stringify","quantityChangeActions","getDiscountMode","getCurrency","getDiscountAggregation","aggregation","getTax","self","taxParams","valuePrices","getNetPrice","taxRate","types","forEach","entry","taxValue","regionalTax","getTaxPercent","taxPercent","getQuantityValue","getNumberFromValue","getUnitPriceValue","getDiscount","_this","discountParams","getTotalPrice","discountRate","globalDiscount","groupDiscount","individualDiscountType","individualDiscount","additionalDiscount","AGGREGATION_CASCADE","type","getGrossPrice","getPurchase","qty","purchase","App","Fields","Double","formatToDb","getSummaryGrossPrice","price","setCurrency","trigger","setCurrencyParam","setDiscountMode","setTaxMode","setName","display","setQuantity","setUnit","text","setSubUnit","setComment","parent","setUnitPrice","formatToDisplay","setPurchase","setNetPrice","setGrossPrice","setTotalPrice","setMargin","setMarginP","setDiscount","setDiscountParam","rowCalculations","summaryCalculations","calculateTotalPrice","calculateDiscounts","calculateNetPrice","calculateTaxes","calculateGrossPrice","calculateMargin","event","syncHeaderData","calculateItemNumbers","_this2","_n","e","calculateSummary","calculateDiscountSummary","calculateTaxSummary","calculateCurrenciesSummary","calculateMarginPSummary","summaryGroupCalculations","getItems","getGroups","getGroupItems","groupRow","nextUntil","filter","getGroupFromItem","classElement","is","hasClass","prev","_this3","rows","sum","fieldName","get","innerText","sumRow","totalPriceField","sumPrice","getNumberFromText","marginp","purchasePrice","subtraction","getAllDiscount","selected","base","conversionRate","baseConversionRate","taxes","getAllTaxes","html","index","value","appendTo","typeSummary","netPrice","params","param","_","percent","old","margin","AGGREGATION_CANNOT_BE_COMBINED","AGGREGATION_IN_TOTAL","calculateDiscount","_row","modal","accountDiscount","netPriceBeforeDiscount","isMarkup","getValue","concat","customCheckTrue","prop","discountValue","calculateTax","netPriceWithoutTax","taxType","panel","updateRowSequence","registerInventorySaveData","_this4","on","showAllItems","Vtiger_Edit_Js","recordPreSave","checkLimits","_this5","renumberHeaderItems","header","pricebooksModalHandler","_this6","lineItemRow","rowName","currencyId","CONFIG","defaultCurrencyId","showRecordsList","module","src_module","src_record","src_field","search_params","lockedFields","cvEnabled","currency_id","additionalData","_modal","instance","setSelectEvent","responseData","AppConnector","request","action","record","id","done","result","errorLog","subProductsCashe","loadSubProducts","indicator","progressInstace","recordId","recordModule","removeSubProducts","inArray","addSubProducts","progressIndicator","hide","fail","subProductsContainer","remove","append","mapResultsToFields","referenceModule","unit","recordData","description","unitPriceValues","unitPriceValuesJson","parameters","field","autoFields","inputField","commentElement","next","editorInstance","CKEDITOR","instances","setData","triggerQtyParam","qtyPerUnit","perUnit","saveDiscountsParameters","panels","info","push","discoutMode","DISCOUNT_MODE_GROUP","DISCOUNT_MODE_GLOBAL","saveTaxsParameters","extend","showExpandedRow","inventoryRowExpanded","markCommentBtn","hideExpandedRow","rowExpanded","initTaxParameters","parameter","array","arrayValue","change","input","formatNumber","limitEnableSave","account","limit","response","async","dataType","getModuleName","mode","currency","thisInthisstance","status","showModalWindow","currencyChangeActions","select","option","currencyConvertValues","showCurrencyChangeModal","lockCurrencyChange","block","currencyParam","date","rate","conversion","hideModalWindow","one","previous","prevConversionRate","setRowData","rowData","FORMAT_TRUNCATE_TRAILING_ZEROS","unitText","subunit","subunitText","comment1","net","gross","total","discountparam","taxparam","tax_percent","addItem","baseTableId","arguments","sequenceNumber","replaced","replace","moduleLabels","initItem","getInstance","registerAutoCompleteFields","itemChangeEvent","_this7","addHeaderItem","grouplabel","el","options","map","includes","newOption","Option","getNextBlockId","Math","max","apply","registerAddItem","_this8","currentTarget","dataset","registerAddHeaderItem","_this9","registerSortableItems","sortable","handle","revert","tolerance","placeholder","helper","_e","ui","children","width","start","num","item","Text","destroyEditor","startPos","stop","numrow","child","after","Editor","register","registerShowHideExpanded","_this10","registerShowHideExpandedGroup","_this11","btn","icon","registerPriceBookModal","_this12","registerRowChangeEvent","_this13","format","headContainer","registerSubProducts","registerClearReferenceSelection","_this14","referenceGroup","removeAttr","registerDeleteLineItemEvent","_this15","deleteLineItem","DISCOUNT_MODE_INDIVIDUAL","registerChangeDiscount","_this16","view","discountAggregation","relatedRecord","discountMode","totalPrice","discountParam","registerChangeDiscountModal","validationEngineOptions","checked","registerChangeTax","sourceRecord","registerChangeTaxModal","registerChangeCurrency","_this17","symbol","registerChangeDiscountAggregation","_this18","registerRowAutoComplete","_this19","sourceFieldElement","referenceSelectionEvent","selectedModule","formParam","fieldname","currencyParams","registerMassAddItem","_this20","moduleName","url","parentElem","setReferenceFieldValue","Picklist","showSelect2ElementView","Date","loadInventoryData","sourceModule","_this21","success","progressLoader","blockInfo","enabled","Promise","resolve","reject","getRecordId","activeModules","addBtn","oldCurrencyChangeAction","first","keys","currencyparam","discountmode","taxmode","clearInventory","indexOf","Vtiger_Helper_Js","showMessage","textTrusted","vtranslate","groupid","add_header","basetableid","error","err","registerCurrencyConverter","_this22","unitPrice","Components","CurrencyConverter","modalView","amount","currency_target_id","currency_target_value","currency_base_id","currency_base_value","registerHeadEvents","_this23","showConfirmModal","confirmation","confirmedCallback","registerBlockToggleEvent"],"mappings":"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"}