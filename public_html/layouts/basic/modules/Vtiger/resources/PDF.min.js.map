{"version":3,"file":"PDF.min.js","sources":["PDF.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class('Vtiger_PDF_Js', {\n\t/*\n\t * Function to register the click event for generate button\n\t */\n\tregisterPreSubmitEvent: function (container) {\n\t\tcontainer.find('#generate_pdf, #single_pdf, #email_pdf').on('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\tthis.proceedSubmit.apply(this, [$(e.currentTarget).attr('id')]);\n\t\t});\n\t},\n\n\t/**\n\t * Proceed form submission\n\t */\n\tproceedSubmit(mode) {\n\t\tconst loader = $.progressIndicator({\n\t\t\tmessage: app.vtranslate('JS_PDF_GENERATING'),\n\t\t\tposition: 'html',\n\t\t\tblockInfo: {\n\t\t\t\tenabled: true\n\t\t\t}\n\t\t});\n\t\tswitch (mode) {\n\t\t\tcase 'generate_pdf':\n\t\t\t\tthis.container.find('#pdfExportModal').submit();\n\t\t\t\tthis.displayNotify();\n\t\t\t\tbreak;\n\t\t\tcase 'single_pdf':\n\t\t\t\tthis.container.find('[name=\"single_pdf\"]').val(1);\n\t\t\t\tthis.container.find('#pdfExportModal').submit();\n\t\t\t\tthis.displayNotify();\n\t\t\t\tbreak;\n\t\t\tcase 'email_pdf':\n\t\t\t\tthis.container.find('[name=\"email_pdf\"]').val(1);\n\t\t\t\tthis.container.find('#pdfExportModal').submit();\n\t\t\t\tbreak;\n\t\t}\n\t\tloader.progressIndicator({ mode: 'hide' });\n\t\tapp.hideModalWindow();\n\t},\n\t/**\n\t * Display notify after submit\n\t */\n\tdisplayNotify() {\n\t\tlet message = '';\n\t\tif (this.container.find('[name=\"attach_as_document\"]').is(':checked')) {\n\t\t\tmessage = app.vtranslate('JS_PDF_GENERATED_AND_ATTACHED');\n\t\t} else {\n\t\t\tmessage = app.vtranslate('JS_PDF_GENERATED');\n\t\t}\n\t\tapp.showNotify({\n\t\t\ttext: message,\n\t\t\ttype: 'success'\n\t\t});\n\t},\n\t/**\n\t * Register list view check records\n\t *\n\t * @param   {jQuery}  container\n\t */\n\tregisterListViewCheckRecords(container) {\n\t\tlet templateElements = container.find('[name=\"pdf_template[]\"]');\n\t\ttemplateElements.on('change', function () {\n\t\t\tdocument.progressLoader = $.progressIndicator({\n\t\t\t\tmessage: app.vtranslate('JS_PDF_RECALCULATING'),\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet templateContainer = $(this).closest('.js-pdf-template-content');\n\t\t\ttemplateContainer.find('.js-pdf-user-variable').toggleClass('d-none');\n\n\t\t\tlet templates = [];\n\t\t\ttemplateElements.filter(':checked').each(function () {\n\t\t\t\ttemplates.push($(this).val());\n\t\t\t});\n\n\t\t\tlet params = container.find('form').serializeFormData();\n\t\t\tparams.mode = 'validateRecords';\n\t\t\tparams.templates = templates;\n\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tvar response = data.result;\n\t\t\t\t\tif (data.success) {\n\t\t\t\t\t\tlet valid = response.valid;\n\t\t\t\t\t\tlet info = container.find('.js-records-info').text(response.message).removeClass('d-none');\n\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\tinfo.addClass('d-none');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tdocument.progressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t}, 500);\n\n\t\t\t\t\t\tcontainer.find('.js-submit-button').each(function () {\n\t\t\t\t\t\t\t$(this).attr('disabled', !valid);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (data, err) {\n\t\t\t\t\tapp.errorLog(data, err);\n\t\t\t\t});\n\t\t});\n\t},\n\n\t/**\n\t * Register select custom columns change\n\t */\n\tregisterSelectCustomColumnsChange() {\n\t\tthis.container.find('[name=\"isCustomMode\"]').on('change', (ev) => {\n\t\t\tif ($(ev.target).is(':checked')) {\n\t\t\t\tthis.container.find('[name=\"inventoryColumns[]\"]').prop('disabled', null);\n\t\t\t\tthis.container.find('.js-save-scheme').prop('disabled', null);\n\t\t\t} else {\n\t\t\t\tthis.container.find('[name=\"inventoryColumns[]\"]').prop('disabled', 'disabled');\n\t\t\t\tthis.container.find('.js-save-scheme').prop('disabled', 'disabled');\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Register save scheme button click\n\t */\n\tregisterSaveInventoryColumnSchemeClick() {\n\t\tthis.container.find('.js-save-scheme').on('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tconst loader = $.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet params = this.container.find('form').serializeFormData();\n\t\t\tparams.mode = 'saveInventoryColumnScheme';\n\t\t\tparams.isCustomMode = this.container.find('[name=\"isCustomMode\"]').is(':checked');\n\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tconst response = data['result'];\n\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\tloader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t}\n\t\t\t\t\tif (response['message'] && data['success']) {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: response['message'],\n\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (data, err) {\n\t\t\t\t\tapp.errorLog(data, err);\n\t\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register events\n\t */\n\tregisterEvents() {\n\t\tconst container = (this.container = $('#pdfExportModal').closest('.js-modal-container'));\n\t\tthis.dynamicTemplatesCount = 0;\n\t\tthis.recordId = parseInt(container.find('[name=\"record\"]').val());\n\t\tthis.registerPreSubmitEvent(container);\n\t\tthis.registerSaveInventoryColumnSchemeClick();\n\t\tthis.registerSelectCustomColumnsChange();\n\t\tthis.registerListViewCheckRecords(container);\n\t}\n});\n$(function () {\n\tnew Vtiger_PDF_Js().registerEvents();\n});\n"],"names":["$","Class","registerPreSubmitEvent","container","_this","find","on","e","preventDefault","proceedSubmit","apply","currentTarget","attr","mode","loader","progressIndicator","message","app","vtranslate","position","blockInfo","enabled","submit","displayNotify","val","hideModalWindow","is","showNotify","text","type","registerListViewCheckRecords","templateElements","document","progressLoader","templateContainer","closest","toggleClass","templates","filter","each","push","params","serializeFormData","AppConnector","request","done","data","response","result","success","valid","info","removeClass","addClass","setTimeout","fail","err","errorLog","registerSelectCustomColumnsChange","_this2","ev","target","prop","registerSaveInventoryColumnSchemeClick","_this3","stopPropagation","isCustomMode","registerEvents","dynamicTemplatesCount","recordId","parseInt","Vtiger_PDF_Js"],"mappings":";;AAAA,kKACA,YAAY,CAEZA,CAAC,CAACC,KAAK,CAAC,eAAe,CAAE;AAEzB;AACA,IACCC,sBAAsB,CAAE,SAAAA,sBAAUC,CAAAA,SAAS,CAAE,CAAAC,IAAAA,KAAA,CAC5CD,IAAAA,CAAAA,SAAS,CAACE,IAAI,CAAC,wCAAwC,CAAC,CAACC,EAAE,CAAC,OAAO,CAAE,SAACC,CAAC,CAAK,CAC3EA,CAAC,CAACC,cAAc,EAAE,CAClBJ,KAAI,CAACK,aAAa,CAACC,KAAK,CAACN,KAAI,CAAE,CAACJ,CAAC,CAACO,CAAC,CAACI,aAAa,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,EAC/D,CAAC,EACF,CAAC;AAGF;AACA,IACCH,aAAa,CAAA,SAAAA,aAACI,CAAAA,IAAI,CAAE,CACnB,IAAMC,MAAM,CAAGd,CAAC,CAACe,iBAAiB,CAAC,CAClCC,OAAO,CAAEC,GAAG,CAACC,UAAU,CAAC,mBAAmB,CAAC,CAC5CC,QAAQ,CAAE,MAAM,CAChBC,SAAS,CAAE,CACVC,OAAO,GACR,CACD,CAAC,CAAC,CAEI,cAAc,GADZR,IAAI,EAEV,IAAI,CAACV,SAAS,CAACE,IAAI,CAAC,iBAAiB,CAAC,CAACiB,MAAM,EAAE,CAC/C,IAAI,CAACC,aAAa,EAAE,EAEhB,YAAY,GALVV,IAAI,EAMV,IAAI,CAACV,SAAS,CAACE,IAAI,CAAC,uBAAqB,CAAC,CAACmB,GAAG,CAAC,CAAC,CAAC,CACjD,IAAI,CAACrB,SAAS,CAACE,IAAI,CAAC,iBAAiB,CAAC,CAACiB,MAAM,EAAE,CAC/C,IAAI,CAACC,aAAa,EAAE,EAEhB,WAAW,GAVTV,IAAI,EAWV,IAAI,CAACV,SAAS,CAACE,IAAI,CAAC,sBAAoB,CAAC,CAACmB,GAAG,CAAC,CAAC,CAAC,CAChD,IAAI,CAACrB,SAAS,CAACE,IAAI,CAAC,iBAAiB,CAAC,CAACiB,MAAM,EAAE,EAAA,KAAA,CAAA,CAGjDR,MAAM,CAACC,iBAAiB,CAAC,CAAEF,IAAI,CAAE,MAAO,CAAC,CAAC,CAC1CI,GAAG,CAACQ,eAAe,GACpB,CAAC;AAEF;AACA,IACCF,aAAa,CAAAA,SAAAA,aAAAA,EAAG,CACf,IAAIP,OAAO,CAAG,EAAE,CAEfA,OAAO,CADJ,IAAI,CAACb,SAAS,CAACE,IAAI,CAAC,+BAA6B,CAAC,CAACqB,EAAE,CAAC,UAAU,CAAC,CAC1DT,GAAG,CAACC,UAAU,CAAC,+BAA+B,CAAC,CAE/CD,GAAG,CAACC,UAAU,CAAC,kBAAkB,CAAC,CAE7CD,GAAG,CAACU,UAAU,CAAC,CACdC,IAAI,CAAEZ,OAAO,CACba,IAAI,CAAE,SACP,CAAC,EACF,CAAC;AAEF;AACA;AACA;AACA,IACCC,4BAA4B,CAAA,SAAAA,4BAAC3B,CAAAA,SAAS,CAAE,CACvC,IAAI4B,gBAAgB,CAAG5B,SAAS,CAACE,IAAI,CAAC,2BAAyB,CAAC,CAChE0B,gBAAgB,CAACzB,EAAE,CAAC,QAAQ,CAAE,UAAY,CACzC0B,QAAQ,CAACC,cAAc,CAAGjC,CAAC,CAACe,iBAAiB,CAAC,CAC7CC,OAAO,CAAEC,GAAG,CAACC,UAAU,CAAC,sBAAsB,CAAC,CAC/CC,QAAQ,CAAE,MAAM,CAChBC,SAAS,CAAE,CACVC,OAAO,CAAA,CAAA,CACR,CACD,CAAC,CAAC,CAEF,IAAIa,iBAAiB,CAAGlC,CAAC,CAAC,IAAI,CAAC,CAACmC,OAAO,CAAC,0BAA0B,CAAC,CACnED,iBAAiB,CAAC7B,IAAI,CAAC,uBAAuB,CAAC,CAAC+B,WAAW,CAAC,QAAQ,CAAC,CAErE,IAAIC,SAAS,CAAG,EAAE,CAClBN,gBAAgB,CAACO,MAAM,CAAC,UAAU,CAAC,CAACC,IAAI,CAAC,UAAY,CACpDF,SAAS,CAACG,IAAI,CAACxC,CAAC,CAAC,IAAI,CAAC,CAACwB,GAAG,EAAE,EAC7B,CAAC,CAAC,CAEF,IAAIiB,MAAM,CAAGtC,SAAS,CAACE,IAAI,CAAC,MAAM,CAAC,CAACqC,iBAAiB,EAAE,CACvDD,MAAM,CAAC5B,IAAI,CAAG,iBAAiB,CAC/B4B,MAAM,CAACJ,SAAS,CAAGA,SAAS,CAE5BM,YAAY,CAACC,OAAO,CAACH,MAAM,CAAC,CAC1BI,IAAI,CAAC,SAAUC,IAAI,CAAE,CACrB,IAAIC,QAAQ,CAAGD,IAAI,CAACE,MAAM,CAC1B,GAAIF,IAAI,CAACG,OAAO,CAAE,CACb,IAAAC,KAAK,CAAGH,QAAQ,CAACG,KAAK,CACtBC,IAAI,CAAGhD,SAAS,CAACE,IAAI,CAAC,kBAAkB,CAAC,CAACuB,IAAI,CAACmB,QAAQ,CAAC/B,OAAO,CAAC,CAACoC,WAAW,CAAC,QAAQ,CAAC,CACtFF,KAAK,EACRC,IAAI,CAACE,QAAQ,CAAC,QAAQ,CAAC,CAExBC,UAAU,CAAC,UAAY,CACtBtB,QAAQ,CAACC,cAAc,CAAClB,iBAAiB,CAAC,CAAEF,IAAI,CAAE,MAAO,CAAC,EAC3D,CAAC,CAAE,GAAG,CAAC,CAEPV,SAAS,CAACE,IAAI,CAAC,mBAAmB,CAAC,CAACkC,IAAI,CAAC,UAAY,CACpDvC,CAAC,CAAC,IAAI,CAAC,CAACY,IAAI,CAAC,UAAU,CAAE,CAACsC,KAAK,EAChC,CAAC,EACF,CACD,CAAC,CAAC,CACDK,IAAI,CAAC,SAAUT,IAAI,CAAEU,GAAG,CAAE,CAC1BvC,GAAG,CAACwC,QAAQ,CAACX,IAAI,CAAEU,GAAG,EACvB,CAAC,EACH,CAAC,EACF,CAAC;AAGF;AACA,IACCE,iCAAiC,UAAAA,iCAAA,EAAG,KAAAC,MAAA,CAAA,IAAA,CACnC,IAAI,CAACxD,SAAS,CAACE,IAAI,CAAC,yBAAuB,CAAC,CAACC,EAAE,CAAC,QAAQ,CAAE,SAACsD,EAAE,CAAK,CAC7D5D,CAAC,CAAC4D,EAAE,CAACC,MAAM,CAAC,CAACnC,EAAE,CAAC,UAAU,CAAC,EAC9BiC,MAAI,CAACxD,SAAS,CAACE,IAAI,CAAC,+BAA6B,CAAC,CAACyD,IAAI,CAAC,UAAU,CAAE,IAAI,CAAC,CACzEH,MAAI,CAACxD,SAAS,CAACE,IAAI,CAAC,iBAAiB,CAAC,CAACyD,IAAI,CAAC,UAAU,CAAE,IAAI,CAAC,GAE7DH,MAAI,CAACxD,SAAS,CAACE,IAAI,CAAC,+BAA6B,CAAC,CAACyD,IAAI,CAAC,UAAU,CAAE,UAAU,CAAC,CAC/EH,MAAI,CAACxD,SAAS,CAACE,IAAI,CAAC,iBAAiB,CAAC,CAACyD,IAAI,CAAC,UAAU,CAAE,UAAU,CAAC,EAErE,CAAC,EACF,CAAC;AAGF;AACA,IACCC,sCAAsC,CAAAA,SAAAA,sCAAAA,EAAG,CAAAC,IAAAA,MAAA,MACxC,IAAI,CAAC7D,SAAS,CAACE,IAAI,CAAC,iBAAiB,CAAC,CAACC,EAAE,CAAC,OAAO,CAAE,SAACC,CAAC,CAAK,CACzDA,CAAC,CAACC,cAAc,EAAE,CAClBD,CAAC,CAAC0D,eAAe,EAAE,KACbnD,MAAM,CAAGd,CAAC,CAACe,iBAAiB,CAAC,CAClCI,QAAQ,CAAE,MAAM,CAChBC,SAAS,CAAE,CACVC,OAAO,GACR,CACD,CAAC,CAAC,CAEEoB,MAAM,CAAGuB,MAAI,CAAC7D,SAAS,CAACE,IAAI,CAAC,MAAM,CAAC,CAACqC,iBAAiB,EAAE,CAC5DD,MAAM,CAAC5B,IAAI,CAAG,2BAA2B,CACzC4B,MAAM,CAACyB,YAAY,CAAGF,MAAI,CAAC7D,SAAS,CAACE,IAAI,CAAC,yBAAuB,CAAC,CAACqB,EAAE,CAAC,UAAU,CAAC,CAEjFiB,YAAY,CAACC,OAAO,CAACH,MAAM,CAAC,CAC1BI,IAAI,CAAC,SAAUC,IAAI,CAAE,CACrB,IAAMC,QAAQ,CAAGD,IAAI,CAAAE,MAAU,CAC3BF,IAAI,CAAAG,OAAW,EAClBnC,MAAM,CAACC,iBAAiB,CAAC,CAAEF,IAAI,CAAE,MAAO,CAAC,CAAC,CAEvCkC,QAAQ,CAAA/B,OAAW,EAAI8B,IAAI,CAAAG,OAAW,EACzChC,GAAG,CAACU,UAAU,CAAC,CACdC,IAAI,CAAEmB,QAAQ,CAAA/B,OAAW,CACzBa,IAAI,CAAE,SACP,CAAC,EAEH,CAAC,CAAC,CACD0B,IAAI,CAAC,SAAUT,IAAI,CAAEU,GAAG,CAAE,CAC1BvC,GAAG,CAACwC,QAAQ,CAACX,IAAI,CAAEU,GAAG,EACvB,CAAC,EACH,CAAC,EACF,CAAC;AAEF;AACA,IACCW,cAAc,CAAAA,SAAAA,cAAAA,EAAG,CAChB,IAAMhE,SAAS,CAAI,IAAI,CAACA,SAAS,CAAGH,CAAC,CAAC,iBAAiB,CAAC,CAACmC,OAAO,CAAC,qBAAqB,CAAE,CACxF,IAAI,CAACiC,qBAAqB,CAAG,CAAC,CAC9B,IAAI,CAACC,QAAQ,CAAGC,QAAQ,CAACnE,SAAS,CAACE,IAAI,CAAC,mBAAiB,CAAC,CAACmB,GAAG,EAAE,CAAC,CACjE,IAAI,CAACtB,sBAAsB,CAACC,SAAS,CAAC,CACtC,IAAI,CAAC4D,sCAAsC,EAAE,CAC7C,IAAI,CAACL,iCAAiC,EAAE,CACxC,IAAI,CAAC5B,4BAA4B,CAAC3B,SAAS,EAC5C,CACD,CAAC,CAAC,CACFH,CAAC,CAAC,UAAY,CACb,IAAIuE,aAAa,EAAE,CAACJ,cAAc,GACnC,CAAC,CAAC;;"}