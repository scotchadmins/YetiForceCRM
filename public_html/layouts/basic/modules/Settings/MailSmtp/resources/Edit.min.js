'use strict';

/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */"use strict";Settings_Vtiger_Edit_Js("Settings_MailSmtp_Edit_Js",{},{registerDependency:function registerDependency(){var dependency=JSON.parse(this.container.find(".js-smtp-dependency").val());for(var field in dependency){var fieldEl=this.container.find("[name=\"".concat(field,"\"]")),conditions=dependency[field].condition,hide=!1;for(var conField in conditions){var conFieldEl=this.container.find("[data-fieldinfo][name=\"".concat(conField,"\"]")),conFieldElVal="checkbox"===conFieldEl.attr("type")?Number(conFieldEl.is(":checked")):conFieldEl.val(),_conditions$conField=conditions[conField],value=_conditions$conField.value,operator=_conditions$conField.operator;if("e"===operator&&value==conFieldElVal||"n"===operator&&value!=conFieldElVal){hide=!0;break}}hide?fieldEl.closest(".js-field-container").addClass("d-none"):fieldEl.closest(".js-field-container").removeClass("d-none");}},changeMailerType:function changeMailerType(){var _this=this;this.container.find("select").on("change",function(){_this.registerDependency();}),this.container.find("input[type=\"checkbox\"]").on("click",function(){_this.registerDependency();});},/**
		 * PreSave validation
		 */preSaveValidation:function preSaveValidation(){var _this2=this,aDeferred=$.Deferred(),formData=new FormData(this.container[0]);return formData.append("mode","preSaveValidation"),AppConnector.request({async:!1,url:"index.php",type:"POST",data:formData,processData:!1,contentType:!1}).done(function(data){var response=data.result;for(var i in response)!0!==response[i].result&&(app.showNotify({text:response[i].message?response[i].message:app.vtranslate("JS_ERROR"),type:"error"}),null!=response[i].hoverField&&_this2.container.find("[name=\""+response[i].hoverField+"\"]").focus());aDeferred.resolve(0>=data.result.length);}).fail(function(textStatus,errorThrown){app.showNotify({text:app.vtranslate("JS_ERROR"),type:"error"}),app.errorLog(textStatus,errorThrown),aDeferred.resolve(!1);}),aDeferred.promise()},/**
		 * Register submit event
		 */registerSubmitEvent:function registerSubmitEvent(){var _this3=this;this.container.off("submit").on("submit",function(e){if(e.preventDefault(),_this3.container.find(".js-toggle-panel").find(".js-block-content").removeClass("d-none"),$(e.currentTarget).validationEngine("validate")){var progressLoader=$.progressIndicator({message:app.vtranslate("JS_SAVE_LOADER_INFO"),position:"html",blockInfo:{enabled:!0}});_this3.preSaveValidation().done(function(response){if(!0===response){var formData=_this3.container.serializeFormData();app.saveAjax("save",[],formData).done(function(data){data.result&&data.result.success?(app.showNotify({text:app.vtranslate("JS_SAVE_SUCCESS"),type:"success"}),window.location.href=data.result.url):(progressLoader.progressIndicator({mode:"hide"}),app.showNotify({text:app.vtranslate("JS_ERROR"),type:"error"}));}).fail(function(){progressLoader.progressIndicator({mode:"hide"}),app.showNotify({text:app.vtranslate("JS_ERROR"),type:"error"});});}else progressLoader.progressIndicator({mode:"hide"});});}return e.stopPropagation(),!1});},registerBasicEvents:function registerBasicEvents(){this.referenceModulePopupRegisterEvent(this.container),this.registerAutoCompleteFields(this.container),this.registerClearReferenceSelectionEvent(this.container),this.container.validationEngine(app.validationEngineOptionsForRecord),this.registerSubmitEvent(),app.registerBlockToggleEvent(this.container),App.Fields.Password.register(this.container),App.Fields.Text.registerCopyClipboard(this.container);},registerEvents:function registerEvents(){this.container=this.getForm(),this.changeMailerType(),this.registerBasicEvents(this.container);}});
//# sourceMappingURL=Edit.min.js.map
