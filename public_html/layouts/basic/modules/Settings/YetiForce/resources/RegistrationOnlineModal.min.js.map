{"version":3,"file":"RegistrationOnlineModal.min.js","sources":["RegistrationOnlineModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n/**\n * Class Settings_YetiForce_RegistrationOnlineModal_Js.\n * @type {window.Settings_YetiForce_RegistrationOnlineModal_Js}\n */\nwindow.Settings_YetiForce_RegistrationOnlineModal_Js = class Settings_YetiForce_RegistrationOnlineModal_Js {\n\t/**\n\t * Register events for form checkbox element\n\t * @param {jQuery} modalContainer\n\t */\n\tregisterNewsletter(modalContainer) {\n\t\tmodalContainer\n\t\t\t.find('form')\n\t\t\t.find('[id$=\"newsletter\"]')\n\t\t\t.on('click', (e) => {\n\t\t\t\tlet inputsContainer = $(e.target).closest('.js-card-body');\n\t\t\t\tif ($(e.target).prop('checked')) {\n\t\t\t\t\tinputsContainer.find('[id$=\"firstname]\"]').attr('data-validation-engine', 'validate[required]');\n\t\t\t\t\tinputsContainer.find('[id$=\"lastname]\"]').attr('data-validation-engine', 'validate[required]');\n\t\t\t\t\tinputsContainer.find('[id$=\"email]\"]').attr('data-validation-engine', 'validate[required,custom[email]]');\n\t\t\t\t\tinputsContainer.find('.js-newsletter-content').removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tinputsContainer.find('[id$=\"firstname]\"]').removeAttr('data-validation-engine').val('');\n\t\t\t\t\tinputsContainer.find('[id$=\"lastname]\"]').removeAttr('data-validation-engine').val('');\n\t\t\t\t\tinputsContainer.find('[id$=\"email]\"]').removeAttr('data-validation-engine').val('');\n\t\t\t\t\tinputsContainer.find('.js-newsletter-content').addClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\t}\n\t/**\n\t * Get companies from form\n\t * @param {jQuery} form\n\t * @returns {array}\n\t */\n\tgetCompanies(form) {\n\t\tlet companies = [];\n\t\tform.each(function () {\n\t\t\tcompanies.push($(this).serializeFormData());\n\t\t});\n\t\treturn companies;\n\t}\n\t/**\n\t * Register events.\n\t * @param {jQuery} modalContainer\n\t */\n\tregisterEvents(modalContainer) {\n\t\tconst self = this,\n\t\t\tform = modalContainer.find('form');\n\t\tform.validationEngine(app.validationEngineOptions);\n\t\tform.on('submit', function (e) {\n\t\t\te.preventDefault();\n\t\t\tmodalContainer.find('[name=\"saveButton\"]').click();\n\t\t});\n\t\tmodalContainer.find('[name=\"saveButton\"]').on('click', function (e) {\n\t\t\tif (!form.validationEngine('validate')) {\n\t\t\t\te.preventDefault();\n\t\t\t\tapp.showNotify({\n\t\t\t\t\ttext: app.vtranslate('JS_ENTER_ALL_REGISTRATION_DATA'),\n\t\t\t\t\ttype: 'error'\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tmodalContainer.find('button[name=saveButton]').prop('disabled', true);\n\t\t\tlet progress = $.progressIndicator({\n\t\t\t\tmessage: app.vtranslate('JS_LOADING_PLEASE_WAIT'),\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: 'YetiForce',\n\t\t\t\tparent: 'Settings',\n\t\t\t\taction: 'Register',\n\t\t\t\tmode: 'online',\n\t\t\t\tcompanies: self.getCompanies(form)\n\t\t\t})\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: data['result']['message'],\n\t\t\t\t\t\ttype: data['result']['type']\n\t\t\t\t\t});\n\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tif (data['result']['type'] === 'success') {\n\t\t\t\t\t\tlet href = location.href.replace('displayModal=online', '');\n\t\t\t\t\t\tlocation.replace(href);\n\t\t\t\t\t}\n\t\t\t\t\tmodalContainer.find('button[name=saveButton]').prop('disabled', false);\n\t\t\t\t\treturn data['result'];\n\t\t\t\t})\n\t\t\t\t.fail(function () {\n\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t});\n\t\tthis.registerNewsletter(modalContainer);\n\t}\n};\n"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","descriptor","i","length","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","key","_createClass","protoProps","staticProps","arg","_toPrimitive","String","input","hint","prim","toPrimitive","res","call","Number","window","Settings_YetiForce_RegistrationOnlineModal_Js","value","registerNewsletter","modalContainer","find","on","e","inputsContainer","$","closest","prop","attr","removeClass","removeAttr","val","addClass","getCompanies","form","companies","each","push","serializeFormData","registerEvents","self","validationEngine","app","validationEngineOptions","preventDefault","click","showNotify","text","vtranslate","type","progress","progressIndicator","message","blockInfo","enabled","AppConnector","request","module","parent","action","mode","done","data","result","href","location","replace","fail"],"mappings":"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"}