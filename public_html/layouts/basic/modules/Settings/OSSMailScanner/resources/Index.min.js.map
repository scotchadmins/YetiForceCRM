{"version":3,"file":"Index.min.js","sources":["Index.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Settings_OSSMailScanner_Index_Js',\n\t{},\n\t{\n\t\tregisterEvents: function () {\n\t\t\tconst thisIstance = this,\n\t\t\t\tcontainer = jQuery('.contentsDiv');\n\t\t\t$('.alert').alert();\n\t\t\tjQuery(\"select[id^='user_list_']\").on('change', function () {\n\t\t\t\tthisIstance.saveCRMuser(jQuery(this).data('user'), jQuery(this).val());\n\t\t\t});\n\t\t\tjQuery('#email_search').on('change', function () {\n\t\t\t\tthisIstance.saveEmailSearchList(jQuery('#email_search').val());\n\t\t\t});\n\t\t\tcontainer.find('.js-page-num').on('change', function () {\n\t\t\t\tthisIstance.reloadLogTable($(this).val() - 1);\n\t\t\t});\n\t\t\tcontainer.find('.js-run-cron').on('click', function () {\n\t\t\t\tlet buttonInstance = $(this);\n\t\t\t\tapp.showNotify({\n\t\t\t\t\ttext: app.vtranslate('start_cron'),\n\t\t\t\t\ttype: 'info',\n\t\t\t\t\tanimation: 'show'\n\t\t\t\t});\n\t\t\t\tbuttonInstance.attr('disabled', true);\n\t\t\t\tlet ajaxParams = {};\n\t\t\t\tajaxParams.data = { module: 'OSSMailScanner', action: 'Cron' };\n\t\t\t\tajaxParams.async = true;\n\t\t\t\tAppConnector.request(ajaxParams).done(function (data) {\n\t\t\t\t\tlet params = {};\n\t\t\t\t\tif (data.success && 'ok' === data.result) {\n\t\t\t\t\t\tparams = {\n\t\t\t\t\t\t\ttext: app.vtranslate('end_cron_ok'),\n\t\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\t\tanimation: 'show'\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparams = {\n\t\t\t\t\t\t\ttitle: app.vtranslate('end_cron_error'),\n\t\t\t\t\t\t\ttext: data.result,\n\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\tanimation: 'show'\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tapp.showNotify(params);\n\t\t\t\t\tbuttonInstance.attr('disabled', false);\n\t\t\t\t\tthisIstance.reloadLogTable(container.find('.js-page-num').val() - 1);\n\t\t\t\t});\n\t\t\t});\n\t\t\tcontainer.on('click', '.js-stop-cron', function (e) {\n\t\t\t\tlet ajaxParams = {},\n\t\t\t\t\tscanId = $(e.currentTarget).data('scan-id');\n\t\t\t\tajaxParams.data = { module: 'OSSMailScanner', action: 'RestartCron', scanId: scanId };\n\t\t\t\tajaxParams.async = true;\n\t\t\t\tAppConnector.request(ajaxParams).done(function (data) {\n\t\t\t\t\tif (data.success) {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: data.result.data,\n\t\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\t\tanimation: 'show'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tcontainer.find('.js-run-cron').attr('disabled', false);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthisIstance.reloadLogTable(container.find('.js-page-num').val() - 1);\n\t\t\t});\n\t\t},\n\t\tsaveActions: function (userid, vale) {\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: 'OSSMailScanner',\n\t\t\t\taction: 'SaveActions',\n\t\t\t\tuserid: userid,\n\t\t\t\tvale: vale\n\t\t\t}).done(function (data) {\n\t\t\t\tlet response = data['result'];\n\t\t\t\tif (response['success']) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: response['data'],\n\t\t\t\t\t\ttype: 'info'\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: response['data'],\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tsaveCRMuser: function (userid, value) {\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: 'OSSMailScanner',\n\t\t\t\taction: 'SaveCRMuser',\n\t\t\t\tmode: 'user',\n\t\t\t\tuserid: userid,\n\t\t\t\tvalue: value\n\t\t\t}).done(function (data) {\n\t\t\t\tlet response = data['result'];\n\t\t\t\tif (response['success']) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: response['data'],\n\t\t\t\t\t\ttype: 'info'\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: response['data'],\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tisEmpty: function (val) {\n\t\t\tif (!!val || val === 0) {\n\t\t\t\treturn val;\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\tsaveEmailSearchList: function (vale) {\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: 'OSSMailScanner',\n\t\t\t\taction: 'SaveEmailSearchList',\n\t\t\t\tvale: vale\n\t\t\t}).done(function (data) {\n\t\t\t\tlet response = data['result'];\n\t\t\t\tif (response['success']) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: response['data'],\n\t\t\t\t\t\ttype: 'info'\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: response['data'],\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to reload table with given data from request\n\t\t * @param {int} page\n\t\t */\n\t\treloadLogTable: function (page) {\n\t\t\tconst self = this;\n\t\t\tlet container = $('.contentsDiv'),\n\t\t\t\tlimit = 30;\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: 'OSSMailScanner',\n\t\t\t\taction: 'GetLog',\n\t\t\t\tstart_number: page * limit\n\t\t\t}).done(function (data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tlet tab = container.find('table.js-log-list');\n\t\t\t\t\ttab.find('tbody tr').remove();\n\t\t\t\t\tfor (let i = 0; i < data.result.length; i++) {\n\t\t\t\t\t\tlet html =\n\t\t\t\t\t\t\t'<tr>' +\n\t\t\t\t\t\t\t'<td class=\"p-1\">' +\n\t\t\t\t\t\t\tself.isEmpty(data.result[i]['id']) +\n\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'<td class=\"p-1\">' +\n\t\t\t\t\t\t\tself.isEmpty(data.result[i]['start_time']) +\n\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'<td class=\"p-1\">' +\n\t\t\t\t\t\t\tself.isEmpty(data.result[i]['end_time']) +\n\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'<td class=\"p-1\">' +\n\t\t\t\t\t\t\tself.isEmpty(app.vtranslate(data.result[i]['status'])) +\n\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'<td class=\"p-1\">' +\n\t\t\t\t\t\t\tself.isEmpty(data.result[i]['user']) +\n\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'<td class=\"p-1\">' +\n\t\t\t\t\t\t\tself.isEmpty(data.result[i]['count']) +\n\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'<td class=\"p-1\">' +\n\t\t\t\t\t\t\tself.isEmpty(data.result[i]['stop_user']) +\n\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'<td class=\"p-1\">' +\n\t\t\t\t\t\t\tself.isEmpty(data.result[i]['action']) +\n\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'<td class=\"p-1\">' +\n\t\t\t\t\t\t\tself.isEmpty(data.result[i]['info']) +\n\t\t\t\t\t\t\t'</td><td>';\n\t\t\t\t\t\tif (data.result[i]['status'] === 'In progress') {\n\t\t\t\t\t\t\thtml +=\n\t\t\t\t\t\t\t\t'<button type=\"button\" class=\"btn btn-danger js-stop-cron\" data-scan-id=\"' + data.result[i]['id'] + '\"';\n\t\t\t\t\t\t\tif (container.find('.js-run-cron').data('button-status')) {\n\t\t\t\t\t\t\t\thtml += ' disabled';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\thtml += '>' + app.vtranslate('JS_StopCron') + '</button>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\thtml += '</td></tr>';\n\t\t\t\t\t\ttab.append(html);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","registerEvents","thisIstance","container","$","alert","on","saveCRMuser","data","val","saveEmailSearchList","find","reloadLogTable","buttonInstance","app","showNotify","text","vtranslate","type","animation","attr","ajaxParams","module","action","async","AppConnector","request","done","params","success","result","title","e","scanId","currentTarget","saveActions","userid","vale","response","value","mode","isEmpty","page","self","start_number","tab","remove","html","i","length","id","start_time","end_time","status","user","count","stop_user","info","append"],"mappings":"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"}