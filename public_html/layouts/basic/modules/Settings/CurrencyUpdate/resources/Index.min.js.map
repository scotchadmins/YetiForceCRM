{"version":3,"file":"Index.min.js","sources":["Index.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Settings_CurrencyUpdate_Index_Js',\n\t{},\n\t{\n\t\t/*\n\t\t * Shows or hides block informing about supported currencies by presently chosen bank\n\t\t */\n\t\tregisterInfoButton: function (container) {\n\t\t\tcontainer.find('#supportedCurrencies').on('click', function () {\n\t\t\t\tjQuery('#infoBlock').toggleClass('d-none');\n\t\t\t});\n\t\t},\n\t\t/*\n\t\t * Shows or hides block informing about unsupported currencies by presently chosen bank\n\t\t */\n\t\tregisterAlertButton: function (container) {\n\t\t\tcontainer.find('#unsupportedCurrencies').on('click', function () {\n\t\t\t\tcontainer.find('#alertBlock').toggleClass('d-none');\n\t\t\t});\n\t\t},\n\t\t/*\n\t\t * Event fired on bank picklist change.\n\t\t * Daves the chosen bank as active in database.\n\t\t * Updates information about supported and unsupported currencies for currently chosen bank,\n\t\t */\n\t\tregisterBankChange: function (container) {\n\t\t\tconst thisInstance = this;\n\t\t\tcontainer.find('#bank').on('change', function () {\n\t\t\t\tlet bankName = container.find('#bank option:selected').data('name');\n\t\t\t\tcontainer.find('#alertSpan').html('');\n\t\t\t\tcontainer.find('#infoSpan').html('');\n\t\t\t\tlet infoProgress = jQuery.progressIndicator({\n\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tparams = {};\n\t\t\t\tlet bankId = jQuery('#bank option:selected').val();\n\t\t\t\tparams.data = {\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tname: bankName,\n\t\t\t\t\tid: bankId\n\t\t\t\t};\n\t\t\t\tparams.dataType = 'json';\n\t\t\t\tparams.data.action = 'SaveActiveBank';\n\t\t\t\tAppConnector.request(params).done((data) => {\n\t\t\t\t\tlet response = data['result'];\n\t\t\t\t\tif (response['success']) {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: response['message'],\n\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tparams.data.action = 'GetBankCurrencies';\n\t\t\t\t\t\tthisInstance.supportedCurrencies(container, params);\n\t\t\t\t\t\tthisInstance.unsupportedCurrencies(container, params);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: response['message'],\n\t\t\t\t\t\t\thide: false,\n\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tinfoProgress.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Supported currencies.\n\t\t * @param {jQuery} container\n\t\t * @param {object} params\n\t\t */\n\t\tsupportedCurrencies(container, params) {\n\t\t\tparams.data.mode = 'supported';\n\t\t\tAppConnector.request(params).done((data) => {\n\t\t\t\tlet response = data['result'],\n\t\t\t\t\thtml = '',\n\t\t\t\t\tname;\n\t\t\t\tfor (name in response) {\n\t\t\t\t\thtml += '<p><strong>' + name + '</strong> - ' + response[name] + '</p>';\n\t\t\t\t}\n\t\t\t\tcontainer.find('#infoSpan').html(html);\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Unsupported currencies.\n\t\t * @param {jQuery} container\n\t\t * @param {object} params\n\t\t */\n\t\tunsupportedCurrencies(container, params) {\n\t\t\tparams.data.mode = 'unsupported';\n\t\t\tAppConnector.request(params).done((data) => {\n\t\t\t\tlet response = data['result'];\n\t\t\t\tif (jQuery.isEmptyObject(response)) {\n\t\t\t\t\tif (!container.find('#unsupportedCurrencies').hasClass('d-none')) {\n\t\t\t\t\t\tcontainer.find('#unsupportedCurrencies').addClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t\tif (!container.find('#alertBlock').hasClass('d-none')) {\n\t\t\t\t\t\tcontainer.find('#alertBlock').addClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcontainer.find('#unsupportedCurrencies').removeClass('d-none');\n\t\t\t\t}\n\t\t\t\tlet html = '',\n\t\t\t\t\tname;\n\t\t\t\tfor (name in response) {\n\t\t\t\t\thtml += '<p><strong>' + name + '</strong> - ' + response[name] + '</p>';\n\t\t\t\t}\n\t\t\t\tcontainer.find('#alertSpan').html(html);\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register events\n\t\t */\n\t\tregisterEvents: function () {\n\t\t\tvar container = jQuery('#currencyUpdateContainer');\n\t\t\tApp.Fields.Date.register('#datepicker', false, {});\n\t\t\tthis.registerInfoButton(container);\n\t\t\tthis.registerAlertButton(container);\n\t\t\tthis.registerBankChange(container);\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","registerInfoButton","container","find","on","toggleClass","registerAlertButton","registerBankChange","thisInstance","bankName","data","html","infoProgress","progressIndicator","position","blockInfo","enabled","params","bankId","val","parent","app","getParentModuleName","module","getModuleName","name","id","dataType","action","AppConnector","request","done","response","result","success","showNotify","text","message","type","supportedCurrencies","unsupportedCurrencies","hide","mode","isEmptyObject","hasClass","addClass","removeClass","registerEvents","App","Fields","Date","register"],"mappings":"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"}