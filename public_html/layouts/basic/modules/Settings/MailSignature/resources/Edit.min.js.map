{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nSettings_Vtiger_Edit_Js(\n\t'Settings_MailSignature_Edit_Js',\n\t{},\n\t{\n\t\tregisterSubmitForm: function () {\n\t\t\tconst form = this.getForm();\n\t\t\tform.on('submit', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tif (form.validationEngine('validate')) {\n\t\t\t\t\tconst progress = jQuery.progressIndicator({\n\t\t\t\t\t\tblockInfo: { enabled: true }\n\t\t\t\t\t});\n\t\t\t\t\tthis.preSaveValidation().done((response) => {\n\t\t\t\t\t\tif (response === true) {\n\t\t\t\t\t\t\tlet formData = form.serializeFormData();\n\t\t\t\t\t\t\tformData['mode'] = 'save';\n\t\t\t\t\t\t\tAppConnector.request(formData)\n\t\t\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\t\tif (true == data.result.success) {\n\t\t\t\t\t\t\t\t\t\twindow.location.href = data.result.url;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tapp.showNotify({ text: data.result.message, type: 'error' });\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.fail(function (textStatus) {\n\t\t\t\t\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\t\tapp.showNotify({ text: textStatus, type: 'error' });\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tapp.formAlignmentAfterValidation(form);\n\t\t\t\t}\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * PreSave validation\n\t\t */\n\t\tpreSaveValidation: function () {\n\t\t\tconst aDeferred = $.Deferred();\n\t\t\tlet formData = this.getForm().serializeFormData();\n\t\t\tformData['mode'] = 'preSaveValidation';\n\t\t\tAppConnector.request(formData)\n\t\t\t\t.done((data) => {\n\t\t\t\t\tlet response = data.result;\n\t\t\t\t\tfor (let i in response) {\n\t\t\t\t\t\tif (response[i].result !== true) {\n\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\ttext: response[i].message ? response[i].message : app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (response[i].hoverField != undefined) {\n\t\t\t\t\t\t\t\tthis.container.find('[name=\"' + response[i].hoverField + '\"]').focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\taDeferred.resolve(data.result.length <= 0);\n\t\t\t\t})\n\t\t\t\t.fail((textStatus, errorThrown) => {\n\t\t\t\t\tapp.showNotify({ text: app.vtranslate('JS_ERROR'), type: 'error' });\n\t\t\t\t\tapp.errorLog(textStatus, errorThrown);\n\t\t\t\t\taDeferred.resolve(false);\n\t\t\t\t});\n\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tgetRecordsListParams: function (container) {\n\t\t\treturn { module: $('input[name=\"popupReferenceModule\"]', container).val() };\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tconst form = this.getForm();\n\t\t\tif (form.length) {\n\t\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\t}\n\t\t\tthis.registerSubmitForm();\n\t\t\tthis.registerEventForEditor();\n\t\t\tthis.registerBasicEvents(form);\n\t\t\tApp.Tools.VariablesPanel.registerRefreshCompanyVariables(form);\n\t\t\tApp.Fields.Text.registerCopyClipboard(form.find('.js-container-variable'));\n\t\t}\n\t}\n);\n"],"names":["Settings_Vtiger_Edit_Js","registerSubmitForm","_this","form","getForm","on","e","preventDefault","validationEngine","progress","jQuery","progressIndicator","blockInfo","enabled","preSaveValidation","done","response","formData","serializeFormData","mode","AppConnector","request","data","result","success","window","location","href","url","app","showNotify","text","message","type","fail","textStatus","formAlignmentAfterValidation","stopPropagation","_this2","aDeferred","$","Deferred","i","vtranslate","hoverField","container","find","focus","resolve","length","errorThrown","errorLog","promise","getRecordsListParams","module","val","registerEvents","validationEngineOptions","registerEventForEditor","registerBasicEvents","App","Tools","VariablesPanel","registerRefreshCompanyVariables","Fields","Text","registerCopyClipboard"],"mappings":"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"}