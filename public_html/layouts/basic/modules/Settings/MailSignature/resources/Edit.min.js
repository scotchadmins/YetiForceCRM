'use strict';

/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */"use strict";Settings_Vtiger_Edit_Js("Settings_MailSignature_Edit_Js",{},{registerSubmitForm:function registerSubmitForm(){var _this=this,form=this.getForm();form.on("submit",function(e){if(e.preventDefault(),form.validationEngine("validate")){var progress=jQuery.progressIndicator({blockInfo:{enabled:!0}});_this.preSaveValidation().done(function(response){if(!0===response){var formData=form.serializeFormData();formData.mode="save",AppConnector.request(formData).done(function(data){progress.progressIndicator({mode:"hide"}),!0==data.result.success?window.location.href=data.result.url:app.showNotify({text:data.result.message,type:"error"});}).fail(function(textStatus){progress.progressIndicator({mode:"hide"}),app.showNotify({text:textStatus,type:"error"});});}else progress.progressIndicator({mode:"hide"});});}else app.formAlignmentAfterValidation(form);return e.stopPropagation(),!1});},/**
		 * PreSave validation
		 */preSaveValidation:function preSaveValidation(){var _this2=this,aDeferred=$.Deferred(),formData=this.getForm().serializeFormData();return formData.mode="preSaveValidation",AppConnector.request(formData).done(function(data){var response=data.result;for(var i in response)!0!==response[i].result&&(app.showNotify({text:response[i].message?response[i].message:app.vtranslate("JS_ERROR"),type:"error"}),null!=response[i].hoverField&&_this2.container.find("[name=\""+response[i].hoverField+"\"]").focus());aDeferred.resolve(0>=data.result.length);}).fail(function(textStatus,errorThrown){app.showNotify({text:app.vtranslate("JS_ERROR"),type:"error"}),app.errorLog(textStatus,errorThrown),aDeferred.resolve(!1);}),aDeferred.promise()},getRecordsListParams:function getRecordsListParams(container){return {module:$("input[name=\"popupReferenceModule\"]",container).val()}},registerEvents:function registerEvents(){var form=this.getForm();form.length&&form.validationEngine(app.validationEngineOptions),this.registerSubmitForm(),this.registerEventForEditor(),this.registerBasicEvents(form),App.Tools.VariablesPanel.registerRefreshCompanyVariables(form),App.Fields.Text.registerCopyClipboard(form.find(".js-container-variable"));}});
//# sourceMappingURL=Edit.min.js.map
