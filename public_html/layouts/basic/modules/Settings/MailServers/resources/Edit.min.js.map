{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Settings_MailServers_Edit_Js',\n\t{},\n\t{\n\t\tcontainer: false,\n\t\tadvanceFilterInstance: false,\n\t\tconditionBuilders: [],\n\t\tsetContainer: function (container) {\n\t\t\tthis.container = container;\n\t\t\treturn this.container;\n\t\t},\n\t\tgetContainer: function () {\n\t\t\tif (this.container == false) {\n\t\t\t\tthis.container = jQuery('div.contentsDiv form');\n\t\t\t}\n\t\t\treturn this.container;\n\t\t},\n\t\t/**\n\t\t * Register submit event\n\t\t */\n\t\tregisterSubmitEvent() {\n\t\t\tthis.container.off('submit').on('submit', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.container.find('.js-toggle-panel').find('.js-block-content').removeClass('d-none');\n\t\t\t\tif ($(e.currentTarget).validationEngine('validate')) {\n\t\t\t\t\tdocument.progressLoader = $.progressIndicator({\n\t\t\t\t\t\tmessage: app.vtranslate('JS_SAVE_LOADER_INFO'),\n\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tfor (var key in this.conditionBuilders) {\n\t\t\t\t\t\tthis.container\n\t\t\t\t\t\t\t.find(`input[name=\"${key}\"]`)\n\t\t\t\t\t\t\t.val(JSON.stringify(this.conditionBuilders[key].getConditions()));\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.preSaveValidation().done((response) => {\n\t\t\t\t\t\tif (response === true) {\n\t\t\t\t\t\t\tlet formData = this.container.serializeFormData();\n\t\t\t\t\t\t\tapp\n\t\t\t\t\t\t\t\t.saveAjax('save', [], formData)\n\t\t\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\t\t\tif (data.result && data.result.success) {\n\t\t\t\t\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage({ text: app.vtranslate('JS_SAVE_SUCCESS') });\n\t\t\t\t\t\t\t\t\t\twindow.location.href = data.result.url;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tdocument.progressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\t\t\tapp.showNotify({ text: app.vtranslate('JS_ERROR'), type: 'error' });\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.fail(function () {\n\t\t\t\t\t\t\t\t\tdocument.progressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\t\tapp.showNotify({ text: app.vtranslate('JS_ERROR'), type: 'error' });\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdocument.progressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * PreSave validation\n\t\t */\n\t\tpreSaveValidation: function () {\n\t\t\tconst aDeferred = $.Deferred();\n\t\t\tlet formData = new FormData(this.container[0]);\n\t\t\tformData.append('mode', 'preSaveValidation');\n\t\t\tAppConnector.request({\n\t\t\t\tasync: false,\n\t\t\t\turl: 'index.php',\n\t\t\t\ttype: 'POST',\n\t\t\t\tdata: formData,\n\t\t\t\tprocessData: false,\n\t\t\t\tcontentType: false\n\t\t\t})\n\t\t\t\t.done((data) => {\n\t\t\t\t\tlet response = data.result;\n\t\t\t\t\tfor (let i in response) {\n\t\t\t\t\t\tif (response[i].result !== true) {\n\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\ttext: response[i].message ? response[i].message : app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (response[i].hoverField != undefined) {\n\t\t\t\t\t\t\t\tthis.container.find('[name=\"' + response[i].hoverField + '\"]').focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\taDeferred.resolve(data.result.length <= 0);\n\t\t\t\t})\n\t\t\t\t.fail((textStatus, errorThrown) => {\n\t\t\t\t\tapp.showNotify({ text: app.vtranslate('JS_ERROR'), type: 'error' });\n\t\t\t\t\tapp.errorLog(textStatus, errorThrown);\n\t\t\t\t\taDeferred.resolve(false);\n\t\t\t\t});\n\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tchangeAuthMethod: function () {\n\t\t\tthis.container.find('[name=\"auth_method\"]').on('change', (e) => {\n\t\t\t\tlet value = e.currentTarget.value;\n\t\t\t\tconsole.log(value);\n\t\t\t\tlet clientFields = this.container\n\t\t\t\t\t.find('[name=\"oauth_provider\"],[name=\"client_id\"],[name=\"client_secret\"],[name=\"redirect_uri_id\"]')\n\t\t\t\t\t.closest('.js-field-container');\n\t\t\t\tconsole.log(clientFields);\n\t\t\t\tif (value === 'oauth2') {\n\t\t\t\t\tclientFields.removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tclientFields.addClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterBasicEvents: function () {\n\t\t\tthis.container.validationEngine(app.validationEngineOptionsForRecord);\n\t\t\tthis.registerSubmitEvent();\n\t\t\tthis.changeAuthMethod();\n\t\t\tapp.registerBlockToggleEvent(this.container);\n\t\t\tApp.Fields.Password.register(this.container);\n\t\t\tApp.Fields.Text.registerCopyClipboard(this.container);\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis.setContainer($('.contentsDiv form'));\n\t\t\tthis.registerBasicEvents();\n\t\t\tapp.showPopoverElementView(this.container.find('.js-popover-tooltip'));\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","container","advanceFilterInstance","conditionBuilders","setContainer","getContainer","registerSubmitEvent","_this","off","on","e","preventDefault","find","removeClass","$","currentTarget","validationEngine","key","document","progressLoader","progressIndicator","message","app","vtranslate","position","blockInfo","enabled","concat","val","JSON","stringify","getConditions","preSaveValidation","done","response","formData","serializeFormData","saveAjax","data","result","success","Settings_Vtiger_Index_Js","showMessage","text","window","location","href","url","mode","showNotify","type","fail","stopPropagation","_this2","aDeferred","Deferred","FormData","append","AppConnector","request","async","processData","contentType","i","hoverField","focus","resolve","length","textStatus","errorThrown","errorLog","promise","changeAuthMethod","_this3","value","console","log","clientFields","closest","addClass","registerBasicEvents","validationEngineOptionsForRecord","registerBlockToggleEvent","App","Fields","Password","register","Text","registerCopyClipboard","registerEvents","showPopoverElementView"],"mappings":"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"}